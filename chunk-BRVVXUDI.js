import{a as Q,b as U}from"./chunk-56S3FF4P.js";import{c as X,d as a,e as Z,f as ee,g as te,h as ne,k as F,l as ie,m as oe}from"./chunk-G5536VX4.js";import"./chunk-DZ3ZHRGT.js";import{f as K}from"./chunk-7YLATZOY.js";import"./chunk-QLEH2ZB5.js";import{A as z,B as q,P as E,a as P,d as k,f as R,ta as G,ua as J,y as V}from"./chunk-WX3TDQFG.js";import{$b as M,Db as D,Eb as I,Ha as r,Rb as m,Sb as u,Xa as C,_b as A,aa as y,cc as H,dc as f,fc as h,gc as Y,lb as $,lc as b,mb as B,nb as w,p as T,pb as v,pc as j,qb as x,rb as c,sb as d,tb as p,ub as S}from"./chunk-456UTSJA.js";import{a as L,b as N}from"./chunk-C6Q5SG76.js";function re(t,n,e){let{years:i=0,months:o=0,weeks:l=0,days:s=0,hours:me=0,minutes:ue=0,seconds:fe=0}=n,O=a(t,e?.in),W=o||i?ee(O,o+i*12):O,he=s||l?Z(W,s+l*7):W,ye=ue+me*60,ve=(fe+ye*60)*1e3;return X(e?.in||t,+he+ve)}function ae(t,n){let e=a(t,n?.in).getDay();return e===0||e===6}function se(t,n){let e=a(t,n?.in),i=e.getMonth();return e.setFullYear(e.getFullYear(),i+1,0),e.setHours(23,59,59,999),e}function le(t,n){let e=a(t,n?.in);return e.setDate(1),e.setHours(0,0,0,0),e}function de(t,n){let e=te(),i=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??e.weekStartsOn??e.locale?.options?.weekStartsOn??0,o=a(t,n?.in),l=o.getDay(),s=(l<i?-7:0)+6-(l-i);return o.setDate(o.getDate()+s),o.setHours(23,59,59,999),o}function pe(t,n){return a(t,n?.in).getDate()}function g(t,n){return a(t,n?.in).getMonth()}function _(t,n){return a(t,n?.in).getFullYear()}var ge=t=>["../../","detail",t],_e=(t,n)=>n.id;function Ce(t,n){if(t&1&&(d(0,"a",1)(1,"span",2),m(2),f(3,"date"),p(),d(4,"span",3),m(5),p()()),t&2){let e=n.$implicit;c("routerLink",A(6,ge,e.id)),r(2),u(h(3,3,e.startsFrom,"HH:mm")),r(3),u(e.label)}}var ce=(()=>{class t{constructor(){this.events=j.required()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=C({type:t,selectors:[["demo-calendar-events"]],hostAttrs:[1,"contents"],inputs:{events:[1,"events"]},decls:3,vars:0,consts:[[1,"flex","flex-col","gap-0.5","py-1","overflow-hidden","w-full"],["type","button","puiBaseButton","",1,"justify-start","text-start","text-sm","ps-1","pe-2","py-0.5","gap-1",3,"routerLink"],[1,"tabular-nums","dark:text-neutral-400","font-medium"],[1,"truncate"]],template:function(i,o){i&1&&(d(0,"div",0),v(1,Ce,6,8,"a",1,_e),p()),i&2&&(r(),x(o.events()))},dependencies:[J,q,k],encapsulation:2})}}return t})();var De=(t,n)=>({"grid-rows-[min-content_repeat(6,1fr)]":t,"grid-rows-[min-content_repeat(5,1fr)]":n}),Me=(t,n)=>({"border-r":t,"dark:text-red-400":n}),be=(t,n)=>({"border-b":t,"border-r":n}),ke=(t,n,e,i,o)=>({"dark:text-neutral-400":t,"font-black opacity-20":n,"font-medium opacity-10":e,"dark:text-primary-50 before:rounded-full before:-top-2 before:-bottom-2 before:-left-6 before:-right-6 before:absolute before:-z-10 before:bg-primary-700":i,"dark:text-red-400":o});function Te(t,n){if(t&1&&(d(0,"div",5),m(1),f(2,"date"),p()),t&2){let e=n.$implicit,i=n.$index,o=n.$count;c("ngClass",M(5,Me,i!==o-1,e.isWeekend)),r(),u(h(2,2,e.date,"EE"))}}function we(t,n){if(t&1&&(d(0,"span",12),m(1),f(2,"date"),p(),S(3,"br")),t&2){let e=I().$implicit;r(),u(h(2,1,e.date,"MMM"))}}function Se(t,n){if(t&1&&(d(0,"div",6)(1,"span",10),$(2,we,4,4),d(3,"span"),m(4),f(5,"date"),p()(),S(6,"demo-calendar-events",11),p()),t&2){let e=n.$implicit,i=n.$index,o=n.$count;c("ngClass",M(8,be,i<o-7,i%7!=6)),r(),c("ngClass",H(11,ke,(e.isLastMonth||e.isNextMonth)&&!e.isToday,!e.isLastMonth&&!e.isNextMonth,e.isLastMonth||e.isNextMonth,e.isToday,e.isWeekend)),r(),B(e.isStartOfMonth?2:-1),r(2),u(h(5,5,e.date,"dd")),r(2),c("events",e.events)}}var ft=(()=>{class t{constructor(){this.route=y(V),this.router=y(z),this.timestamp=E(this.route.params.pipe(T(e=>e.timestamp),T(e=>Number(e)))),this.dataService=y(Q),this.rawData=E(this.dataService.getList()),this.listService=y(U),this.selectedTime=b(()=>{let e=this.timestamp();return e!=null&&e!=-1?new Date(e):e==-1?new Date(this.listService.storedSelectedTime):new Date}),this.daysVisible=b(()=>{let e=this.selectedTime();if(e==null)return[];let i=new Date,o=ne(le(e),{weekStartsOn:0}),l=de(se(e),{weekStartsOn:0});return ie({start:o,end:l}).map(s=>({date:s,isLastMonth:g(s)<g(e)?!0:_(s)<_(e),isNextMonth:g(s)>g(e)?!0:_(s)>_(e),isStartOfMonth:pe(s)==1,isToday:F(s,i),isWeekend:ae(s)}))}),this.daysWithData=b(()=>{let e=this.daysVisible(),i=this.rawData()??[];return e.map(o=>N(L({},o),{events:i.filter(l=>F(l.startsFrom,o.date)).sort((l,s)=>l.startsFrom.getTime()-s.startsFrom.getTime())}))})}onNextMonthClick(){let e=this.selectedTime(),i=re(e,{months:1});this.listService.updateSelectedTime(i),this.router.navigate(["../",i.getTime()],{relativeTo:this.route})}onLastMonthClick(){let e=this.selectedTime(),i=oe(e,{months:1});this.listService.updateSelectedTime(i),this.router.navigate(["../",i.getTime()],{relativeTo:this.route})}onTodayClick(){let e=new Date;this.listService.updateSelectedTime(e),this.router.navigate(["../",e.getTime()],{relativeTo:this.route})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=C({type:t,selectors:[["demo-employee-calendar-monthly"]],hostAttrs:[1,"contents"],decls:15,vars:15,consts:[[1,"@container","grow","flex","flex-col"],[1,"pui-card","rounded-4","h-full","grow","overflow-hidden","flex","flex-col"],[1,"rounded-t-4","px-8","pt-6","pb-12","bg-linear-to-br","from-primary-800/20","to-primary-900/20"],[1,"text-xl","font-display"],[1,"grow","-mt-6","bg-neutral-800","rounded-t-4","border-t","grid","grid-cols-7",3,"ngClass"],[1,"text-center","pt-2","pb-1","uppercase","font-bold","text-base/none",3,"ngClass"],["puiHoverable","",1,"flex","flex-col","items-center","justify-start","gap-1.5","relative","min-h-32",3,"ngClass"],["id","lastMonth","label","Last month","mode","low-emphasis","icon","arrow_back",3,"click","weight"],["id","today","label","Today","mode","auto","icon","today",3,"click","weight"],["id","nextMonth","label","Next month","mode","low-emphasis","icon","arrow_forward",3,"click","weight"],[1,"mt-2","text-[36px]/none","@screen-md:text-[48px]/none","@screen-xl:text-[64px]/none","@screen-2xl:text-[78px]/none","text-end","absolute","z-0","-bottom-2","-right-1","whitespace-nowrap","font-display","pointer-events-none","select-none",3,"ngClass"],[3,"events"],[1,"text-[24px]/none","@screen-md:text-[32px]/none","@screen-xl:text-[40px]/none","@screen-2xl:text-[54px]/none"]],template:function(i,o){i&1&&(d(0,"div",0)(1,"main",1)(2,"div",2)(3,"span",3),m(4),f(5,"date"),p()(),d(6,"div",4),v(7,Te,3,8,"div",5,w),f(9,"slice"),v(10,Se,7,17,"div",6,w),p()()(),d(12,"pui-layout-control",7),D("click",function(){return o.onLastMonthClick()}),p(),d(13,"pui-layout-control",8),D("click",function(){return o.onTodayClick()}),p(),d(14,"pui-layout-control",9),D("click",function(){return o.onNextMonthClick()}),p()),i&2&&(r(4),u(h(5,5,o.selectedTime(),"MMMM yyyy")),r(2),c("ngClass",M(12,De,o.daysWithData().length>35,o.daysWithData().length<=35)),r(),x(Y(9,8,o.daysWithData(),0,7)),r(3),x(o.daysWithData()),r(2),c("weight",-100),r(),c("weight",0),r(),c("weight",100))},dependencies:[K,G,P,ce,k,R],encapsulation:2})}}return t})();export{ft as EmployeeCalendarMonthlyComponent};
