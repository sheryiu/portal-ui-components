import{a as Ce}from"./chunk-EYYPJTXZ.js";import"./chunk-CWTPBX7D.js";function Ze(b,v,u,g){function w(p){return p instanceof u?p:new u(function(o){o(p)})}return new(u||(u=Promise))(function(p,o){function I(E){try{s(g.next(E))}catch(F){o(F)}}function U(E){try{s(g.throw(E))}catch(F){o(F)}}function s(E){E.done?p(E.value):w(E.value).then(I,U)}s((g=g.apply(b,v||[])).next())})}function Me(b,v){var u={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},g,w,p,o;return o={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function I(s){return function(E){return U([s,E])}}function U(s){if(g)throw new TypeError("Generator is already executing.");for(;u;)try{if(g=1,w&&(p=s[0]&2?w.return:s[0]?w.throw||((p=w.return)&&p.call(w),0):w.next)&&!(p=p.call(w,s[1])).done)return p;switch(w=0,p&&(s=[s[0]&2,p.value]),s[0]){case 0:case 1:p=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,w=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(p=u.trys,!(p=p.length>0&&p[p.length-1])&&(s[0]===6||s[0]===2)){u=0;continue}if(s[0]===3&&(!p||s[1]>p[0]&&s[1]<p[3])){u.label=s[1];break}if(s[0]===6&&u.label<p[1]){u.label=p[1],p=s;break}if(p&&u.label<p[2]){u.label=p[2],u.ops.push(s);break}p[2]&&u.ops.pop(),u.trys.pop();continue}s=v.call(b,u)}catch(E){s=[6,E],w=0}finally{g=p=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}function Tt(b){var v=[b.schema.primKey].concat(b.schema.indexes);return v.map(function(u){return u.src}).join(",")}function Et(b){for(var v={},u=0,g=b.tables;u<g.length;u++){var w=g[u];v[w.name]=w.schema}return v}function vt(b,v){return new Promise(function(u,g){var w=new FileReader;w.onabort=function(p){return g(new Error("file read aborted"))},w.onerror=function(p){return g(p.target.error)},w.onload=function(p){return u(p.target.result)},v==="binary"?w.readAsArrayBuffer(b):w.readAsText(b)})}function bt(b,v){if(typeof FileReaderSync>"u")throw new Error("FileReaderSync missing. Reading blobs synchronously requires code to run from within a web worker. Use TSON.encapsulateAsync() to do it from the main thread.");var u=new FileReaderSync,g=v==="binary"?u.readAsArrayBuffer(b):u.readAsText(b);return g}var yt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ht(b,v){return v={exports:{}},b(v,v.exports),v.exports}var ct=ht(function(b,v){(function(u,g){b.exports=g()})(yt,function(){function u(f){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?u=function(y){return typeof y}:u=function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},u(f)}function g(f,y,d,h,A,G,H){try{var W=f[G](H),j=W.value}catch(Ae){d(Ae);return}W.done?y(j):Promise.resolve(j).then(h,A)}function w(f){return function(){var y=this,d=arguments;return new Promise(function(h,A){var G=f.apply(y,d);function H(j){g(G,h,A,H,W,"next",j)}function W(j){g(G,h,A,H,W,"throw",j)}H(void 0)})}}function p(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}function o(f,y){for(var d=0;d<y.length;d++){var h=y[d];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(f,h.key,h)}}function I(f,y,d){return y&&o(f.prototype,y),d&&o(f,d),f}function U(f,y,d){return y in f?Object.defineProperty(f,y,{value:d,enumerable:!0,configurable:!0,writable:!0}):f[y]=d,f}function s(f,y){var d=Object.keys(f);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(f);y&&(h=h.filter(function(A){return Object.getOwnPropertyDescriptor(f,A).enumerable})),d.push.apply(d,h)}return d}function E(f){for(var y=1;y<arguments.length;y++){var d=arguments[y]!=null?arguments[y]:{};y%2?s(Object(d),!0).forEach(function(h){U(f,h,d[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(d)):s(Object(d)).forEach(function(h){Object.defineProperty(f,h,Object.getOwnPropertyDescriptor(d,h))})}return f}function F(f,y){return J(f)||ee(f,y)||be()}function ve(f){return Oe(f)||V(f)||Ee()}function Oe(f){if(Array.isArray(f)){for(var y=0,d=new Array(f.length);y<f.length;y++)d[y]=f[y];return d}}function J(f){if(Array.isArray(f))return f}function V(f){if(Symbol.iterator in Object(f)||Object.prototype.toString.call(f)==="[object Arguments]")return Array.from(f)}function ee(f,y){if(Symbol.iterator in Object(f)||Object.prototype.toString.call(f)==="[object Arguments]"){var d=[],h=!0,A=!1,G=void 0;try{for(var H=f[Symbol.iterator](),W;!(h=(W=H.next()).done)&&(d.push(W.value),!(y&&d.length===y));h=!0);}catch(j){A=!0,G=j}finally{try{!h&&H.return!=null&&H.return()}finally{if(A)throw G}}return d}}function Ee(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function be(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var _=function f(y){p(this,f),this.p=new Promise(y)};_.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(_.prototype[Symbol.toStringTag]="TypesonPromise"),_.prototype.then=function(f,y){var d=this;return new _(function(h,A){d.p.then(function(G){h(f?f(G):G)}).catch(function(G){return y?y(G):Promise.reject(G)}).then(h,A)})},_.prototype.catch=function(f){return this.then(null,f)},_.resolve=function(f){return new _(function(y){y(f)})},_.reject=function(f){return new _(function(y,d){d(f)})},["all","race"].forEach(function(f){_[f]=function(y){return new _(function(d,h){Promise[f](y.map(function(A){return A&&A.constructor&&A.constructor.__typeson__type__==="TypesonPromise"?A.p:A})).then(d,h)})}});var _e={},K=_e.toString,ne={}.hasOwnProperty,re=Object.getPrototypeOf,Pe=ne.toString;function c(f,y){return M(f)&&typeof f.then=="function"&&(!y||typeof f.catch=="function")}function r(f){return K.call(f).slice(8,-1)}function m(f,y){if(!f||u(f)!=="object")return!1;var d=re(f);if(!d)return y===null;var h=ne.call(d,"constructor")&&d.constructor;return typeof h!="function"?y===null:y===h||y!==null&&Pe.call(h)===Pe.call(y)||typeof y=="function"&&typeof h.__typeson__type__=="string"&&h.__typeson__type__===y.__typeson__type__}function l(f){if(!f||r(f)!=="Object")return!1;var y=re(f);return y?m(f,Object):!0}function Z(f){if(!f||r(f)!=="Object")return!1;var y=re(f);return y?m(f,Object)||Z(y):!0}function M(f){return f&&u(f)==="object"}function ie(f){return f.replace(/~/g,"~0").replace(/\./g,"~1")}function de(f){return f.replace(/~1/g,".").replace(/~0/g,"~")}function Se(f,y){if(y==="")return f;var d=y.indexOf(".");if(d>-1){var h=f[de(y.slice(0,d))];return h===void 0?void 0:Se(h,y.slice(d+1))}return f[de(y)]}function je(f,y,d){if(y==="")return d;var h=y.indexOf(".");if(h>-1){var A=f[de(y.slice(0,h))];return je(A,y.slice(h+1),d)}return f[de(y)]=d,f}function Ne(f){return f===null?"null":Array.isArray(f)?"array":u(f)}var ce=Object.keys,he=Array.isArray,xe={}.hasOwnProperty,Ge=["type","replaced","iterateIn","iterateUnsetNumeric"];function D(f,y){if(f.keypath==="")return-1;var d=f.keypath.match(/\./g)||0,h=y.keypath.match(/\./g)||0;return d&&(d=d.length),h&&(h=h.length),d>h?-1:d<h?1:f.keypath<y.keypath?-1:f.keypath>y.keypath}var pe=function(){function f(y){p(this,f),this.options=y,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return I(f,[{key:"stringify",value:function(d,h,A,G){G=E({},this.options,{},G,{stringification:!0});var H=this.encapsulate(d,null,G);return he(H)?JSON.stringify(H[0],h,A):H.then(function(W){return JSON.stringify(W,h,A)})}},{key:"stringifySync",value:function(d,h,A,G){return this.stringify(d,h,A,E({throwOnBadSyncType:!0},G,{sync:!0}))}},{key:"stringifyAsync",value:function(d,h,A,G){return this.stringify(d,h,A,E({throwOnBadSyncType:!0},G,{sync:!1}))}},{key:"parse",value:function(d,h,A){return A=E({},this.options,{},A,{parse:!0}),this.revive(JSON.parse(d,h),A)}},{key:"parseSync",value:function(d,h,A){return this.parse(d,h,E({throwOnBadSyncType:!0},A,{sync:!0}))}},{key:"parseAsync",value:function(d,h,A){return this.parse(d,h,E({throwOnBadSyncType:!0},A,{sync:!1}))}},{key:"specialTypeNames",value:function(d,h){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return A.returnTypeNames=!0,this.encapsulate(d,h,A)}},{key:"rootTypeName",value:function(d,h){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return A.iterateNone=!0,this.encapsulate(d,h,A)}},{key:"encapsulate",value:function(d,h,A){A=E({sync:!0},this.options,{},A);var G=A,H=G.sync,W=this,j={},Ae=[],Ue=[],Re=[],Ye="cyclic"in A?A.cyclic:!0,qe=A,Xe=qe.encapsulateObserver,Fe=se("",d,Ye,h||{},Re);function ze(B){var n=Object.values(j);if(A.iterateNone)return n.length?n[0]:f.getJSONType(B);if(n.length){if(A.returnTypeNames)return ve(new Set(n));!B||!l(B)||xe.call(B,"$types")?B={$:B,$types:{$:j}}:B.$types=j}else M(B)&&xe.call(B,"$types")&&(B={$:B,$types:!0});return A.returnTypeNames?!1:B}function me(B,n){return oe.apply(this,arguments)}function oe(){return oe=w(regeneratorRuntime.mark(function B(n,e){var t;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.all(e.map(function(O){return O[1].p}));case 2:return t=a.sent,a.next=5,Promise.all(t.map(function(){var O=w(regeneratorRuntime.mark(function T(C){var N,L,Y,q,ae,Q,X,fe,le,$,Te,P,S,k;return regeneratorRuntime.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(N=[],L=e.splice(0,1),Y=F(L,1),q=Y[0],ae=F(q,7),Q=ae[0],X=ae[2],fe=ae[3],le=ae[4],$=ae[5],Te=ae[6],P=se(Q,C,X,fe,N,!0,Te),S=m(P,_),!(Q&&S)){R.next=11;break}return R.next=8,P.p;case 8:return k=R.sent,le[$]=k,R.abrupt("return",me(n,N));case 11:return Q?le[$]=P:S?n=P.p:n=P,R.abrupt("return",me(n,N));case 13:case"end":return R.stop()}},T)}));return function(T){return O.apply(this,arguments)}}()));case 5:return a.abrupt("return",n);case 6:case"end":return a.stop()}},B)})),oe.apply(this,arguments)}function te(B,n,e){Object.assign(B,n);var t=Ge.map(function(i){var a=B[i];return delete B[i],a});e(),Ge.forEach(function(i,a){B[i]=t[a]})}function se(B,n,e,t,i,a,O){var T,C={},N=u(n),L=Xe?function(S){var k=O||t.type||f.getJSONType(n);Xe(Object.assign(S||C,{keypath:B,value:n,cyclic:e,stateObj:t,promisesData:i,resolvingTypesonPromise:a,awaitingTypesonPromise:m(n,_)},{type:k}))}:null;if(["string","boolean","number","undefined"].includes(N))return n===void 0||N==="number"&&(isNaN(n)||n===-1/0||n===1/0)?(t.replaced?T=n:T=ge(B,n,t,i,!1,a,L),T!==n&&(C={replaced:T})):T=n,L&&L(),T;if(n===null)return L&&L(),n;if(e&&!t.iterateIn&&!t.iterateUnsetNumeric&&n&&u(n)==="object"){var Y=Ae.indexOf(n);if(Y<0)e===!0&&(Ae.push(n),Ue.push(B));else return j[B]="#",L&&L({cyclicKeypath:Ue[Y]}),"#"+Ue[Y]}var q=l(n),ae=he(n),Q=(q||ae)&&(!W.plainObjectReplacers.length||t.replaced)||t.iterateIn?n:ge(B,n,t,i,q||ae,null,L),X;if(Q!==n?(T=Q,C={replaced:Q}):B===""&&m(n,_)?(i.push([B,n,e,t,void 0,void 0,t.type]),T=n):ae&&t.iterateIn!=="object"||t.iterateIn==="array"?(X=new Array(n.length),C={clone:X}):!["function","symbol"].includes(u(n))&&!("toJSON"in n)&&!m(n,_)&&!m(n,Promise)&&!m(n,ArrayBuffer)||q||t.iterateIn==="object"?(X={},t.addLength&&(X.length=n.length),C={clone:X}):T=n,L&&L(),A.iterateNone)return X||T;if(!X)return T;if(t.iterateIn){var fe=function(k){var x={ownKeys:xe.call(n,k)};te(t,x,function(){var R=B+(B?".":"")+ie(k),z=se(R,n[k],!!e,t,i,a);m(z,_)?i.push([R,z,!!e,t,X,k,t.type]):z!==void 0&&(X[k]=z)})};for(var le in n)fe(le);L&&L({endIterateIn:!0,end:!0})}else ce(n).forEach(function(S){var k=B+(B?".":"")+ie(S),x={ownKeys:!0};te(t,x,function(){var R=se(k,n[S],!!e,t,i,a);m(R,_)?i.push([k,R,!!e,t,X,S,t.type]):R!==void 0&&(X[S]=R)})}),L&&L({endIterateOwn:!0,end:!0});if(t.iterateUnsetNumeric){for(var $=n.length,Te=function(k){if(!(k in n)){var x=B+(B?".":"")+k,R={ownKeys:!1};te(t,R,function(){var z=se(x,void 0,!!e,t,i,a);m(z,_)?i.push([x,z,!!e,t,X,k,t.type]):z!==void 0&&(X[k]=z)})}},P=0;P<$;P++)Te(P);L&&L({endIterateUnsetNumeric:!0,end:!0})}return X}function ge(B,n,e,t,i,a,O){for(var T=i?W.plainObjectReplacers:W.nonplainObjectReplacers,C=T.length;C--;){var N=T[C];if(N.test(n,e)){var L=N.type;if(W.revivers[L]){var Y=j[B];j[B]=Y?[L].concat(Y):L}if(Object.assign(e,{type:L,replaced:!0}),(H||!N.replaceAsync)&&!N.replace)return O&&O({typeDetected:!0}),se(B,n,Ye&&"readonly",e,t,a,L);O&&O({replacing:!0});var q=H||!N.replaceAsync?"replace":"replaceAsync";return se(B,N[q](n,e),Ye&&"readonly",e,t,a,L)}}return n}return Re.length?H&&A.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(me(Fe,Re)).then(ze):!H&&A.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():A.stringification&&H?[ze(Fe)]:H?ze(Fe):Promise.resolve(ze(Fe))}},{key:"encapsulateSync",value:function(d,h,A){return this.encapsulate(d,h,E({throwOnBadSyncType:!0},A,{sync:!0}))}},{key:"encapsulateAsync",value:function(d,h,A){return this.encapsulate(d,h,E({throwOnBadSyncType:!0},A,{sync:!1}))}},{key:"revive",value:function(d,h){var A=d&&d.$types;if(!A)return d;if(A===!0)return d.$;h=E({sync:!0},this.options,{},h);var G=h,H=G.sync,W=[],j={},Ae=!0;A.$&&l(A.$)&&(d=d.$,A=A.$,Ae=!1);var Ue=this;function Re(oe,te){var se=Ue.revivers[oe]||[],ge=F(se,1),B=ge[0];if(!B)throw new Error("Unregistered type: "+oe);return H&&!("revive"in B)?te:B[H&&B.revive?"revive":!H&&B.reviveAsync?"reviveAsync":"revive"](te,j)}function Ye(){var oe=[];if(Object.entries(A).forEach(function(te){var se=F(te,2),ge=se[0],B=se[1];B!=="#"&&[].concat(B).forEach(function(n){var e=Ue.revivers[n]||[null,{}],t=F(e,2),i=t[1].plain;i&&(oe.push({keypath:ge,type:n}),delete A[ge])})}),!!oe.length)return oe.sort(D).reduce(function te(se,ge){var B=ge.keypath,n=ge.type;if(c(se))return se.then(function(i){return te(i,{keypath:B,type:n})});var e=Se(d,B);if(e=Re(n,e),m(e,_))return e.then(function(i){var a=je(d,B,i);a===i&&(d=a)});var t=je(d,B,e);t===e&&(d=t)},void 0)}var qe=[];function Xe(oe,te,se,ge,B){if(!(Ae&&oe==="$types")){var n=A[oe],e=he(te);if(e||l(te)){var t=e?new Array(te.length):{};for(ce(te).forEach(function(Y){var q=Xe(oe+(oe?".":"")+ie(Y),te[Y],se||t,t,Y),ae=function(X){return m(X,ke)?t[Y]=void 0:X!==void 0&&(t[Y]=X),X};m(q,_)?qe.push(q.then(function(Q){return ae(Q)})):ae(q)}),te=t;W.length;){var i=F(W[0],4),a=i[0],O=i[1],T=i[2],C=i[3],N=Se(a,O);if(N!==void 0)T[C]=N;else break;W.splice(0,1)}}if(!n)return te;if(n==="#"){var L=Se(se,te.slice(1));return L===void 0&&W.push([se,te.slice(1),ge,B]),L}return[].concat(n).reduce(function Y(q,ae){return m(q,_)?q.then(function(Q){return Y(Q,ae)}):Re(ae,q)},te)}}function Fe(oe){return m(oe,ke)?void 0:oe}var ze=Ye(),me;return m(ze,_)?me=ze.then(function(){return d}):(me=Xe("",d,null),qe.length&&(me=_.resolve(me).then(function(oe){return _.all([oe].concat(qe))}).then(function(oe){var te=F(oe,1),se=te[0];return se}))),c(me)?H&&h.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():m(me,_)?me.p.then(Fe):me:!H&&h.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():H?Fe(me):Promise.resolve(Fe(me))}},{key:"reviveSync",value:function(d,h){return this.revive(d,E({throwOnBadSyncType:!0},h,{sync:!0}))}},{key:"reviveAsync",value:function(d,h){return this.revive(d,E({throwOnBadSyncType:!0},h,{sync:!1}))}},{key:"register",value:function(d,h){return h=h||{},[].concat(d).forEach(function A(G){var H=this;if(he(G))return G.map(function(W){return A.call(H,W)});G&&ce(G).forEach(function(W){if(W==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(f.JSON_TYPES.includes(W))throw new TypeError("Plain JSON object types are reserved as type names");var j=G[W],Ae=j&&j.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,Ue=Ae.filter(function(se){return se.type===W});if(Ue.length&&(Ae.splice(Ae.indexOf(Ue[0]),1),delete this.revivers[W],delete this.types[W]),typeof j=="function"){var Re=j;j={test:function(ge){return ge&&ge.constructor===Re},replace:function(ge){return E({},ge)},revive:function(ge){return Object.assign(Object.create(Re.prototype),ge)}}}else if(he(j)){var Ye=j,qe=F(Ye,3),Xe=qe[0],Fe=qe[1],ze=qe[2];j={test:Xe,replace:Fe,revive:ze}}if(!(!j||!j.test)){var me={type:W,test:j.test.bind(j)};j.replace&&(me.replace=j.replace.bind(j)),j.replaceAsync&&(me.replaceAsync=j.replaceAsync.bind(j));var oe=typeof h.fallback=="number"?h.fallback:h.fallback?0:1/0;if(j.testPlainObjects?this.plainObjectReplacers.splice(oe,0,me):this.nonplainObjectReplacers.splice(oe,0,me),j.revive||j.reviveAsync){var te={};j.revive&&(te.revive=j.revive.bind(j)),j.reviveAsync&&(te.reviveAsync=j.reviveAsync.bind(j)),this.revivers[W]=[te,{plain:j.testPlainObjects}]}this.types[W]=j}},this)},this),this}}]),f}(),ke=function f(){p(this,f)};return ke.__typeson__type__="TypesonUndefined",pe.Undefined=ke,pe.Promise=_,pe.isThenable=c,pe.toStringTag=r,pe.hasConstructorOf=m,pe.isObject=M,pe.isPlainObject=l,pe.isUserObject=Z,pe.escapeKeyPathComponent=ie,pe.unescapeKeyPathComponent=de,pe.getByKeyPath=Se,pe.getJSONType=Ne,pe.JSON_TYPES=["null","boolean","number","string","array","object"],pe})}),Nt=ht(function(b,v){(function(u,g){b.exports=g()})(yt,function(){function u(n){return(u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(n)}function g(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function w(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function p(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function I(n){return function(t){if(Array.isArray(t))return U(t)}(n)||function(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}(n)||function(t,i){if(t){if(typeof t=="string")return U(t,i);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return U(t,i)}}(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function U(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function s(n){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function E(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function F(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function ve(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Oe(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function J(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Oe(Object(t),!0).forEach(function(i){ve(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Oe(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function V(n,e){return function(i){if(Array.isArray(i))return i}(n)||function(i,a){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(i)))){var O=[],T=!0,C=!1,N=void 0;try{for(var L,Y=i[Symbol.iterator]();!(T=(L=Y.next()).done)&&(O.push(L.value),!a||O.length!==a);T=!0);}catch(q){C=!0,N=q}finally{try{T||Y.return==null||Y.return()}finally{if(C)throw N}}return O}}(n,e)||Ee(n,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ee(n){return function(t){if(Array.isArray(t))return be(t)}(n)||function(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}(n)||Ee(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ee(n,e){if(n){if(typeof n=="string")return be(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?be(n,e):void 0}}function be(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}var _=function n(e){E(this,n),this.p=new Promise(e)};_.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(_.prototype[Symbol.toStringTag]="TypesonPromise"),_.prototype.then=function(n,e){var t=this;return new _(function(i,a){t.p.then(function(O){i(n?n(O):O)}).catch(function(O){return e?e(O):Promise.reject(O)}).then(i,a)})},_.prototype.catch=function(n){return this.then(null,n)},_.resolve=function(n){return new _(function(e){e(n)})},_.reject=function(n){return new _(function(e,t){t(n)})},["all","race"].forEach(function(n){_[n]=function(e){return new _(function(t,i){Promise[n](e.map(function(a){return a&&a.constructor&&a.constructor.__typeson__type__==="TypesonPromise"?a.p:a})).then(t,i)})}});var _e={}.toString,K={}.hasOwnProperty,ne=Object.getPrototypeOf,re=K.toString;function Pe(n,e){return l(n)&&typeof n.then=="function"&&(!e||typeof n.catch=="function")}function c(n){return _e.call(n).slice(8,-1)}function r(n,e){if(!n||s(n)!=="object")return!1;var t=ne(n);if(!t)return e===null;var i=K.call(t,"constructor")&&t.constructor;return typeof i!="function"?e===null:e===i||e!==null&&re.call(i)===re.call(e)||typeof e=="function"&&typeof i.__typeson__type__=="string"&&i.__typeson__type__===e.__typeson__type__}function m(n){return!(!n||c(n)!=="Object")&&(!ne(n)||r(n,Object))}function l(n){return n&&s(n)==="object"}function Z(n){return n.replace(/~/g,"~0").replace(/\./g,"~1")}function M(n){return n.replace(/~1/g,".").replace(/~0/g,"~")}function ie(n,e){if(e==="")return n;var t=e.indexOf(".");if(t>-1){var i=n[M(e.slice(0,t))];return i===void 0?void 0:ie(i,e.slice(t+1))}return n[M(e)]}function de(n,e,t){if(e==="")return t;var i=e.indexOf(".");return i>-1?de(n[M(e.slice(0,i))],e.slice(i+1),t):(n[M(e)]=t,n)}function Se(n,e,t){return t?e?e(n):n:(n&&n.then||(n=Promise.resolve(n)),e?n.then(e):n)}var je=Object.keys,Ne=Array.isArray,ce={}.hasOwnProperty,he=["type","replaced","iterateIn","iterateUnsetNumeric"];function xe(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(n.apply(this,e))}catch(i){return Promise.reject(i)}}}function Ge(n,e){if(n.keypath==="")return-1;var t=n.keypath.match(/\./g)||0,i=e.keypath.match(/\./g)||0;return t&&(t=t.length),i&&(i=i.length),t>i?-1:t<i?1:n.keypath<e.keypath?-1:n.keypath>e.keypath}var D=function(){function n(e){E(this,n),this.options=e,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return function(t,i,a){return i&&F(t.prototype,i),a&&F(t,a),t}(n,[{key:"stringify",value:function(t,i,a,O){O=J(J(J({},this.options),O),{},{stringification:!0});var T=this.encapsulate(t,null,O);return Ne(T)?JSON.stringify(T[0],i,a):T.then(function(C){return JSON.stringify(C,i,a)})}},{key:"stringifySync",value:function(t,i,a,O){return this.stringify(t,i,a,J(J({throwOnBadSyncType:!0},O),{},{sync:!0}))}},{key:"stringifyAsync",value:function(t,i,a,O){return this.stringify(t,i,a,J(J({throwOnBadSyncType:!0},O),{},{sync:!1}))}},{key:"parse",value:function(t,i,a){return a=J(J(J({},this.options),a),{},{parse:!0}),this.revive(JSON.parse(t,i),a)}},{key:"parseSync",value:function(t,i,a){return this.parse(t,i,J(J({throwOnBadSyncType:!0},a),{},{sync:!0}))}},{key:"parseAsync",value:function(t,i,a){return this.parse(t,i,J(J({throwOnBadSyncType:!0},a),{},{sync:!1}))}},{key:"specialTypeNames",value:function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return a.returnTypeNames=!0,this.encapsulate(t,i,a)}},{key:"rootTypeName",value:function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return a.iterateNone=!0,this.encapsulate(t,i,a)}},{key:"encapsulate",value:function(t,i,a){var O=xe(function(P,S){return Se(Promise.all(S.map(function(k){return k[1].p})),function(k){return Se(Promise.all(k.map(xe(function(x){var R=!1,z=[],Ke=V(S.splice(0,1),1),we=V(Ke[0],7),Le=we[0],$e=we[2],ue=we[3],Ve=we[4],ye=we[5],De=we[6],Ie=$(Le,x,$e,ue,z,!0,De),He=r(Ie,_);return function(ft,ot){var nt=ft();return nt&&nt.then?nt.then(ot):ot(nt)}(function(){if(Le&&He)return Se(Ie.p,function(We){return Ve[ye]=We,R=!0,O(P,z)})},function(We){return R?We:(Le?Ve[ye]=Ie:P=He?Ie.p:Ie,O(P,z))})}))),function(){return P})})}),T=(a=J(J({sync:!0},this.options),a)).sync,C=this,N={},L=[],Y=[],q=[],ae=!("cyclic"in a)||a.cyclic,Q=a.encapsulateObserver,X=$("",t,ae,i||{},q);function fe(P){var S=Object.values(N);if(a.iterateNone)return S.length?S[0]:n.getJSONType(P);if(S.length){if(a.returnTypeNames)return ee(new Set(S));P&&m(P)&&!ce.call(P,"$types")?P.$types=N:P={$:P,$types:{$:N}}}else l(P)&&ce.call(P,"$types")&&(P={$:P,$types:!0});return!a.returnTypeNames&&P}function le(P,S,k){Object.assign(P,S);var x=he.map(function(R){var z=P[R];return delete P[R],z});k(),he.forEach(function(R,z){P[R]=x[z]})}function $(P,S,k,x,R,z,Ke){var we,Le={},$e=s(S),ue=Q?function(et){var Be=Ke||x.type||n.getJSONType(S);Q(Object.assign(et||Le,{keypath:P,value:S,cyclic:k,stateObj:x,promisesData:R,resolvingTypesonPromise:z,awaitingTypesonPromise:r(S,_)},{type:Be}))}:null;if(["string","boolean","number","undefined"].includes($e))return S===void 0||Number.isNaN(S)||S===Number.NEGATIVE_INFINITY||S===Number.POSITIVE_INFINITY?(we=x.replaced?S:Te(P,S,x,R,!1,z,ue))!==S&&(Le={replaced:we}):we=S,ue&&ue(),we;if(S===null)return ue&&ue(),S;if(k&&!x.iterateIn&&!x.iterateUnsetNumeric&&S&&s(S)==="object"){var Ve=L.indexOf(S);if(!(Ve<0))return N[P]="#",ue&&ue({cyclicKeypath:Y[Ve]}),"#"+Y[Ve];k===!0&&(L.push(S),Y.push(P))}var ye,De=m(S),Ie=Ne(S),He=(De||Ie)&&(!C.plainObjectReplacers.length||x.replaced)||x.iterateIn?S:Te(P,S,x,R,De||Ie,null,ue);if(He!==S?(we=He,Le={replaced:He}):P===""&&r(S,_)?(R.push([P,S,k,x,void 0,void 0,x.type]),we=S):Ie&&x.iterateIn!=="object"||x.iterateIn==="array"?(ye=new Array(S.length),Le={clone:ye}):(["function","symbol"].includes(s(S))||"toJSON"in S||r(S,_)||r(S,Promise)||r(S,ArrayBuffer))&&!De&&x.iterateIn!=="object"?we=S:(ye={},x.addLength&&(ye.length=S.length),Le={clone:ye}),ue&&ue(),a.iterateNone)return ye||we;if(!ye)return we;if(x.iterateIn){var We=function(Be){var Qe={ownKeys:ce.call(S,Be)};le(x,Qe,function(){var tt=P+(P?".":"")+Z(Be),st=$(tt,S[Be],!!k,x,R,z);r(st,_)?R.push([tt,st,!!k,x,ye,Be,x.type]):st!==void 0&&(ye[Be]=st)})};for(var ft in S)We(ft);ue&&ue({endIterateIn:!0,end:!0})}else je(S).forEach(function(et){var Be=P+(P?".":"")+Z(et);le(x,{ownKeys:!0},function(){var Qe=$(Be,S[et],!!k,x,R,z);r(Qe,_)?R.push([Be,Qe,!!k,x,ye,et,x.type]):Qe!==void 0&&(ye[et]=Qe)})}),ue&&ue({endIterateOwn:!0,end:!0});if(x.iterateUnsetNumeric){for(var ot=S.length,nt=function(Be){if(!(Be in S)){var Qe=P+(P?".":"")+Be;le(x,{ownKeys:!1},function(){var tt=$(Qe,void 0,!!k,x,R,z);r(tt,_)?R.push([Qe,tt,!!k,x,ye,Be,x.type]):tt!==void 0&&(ye[Be]=tt)})}},lt=0;lt<ot;lt++)nt(lt);ue&&ue({endIterateUnsetNumeric:!0,end:!0})}return ye}function Te(P,S,k,x,R,z,Ke){for(var we=R?C.plainObjectReplacers:C.nonplainObjectReplacers,Le=we.length;Le--;){var $e=we[Le];if($e.test(S,k)){var ue=$e.type;if(C.revivers[ue]){var Ve=N[P];N[P]=Ve?[ue].concat(Ve):ue}return Object.assign(k,{type:ue,replaced:!0}),!T&&$e.replaceAsync||$e.replace?(Ke&&Ke({replacing:!0}),$(P,$e[T||!$e.replaceAsync?"replace":"replaceAsync"](S,k),ae&&"readonly",k,x,z,ue)):(Ke&&Ke({typeDetected:!0}),$(P,S,ae&&"readonly",k,x,z,ue))}}return S}return q.length?T&&a.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(O(X,q)).then(fe):!T&&a.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():a.stringification&&T?[fe(X)]:T?fe(X):Promise.resolve(fe(X))}},{key:"encapsulateSync",value:function(t,i,a){return this.encapsulate(t,i,J(J({throwOnBadSyncType:!0},a),{},{sync:!0}))}},{key:"encapsulateAsync",value:function(t,i,a){return this.encapsulate(t,i,J(J({throwOnBadSyncType:!0},a),{},{sync:!1}))}},{key:"revive",value:function(t,i){var a=t&&t.$types;if(!a)return t;if(a===!0)return t.$;var O=(i=J(J({sync:!0},this.options),i)).sync,T=[],C={},N=!0;a.$&&m(a.$)&&(t=t.$,a=a.$,N=!1);var L=this;function Y(fe,le){var $=V(L.revivers[fe]||[],1)[0];if(!$)throw new Error("Unregistered type: "+fe);return O&&!("revive"in $)?le:$[O&&$.revive?"revive":!O&&$.reviveAsync?"reviveAsync":"revive"](le,C)}var q=[];function ae(fe){return r(fe,pe)?void 0:fe}var Q,X=function(){var le=[];if(Object.entries(a).forEach(function($){var Te=V($,2),P=Te[0],S=Te[1];S!=="#"&&[].concat(S).forEach(function(k){V(L.revivers[k]||[null,{}],2)[1].plain&&(le.push({keypath:P,type:k}),delete a[P])})}),le.length)return le.sort(Ge).reduce(function $(Te,P){var S=P.keypath,k=P.type;if(Pe(Te))return Te.then(function(z){return $(z,{keypath:S,type:k})});var x=ie(t,S);if(r(x=Y(k,x),_))return x.then(function(z){var Ke=de(t,S,z);Ke===z&&(t=Ke)});var R=de(t,S,x);R===x&&(t=R)},void 0)}();return r(X,_)?Q=X.then(function(){return t}):(Q=function fe(le,$,Te,P,S){if(!N||le!=="$types"){var k=a[le],x=Ne($);if(x||m($)){var R=x?new Array($.length):{};for(je($).forEach(function(ye){var De=fe(le+(le?".":"")+Z(ye),$[ye],Te||R,R,ye),Ie=function(We){return r(We,pe)?R[ye]=void 0:We!==void 0&&(R[ye]=We),We};r(De,_)?q.push(De.then(function(He){return Ie(He)})):Ie(De)}),$=R;T.length;){var z=V(T[0],4),Ke=z[0],we=z[1],Le=z[2],$e=z[3],ue=ie(Ke,we);if(ue===void 0)break;Le[$e]=ue,T.splice(0,1)}}if(!k)return $;if(k==="#"){var Ve=ie(Te,$.slice(1));return Ve===void 0&&T.push([Te,$.slice(1),P,S]),Ve}return[].concat(k).reduce(function ye(De,Ie){return r(De,_)?De.then(function(He){return ye(He,Ie)}):Y(Ie,De)},$)}}("",t,null),q.length&&(Q=_.resolve(Q).then(function(fe){return _.all([fe].concat(q))}).then(function(fe){return V(fe,1)[0]}))),Pe(Q)?O&&i.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():r(Q,_)?Q.p.then(ae):Q:!O&&i.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():O?ae(Q):Promise.resolve(ae(Q))}},{key:"reviveSync",value:function(t,i){return this.revive(t,J(J({throwOnBadSyncType:!0},i),{},{sync:!0}))}},{key:"reviveAsync",value:function(t,i){return this.revive(t,J(J({throwOnBadSyncType:!0},i),{},{sync:!1}))}},{key:"register",value:function(t,i){return i=i||{},[].concat(t).forEach(function a(O){var T=this;if(Ne(O))return O.map(function(C){return a.call(T,C)});O&&je(O).forEach(function(C){if(C==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(n.JSON_TYPES.includes(C))throw new TypeError("Plain JSON object types are reserved as type names");var N=O[C],L=N&&N.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,Y=L.filter(function(le){return le.type===C});if(Y.length&&(L.splice(L.indexOf(Y[0]),1),delete this.revivers[C],delete this.types[C]),typeof N=="function"){var q=N;N={test:function($){return $&&$.constructor===q},replace:function($){return J({},$)},revive:function($){return Object.assign(Object.create(q.prototype),$)}}}else if(Ne(N)){var ae=V(N,3);N={test:ae[0],replace:ae[1],revive:ae[2]}}if(N&&N.test){var Q={type:C,test:N.test.bind(N)};N.replace&&(Q.replace=N.replace.bind(N)),N.replaceAsync&&(Q.replaceAsync=N.replaceAsync.bind(N));var X=typeof i.fallback=="number"?i.fallback:i.fallback?0:Number.POSITIVE_INFINITY;if(N.testPlainObjects?this.plainObjectReplacers.splice(X,0,Q):this.nonplainObjectReplacers.splice(X,0,Q),N.revive||N.reviveAsync){var fe={};N.revive&&(fe.revive=N.revive.bind(N)),N.reviveAsync&&(fe.reviveAsync=N.reviveAsync.bind(N)),this.revivers[C]=[fe,{plain:N.testPlainObjects}]}this.types[C]=N}},this)},this),this}}]),n}(),pe=function n(){E(this,n)};pe.__typeson__type__="TypesonUndefined",D.Undefined=pe,D.Promise=_,D.isThenable=Pe,D.toStringTag=c,D.hasConstructorOf=r,D.isObject=l,D.isPlainObject=m,D.isUserObject=function n(e){if(!e||c(e)!=="Object")return!1;var t=ne(e);return!t||r(e,Object)||n(t)},D.escapeKeyPathComponent=Z,D.unescapeKeyPathComponent=M,D.getByKeyPath=ie,D.getJSONType=function(e){return e===null?"null":Array.isArray(e)?"array":s(e)},D.JSON_TYPES=["null","boolean","number","string","array","object"];for(var ke={userObject:{test:function(e,t){return D.isUserObject(e)},replace:function(e){return function(i){for(var a=1;a<arguments.length;a++){var O=arguments[a]!=null?arguments[a]:{};a%2?o(Object(O),!0).forEach(function(T){p(i,T,O[T])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(O)):o(Object(O)).forEach(function(T){Object.defineProperty(i,T,Object.getOwnPropertyDescriptor(O,T))})}return i}({},e)},revive:function(e){return e}}},f=[{arrayNonindexKeys:{testPlainObjects:!0,test:function(e,t){return!!Array.isArray(e)&&(Object.keys(e).some(function(i){return String(Number.parseInt(i))!==i})&&(t.iterateIn="object",t.addLength=!0),!0)},replace:function(e,t){return t.iterateUnsetNumeric=!0,e},revive:function(e){if(Array.isArray(e))return e;var t=[];return Object.keys(e).forEach(function(i){var a=e[i];t[i]=a}),t}}},{sparseUndefined:{test:function(e,t){return e===void 0&&t.ownKeys===!1},replace:function(e){return 0},revive:function(e){}}}],y={undef:{test:function(e,t){return e===void 0&&(t.ownKeys||!("ownKeys"in t))},replace:function(e){return 0},revive:function(e){return new D.Undefined}}},d={StringObject:{test:function(e){return D.toStringTag(e)==="String"&&u(e)==="object"},replace:function(e){return String(e)},revive:function(e){return new String(e)}},BooleanObject:{test:function(e){return D.toStringTag(e)==="Boolean"&&u(e)==="object"},replace:function(e){return!!e},revive:function(e){return new Boolean(e)}},NumberObject:{test:function(e){return D.toStringTag(e)==="Number"&&u(e)==="object"},replace:function(e){return Number(e)},revive:function(e){return new Number(e)}}},h=[{nan:{test:function(e){return Number.isNaN(e)},replace:function(e){return"NaN"},revive:function(e){return Number.NaN}}},{infinity:{test:function(e){return e===Number.POSITIVE_INFINITY},replace:function(e){return"Infinity"},revive:function(e){return Number.POSITIVE_INFINITY}}},{negativeInfinity:{test:function(e){return e===Number.NEGATIVE_INFINITY},replace:function(e){return"-Infinity"},revive:function(e){return Number.NEGATIVE_INFINITY}}}],A={date:{test:function(e){return D.toStringTag(e)==="Date"},replace:function(e){var t=e.getTime();return Number.isNaN(t)?"NaN":t},revive:function(e){return e==="NaN"?new Date(Number.NaN):new Date(e)}}},G={regexp:{test:function(e){return D.toStringTag(e)==="RegExp"},replace:function(e){return{source:e.source,flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":"")}},revive:function(e){var t=e.source,i=e.flags;return new RegExp(t,i)}}},H={map:{test:function(e){return D.toStringTag(e)==="Map"},replace:function(e){return I(e.entries())},revive:function(e){return new Map(e)}}},W={set:{test:function(e){return D.toStringTag(e)==="Set"},replace:function(e){return I(e.values())},revive:function(e){return new Set(e)}}},j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ae=new Uint8Array(256),Ue=0;Ue<j.length;Ue++)Ae[j.charCodeAt(Ue)]=Ue;var Re=function(e,t,i){i==null&&(i=e.byteLength);for(var a=new Uint8Array(e,t||0,i),O=a.length,T="",C=0;C<O;C+=3)T+=j[a[C]>>2],T+=j[(3&a[C])<<4|a[C+1]>>4],T+=j[(15&a[C+1])<<2|a[C+2]>>6],T+=j[63&a[C+2]];return O%3==2?T=T.slice(0,-1)+"=":O%3==1&&(T=T.slice(0,-2)+"=="),T},Ye=function(e){var t,i,a,O,T=e.length,C=.75*e.length,N=0;e[e.length-1]==="="&&(C--,e[e.length-2]==="="&&C--);for(var L=new ArrayBuffer(C),Y=new Uint8Array(L),q=0;q<T;q+=4)t=Ae[e.charCodeAt(q)],i=Ae[e.charCodeAt(q+1)],a=Ae[e.charCodeAt(q+2)],O=Ae[e.charCodeAt(q+3)],Y[N++]=t<<2|i>>4,Y[N++]=(15&i)<<4|a>>2,Y[N++]=(3&a)<<6|63&O;return L},qe={arraybuffer:{test:function(e){return D.toStringTag(e)==="ArrayBuffer"},replace:function(e,t){t.buffers||(t.buffers=[]);var i=t.buffers.indexOf(e);return i>-1?{index:i}:(t.buffers.push(e),Re(e))},revive:function(e,t){if(t.buffers||(t.buffers=[]),u(e)==="object")return t.buffers[e.index];var i=Ye(e);return t.buffers.push(i),i}}},Xe=typeof self>"u"?yt:self,Fe={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(n){var e=n,t=Xe[e];t&&(Fe[n.toLowerCase()]={test:function(a){return D.toStringTag(a)===e},replace:function(a,O){var T=a.buffer,C=a.byteOffset,N=a.length;O.buffers||(O.buffers=[]);var L=O.buffers.indexOf(T);return L>-1?{index:L,byteOffset:C,length:N}:(O.buffers.push(T),{encoded:Re(T),byteOffset:C,length:N})},revive:function(a,O){O.buffers||(O.buffers=[]);var T,C=a.byteOffset,N=a.length,L=a.encoded,Y=a.index;return"index"in a?T=O.buffers[Y]:(T=Ye(L),O.buffers.push(T)),new t(T,C,N)}})});var ze={dataview:{test:function(e){return D.toStringTag(e)==="DataView"},replace:function(e,t){var i=e.buffer,a=e.byteOffset,O=e.byteLength;t.buffers||(t.buffers=[]);var T=t.buffers.indexOf(i);return T>-1?{index:T,byteOffset:a,byteLength:O}:(t.buffers.push(i),{encoded:Re(i),byteOffset:a,byteLength:O})},revive:function(e,t){t.buffers||(t.buffers=[]);var i,a=e.byteOffset,O=e.byteLength,T=e.encoded,C=e.index;return"index"in e?i=t.buffers[C]:(i=Ye(T),t.buffers.push(i)),new DataView(i,a,O)}}},me={IntlCollator:{test:function(e){return D.hasConstructorOf(e,Intl.Collator)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.Collator(e.locale,e)}},IntlDateTimeFormat:{test:function(e){return D.hasConstructorOf(e,Intl.DateTimeFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.DateTimeFormat(e.locale,e)}},IntlNumberFormat:{test:function(e){return D.hasConstructorOf(e,Intl.NumberFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.NumberFormat(e.locale,e)}}};function oe(n){for(var e=new Uint8Array(n.length),t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e.buffer}var te={file:{test:function(e){return D.toStringTag(e)==="File"},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),t.status!==200&&t.status!==0)throw new Error("Bad File access: "+t.status);return{type:e.type,stringContents:t.responseText,name:e.name,lastModified:e.lastModified}},revive:function(e){var t=e.name,i=e.type,a=e.stringContents,O=e.lastModified;return new File([oe(a)],t,{type:i,lastModified:O})},replaceAsync:function(e){return new D.Promise(function(t,i){var a=new FileReader;a.addEventListener("load",function(){t({type:e.type,stringContents:a.result,name:e.name,lastModified:e.lastModified})}),a.addEventListener("error",function(){i(a.error)}),a.readAsBinaryString(e)})}}},se={bigint:{test:function(e){return typeof e=="bigint"},replace:function(e){return String(e)},revive:function(e){return BigInt(e)}}},ge={bigintObject:{test:function(e){return u(e)==="object"&&D.hasConstructorOf(e,BigInt)},replace:function(e){return String(e)},revive:function(e){return new Object(BigInt(e))}}},B={cryptokey:{test:function(e){return D.toStringTag(e)==="CryptoKey"&&e.extractable},replaceAsync:function(e){return new D.Promise(function(t,i){crypto.subtle.exportKey("jwk",e).catch(function(a){i(a)}).then(function(a){t({jwk:a,algorithm:e.algorithm,usages:e.usages})})})},revive:function(e){var t=e.jwk,i=e.algorithm,a=e.usages;return crypto.subtle.importKey("jwk",t,i,!0,a)}}};return[ke,y,f,d,h,A,G,{imagedata:{test:function(e){return D.toStringTag(e)==="ImageData"},replace:function(e){return{array:I(e.data),width:e.width,height:e.height}},revive:function(e){return new ImageData(new Uint8ClampedArray(e.array),e.width,e.height)}}},{imagebitmap:{test:function(e){return D.toStringTag(e)==="ImageBitmap"||e&&e.dataset&&e.dataset.toStringTag==="ImageBitmap"},replace:function(e){var t=document.createElement("canvas");return t.getContext("2d").drawImage(e,0,0),t.toDataURL()},revive:function(e){var t=document.createElement("canvas"),i=t.getContext("2d"),a=document.createElement("img");return a.addEventListener("load",function(){i.drawImage(a,0,0)}),a.src=e,t},reviveAsync:function(e){var t=document.createElement("canvas"),i=t.getContext("2d"),a=document.createElement("img");return a.addEventListener("load",function(){i.drawImage(a,0,0)}),a.src=e,createImageBitmap(t)}}},te,{file:te.file,filelist:{test:function(e){return D.toStringTag(e)==="FileList"},replace:function(e){for(var t=[],i=0;i<e.length;i++)t[i]=e.item(i);return t},revive:function(e){return new(function(){function t(){g(this,t),this._files=arguments[0],this.length=this._files.length}return function(a,O,T){return O&&w(a.prototype,O),T&&w(a,T),a}(t,[{key:"item",value:function(a){return this._files[a]}},{key:Symbol.toStringTag,get:function(){return"FileList"}}]),t}())(e)}}},{blob:{test:function(e){return D.toStringTag(e)==="Blob"},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),t.status!==200&&t.status!==0)throw new Error("Bad Blob access: "+t.status);return{type:e.type,stringContents:t.responseText}},revive:function(e){var t=e.type,i=e.stringContents;return new Blob([oe(i)],{type:t})},replaceAsync:function(e){return new D.Promise(function(t,i){var a=new FileReader;a.addEventListener("load",function(){t({type:e.type,stringContents:a.result})}),a.addEventListener("error",function(){i(a.error)}),a.readAsBinaryString(e)})}}}].concat(typeof Map=="function"?H:[],typeof Set=="function"?W:[],typeof ArrayBuffer=="function"?qe:[],typeof Uint8Array=="function"?Fe:[],typeof DataView=="function"?ze:[],typeof Intl<"u"?me:[],typeof crypto<"u"?B:[],typeof BigInt<"u"?[se,ge]:[])})}),rt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",at=new Uint8Array(256);for(it=0;it<rt.length;it++)at[rt.codePointAt(it)]=it;var it,dt=function(v,u,g){g==null&&(g=v.byteLength);for(var w=new Uint8Array(v,u||0,g),p=w.length,o="",I=0;I<p;I+=3)o+=rt[w[I]>>2],o+=rt[(w[I]&3)<<4|w[I+1]>>4],o+=rt[(w[I+1]&15)<<2|w[I+2]>>6],o+=rt[w[I+2]&63];return p%3===2?o=o.slice(0,-1)+"=":p%3===1&&(o=o.slice(0,-2)+"=="),o},mt=function(v){var u=v.length,g=v.length*.75,w=0,p,o,I,U;v[v.length-1]==="="&&(g--,v[v.length-2]==="="&&g--);for(var s=new ArrayBuffer(g),E=new Uint8Array(s),F=0;F<u;F+=4)p=at[v.codePointAt(F)],o=at[v.codePointAt(F+1)],I=at[v.codePointAt(F+2)],U=at[v.codePointAt(F+3)],E[w++]=p<<2|o>>4,E[w++]=(o&15)<<4|I>>2,E[w++]=(I&3)<<6|U&63;return s},_t=typeof self>"u"?global:self,gt={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(b){var v=b,u=_t[v];u&&(gt[b.toLowerCase()+"2"]={test:function(g){return ct.toStringTag(g)===v},replace:function(g){var w=g.buffer,p=g.byteOffset,o=g.length;return{buffer:w,byteOffset:p,length:o}},revive:function(g){var w=g.buffer,p=g.byteOffset,o=g.length;return new u(w,p,o)}})});var Pt={arraybuffer:{test:function(b){return ct.toStringTag(b)==="ArrayBuffer"},replace:function(b){return dt(b,0,b.byteLength)},revive:function(b){var v=mt(b);return v}}},Je=new ct().register(Nt),It="FileReaderSync"in self,ut=[],pt=0;Je.register([Pt,gt,{blob2:{test:function(b){return ct.toStringTag(b)==="Blob"},replace:function(b){if(b.isClosed)throw new Error("The Blob is closed");if(It){var v=bt(b,"binary"),u=dt(v,0,v.byteLength);return{type:b.type,data:u}}else{ut.push(b);var g={type:b.type,data:{start:pt,end:pt+b.size}};return pt+=b.size,g}},finalize:function(b,v){b.data=dt(v,0,v.byteLength)},revive:function(b){var v=b.type,u=b.data;return new Blob([mt(u)],{type:v})}}}]);Je.mustFinalize=function(){return ut.length>0};Je.finalize=function(b){return Ze(void 0,void 0,void 0,function(){var v,u,g,w,p,o,I,U,s,E;return Me(this,function(F){switch(F.label){case 0:return[4,vt(new Blob(ut),"binary")];case 1:if(v=F.sent(),b){for(u=0,g=b;u<g.length;u++)if(w=g[u],w.$types){p=w.$types,o=p.$,o&&(p=p.$);for(I in p)U=p[I],s=Je.types[U],s&&s.finalize&&(E=Ce.getByKeyPath(w,o?"$."+I:I),s.finalize(E,v.slice(E.start,E.end)))}}return ut=[],[2]}})})};var Bt=2e3;function Ct(b,v){return Ze(this,void 0,void 0,function(){function u(){return Ze(this,void 0,void 0,function(){var F,ve,Oe,J,V,ee,Ee,be,_,_e;return Me(this,function(K){switch(K.label){case 0:return[4,Promise.all(w.map(function(ne){return ne.count()}))];case 1:F=K.sent(),F.forEach(function(ne,re){return o[re].rowCount=ne}),E.totalRows=F.reduce(function(ne,re){return ne+re}),ve=JSON.stringify(U,void 0,I?2:void 0),Oe=ve.lastIndexOf("]"),J=ve.substring(0,Oe),p.push(J),V=v.filter,ee=v.transform,Ee=function(ne){var re,Pe,c,r,m,l,Z,M,ie,de,Se,je;return Me(this,function(Ne){switch(Ne.label){case 0:re=b.table(ne),Pe=re.schema.primKey,c=!!Pe.keyPath,r=v.numRowsPerChunk||Bt,m=c?{tableName:re.name,inbound:!0,rows:[]}:{tableName:re.name,inbound:!1,rows:[]},l=JSON.stringify(m,void 0,I?2:void 0),I&&(l=l.split(`
`).join(`
    `)),Z=l.lastIndexOf("]"),p.push(l.substring(0,Z)),M=null,ie=0,de=!0,Se=function(){var ce,he,xe,Ge,D,y,pe,ke,f,y;return Me(this,function(d){switch(d.label){case 0:return s&&Ce.ignoreTransaction(function(){return s(E)}),ce=M==null?re.limit(r):re.where(":id").above(M).limit(r),[4,ce.toArray()];case 1:return he=d.sent(),he.length===0?[2,"break"]:(M!=null&&ie>0&&(p.push(","),I&&p.push(`
      `)),de=he.length===r,c?(xe=V?he.filter(function(h){return V(ne,h)}):he,Ge=ee?xe.map(function(h){return ee(ne,h).value}):xe,D=Ge.map(function(h){return Je.encapsulate(h)}),Je.mustFinalize()?[4,Ce.waitFor(Je.finalize(D))]:[3,3]):[3,4]);case 2:d.sent(),d.label=3;case 3:return y=JSON.stringify(D,void 0,I?2:void 0),I&&(y=y.split(`
`).join(`
      `)),p.push(new Blob([y.substring(1,y.length-1)])),ie=Ge.length,M=he.length>0?Ce.getByKeyPath(he[he.length-1],Pe.keyPath):null,[3,8];case 4:return[4,ce.primaryKeys()];case 5:return pe=d.sent(),ke=pe.map(function(h,A){return[h,he[A]]}),V&&(ke=ke.filter(function(h){var A=h[0],G=h[1];return V(ne,G,A)})),ee&&(ke=ke.map(function(h){var A=h[0],G=h[1],H=ee(ne,G,A);return[H.key,H.value]})),f=ke.map(function(h){return Je.encapsulate(h)}),Je.mustFinalize()?[4,Ce.waitFor(Je.finalize(f))]:[3,7];case 6:d.sent(),d.label=7;case 7:y=JSON.stringify(f,void 0,I?2:void 0),I&&(y=y.split(`
`).join(`
      `)),p.push(new Blob([y.substring(1,y.length-1)])),ie=ke.length,M=pe.length>0?pe[pe.length-1]:null,d.label=8;case 8:return E.completedRows+=he.length,[2]}})},Ne.label=1;case 1:return de?[5,Se()]:[3,3];case 2:return je=Ne.sent(),je==="break"?[3,3]:[3,1];case 3:return p.push(l.substr(Z)),E.completedTables+=1,E.completedTables<E.totalTables&&p.push(","),[2]}})},be=0,_=o,K.label=2;case 2:return be<_.length?(_e=_[be].name,[5,Ee(_e)]):[3,5];case 3:K.sent(),K.label=4;case 4:return be++,[3,2];case 5:return p.push(ve.substr(Oe)),E.done=!0,s&&Ce.ignoreTransaction(function(){return s(E)}),[2]}})})}var g,w,p,o,I,U,s,E;return Me(this,function(F){switch(F.label){case 0:v=v||{},g=v.skipTables?v.skipTables:[],w=b.tables.filter(function(ve){return!g.includes(ve.name)}),p=[],o=w.map(function(ve){return{name:ve.name,schema:Tt(ve),rowCount:0}}),I=v.prettyJson,U={formatName:"dexie",formatVersion:1,data:{databaseName:b.name,databaseVersion:b.verno,tables:o,data:[]}},s=v.progressCallback,E={done:!1,completedRows:0,completedTables:0,totalRows:NaN,totalTables:o.length},F.label=1;case 1:return F.trys.push([1,,6,7]),v.noTransaction?[4,u()]:[3,3];case 2:return F.sent(),[3,5];case 3:return[4,b.transaction("r",b.tables,u)];case 4:F.sent(),F.label=5;case 5:return[3,7];case 6:return Je.finalize(),[7];case 7:return[2,new Blob(p,{type:"text/json"})]}})})}var jt=1,xt={Stream:function(){}},kt=ht(function(b,v){(function(u){var g=typeof process=="object"&&process.env?process.env:self;u.parser=function(c){return new Oe(c)},u.CParser=Oe,u.CStream=V,u.createStream=J,u.MAX_BUFFER_LENGTH=10*1024*1024,u.DEBUG=g.CDEBUG==="debug",u.INFO=g.CDEBUG==="debug"||g.CDEBUG==="info",u.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var w={textNode:void 0,numberNode:""},p=u.EVENTS.filter(function(c){return c!=="error"&&c!=="end"}),o=0,I;u.STATE={BEGIN:o++,VALUE:o++,OPEN_OBJECT:o++,CLOSE_OBJECT:o++,OPEN_ARRAY:o++,CLOSE_ARRAY:o++,TEXT_ESCAPE:o++,STRING:o++,BACKSLASH:o++,END:o++,OPEN_KEY:o++,CLOSE_KEY:o++,TRUE:o++,TRUE2:o++,TRUE3:o++,FALSE:o++,FALSE2:o++,FALSE3:o++,FALSE4:o++,NULL:o++,NULL2:o++,NULL3:o++,NUMBER_DECIMAL_POINT:o++,NUMBER_DIGIT:o++};for(var U in u.STATE)u.STATE[u.STATE[U]]=U;o=u.STATE;let s={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};Object.create||(Object.create=function(c){function r(){this.__proto__=c}return r.prototype=c,new r}),Object.getPrototypeOf||(Object.getPrototypeOf=function(c){return c.__proto__}),Object.keys||(Object.keys=function(c){var r=[];for(var m in c)c.hasOwnProperty(m)&&r.push(m);return r});function E(c){var r=Math.max(u.MAX_BUFFER_LENGTH,10),m=0;for(var l in w){var Z=c[l]===void 0?0:c[l].length;if(Z>r)switch(l){case"text":closeText(c);break;default:K(c,"Max buffer length exceeded: "+l)}m=Math.max(m,Z)}c.bufferCheckPosition=u.MAX_BUFFER_LENGTH-m+c.position}function F(c){for(var r in w)c[r]=w[r]}var ve=/[\\"\n]/g;function Oe(c){if(!(this instanceof Oe))return new Oe(c);var r=this;F(r),r.bufferCheckPosition=u.MAX_BUFFER_LENGTH,r.q=r.c=r.p="",r.opt=c||{},r.closed=r.closedRoot=r.sawRoot=!1,r.tag=r.error=null,r.state=o.BEGIN,r.stack=new Array,r.position=r.column=0,r.line=1,r.slashed=!1,r.unicodeI=0,r.unicodeS=null,r.depth=0,ee(r,"onready")}Oe.prototype={end:function(){ne(this)},write:Pe,resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{I=xt.Stream}catch{I=function(){}}function J(c){return new V(c)}function V(c){if(!(this instanceof V))return new V(c);this._parser=new Oe(c),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var r=this;I.apply(r),this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(m){r.emit("error",m),r._parser.error=null},p.forEach(function(m){Object.defineProperty(r,"on"+m,{get:function(){return r._parser["on"+m]},set:function(l){if(!l)return r.removeAllListeners(m),r._parser["on"+m]=l,l;r.on(m,l)},enumerable:!0,configurable:!1})})}V.prototype=Object.create(I.prototype,{constructor:{value:V}}),V.prototype.write=function(c){c=new Buffer(c);for(var r=0;r<c.length;r++){var m=c[r];if(this.bytes_remaining>0){for(var l=0;l<this.bytes_remaining;l++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+l]=c[l];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,r=r+l-1,this._parser.write(this.string),this.emit("data",this.string);continue}if(this.bytes_remaining===0&&m>=128)if(m>=194&&m<=223&&(this.bytes_in_sequence=2),m>=224&&m<=239&&(this.bytes_in_sequence=3),m>=240&&m<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+r>c.length){for(var Z=0;Z<=c.length-1-r;Z++)this.temp_buffs[this.bytes_in_sequence][Z]=c[r+Z];return this.bytes_remaining=r+this.bytes_in_sequence-c.length,!0}else{this.string=c.slice(r,r+this.bytes_in_sequence).toString(),r=r+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string);continue}for(var M=r;M<c.length&&!(c[M]>=128);M++);this.string=c.slice(r,M).toString(),this._parser.write(this.string),this.emit("data",this.string),r=M-1}},V.prototype.end=function(c){return c&&c.length&&this._parser.write(c.toString()),this._parser.end(),!0},V.prototype.on=function(c,r){var m=this;return!m._parser["on"+c]&&p.indexOf(c)!==-1&&(m._parser["on"+c]=function(){var l=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);l.splice(0,0,c),m.emit.apply(m,l)}),I.prototype.on.call(m,c,r)},V.prototype.destroy=function(){F(this._parser),this.emit("close")};function ee(c,r,m){u.INFO&&console.log("-- emit",r,m),c[r]&&c[r](m)}function Ee(c,r,m){be(c),ee(c,r,m)}function be(c,r){c.textNode=_e(c.opt,c.textNode),c.textNode!==void 0&&ee(c,r||"onvalue",c.textNode),c.textNode=void 0}function _(c){c.numberNode&&ee(c,"onvalue",parseFloat(c.numberNode)),c.numberNode=""}function _e(c,r){return r===void 0||(c.trim&&(r=r.trim()),c.normalize&&(r=r.replace(/\s+/g," "))),r}function K(c,r){return be(c),r+=`
Line: `+c.line+`
Column: `+c.column+`
Char: `+c.c,r=new Error(r),c.error=r,ee(c,"onerror",r),c}function ne(c){return(c.state!==o.VALUE||c.depth!==0)&&K(c,"Unexpected end"),be(c),c.c="",c.closed=!0,ee(c,"onend"),Oe.call(c,c.opt),c}function re(c){return c===s.carriageReturn||c===s.lineFeed||c===s.space||c===s.tab}function Pe(c){var r=this;if(this.error)throw this.error;if(r.closed)return K(r,"Cannot write after close. Assign an onready handler.");if(c===null)return ne(r);var m=0,l=c.charCodeAt(0),Z=r.p;for(u.DEBUG&&console.log("write -> ["+c+"]");l&&(Z=l,r.c=l=c.charCodeAt(m++),Z!==l?r.p=Z:Z=r.p,!!l);)switch(u.DEBUG&&console.log(m,l,u.STATE[r.state]),r.position++,l===s.lineFeed?(r.line++,r.column=0):r.column++,r.state){case o.BEGIN:l===s.openBrace?r.state=o.OPEN_OBJECT:l===s.openBracket?r.state=o.OPEN_ARRAY:re(l)||K(r,"Non-whitespace before {[.");continue;case o.OPEN_KEY:case o.OPEN_OBJECT:if(re(l))continue;if(r.state===o.OPEN_KEY)r.stack.push(o.CLOSE_KEY);else if(l===s.closeBrace){ee(r,"onopenobject"),this.depth++,ee(r,"oncloseobject"),this.depth--,r.state=r.stack.pop()||o.VALUE;continue}else r.stack.push(o.CLOSE_OBJECT);l===s.doubleQuote?r.state=o.STRING:K(r,'Malformed object key should start with "');continue;case o.CLOSE_KEY:case o.CLOSE_OBJECT:if(re(l))continue;r.state,o.CLOSE_KEY,l===s.colon?(r.state===o.CLOSE_OBJECT?(r.stack.push(o.CLOSE_OBJECT),be(r,"onopenobject"),this.depth++):be(r,"onkey"),r.state=o.VALUE):l===s.closeBrace?(Ee(r,"oncloseobject"),this.depth--,r.state=r.stack.pop()||o.VALUE):l===s.comma?(r.state===o.CLOSE_OBJECT&&r.stack.push(o.CLOSE_OBJECT),be(r),r.state=o.OPEN_KEY):K(r,"Bad object");continue;case o.OPEN_ARRAY:case o.VALUE:if(re(l))continue;if(r.state===o.OPEN_ARRAY)if(ee(r,"onopenarray"),this.depth++,r.state=o.VALUE,l===s.closeBracket){ee(r,"onclosearray"),this.depth--,r.state=r.stack.pop()||o.VALUE;continue}else r.stack.push(o.CLOSE_ARRAY);l===s.doubleQuote?r.state=o.STRING:l===s.openBrace?r.state=o.OPEN_OBJECT:l===s.openBracket?r.state=o.OPEN_ARRAY:l===s.t?r.state=o.TRUE:l===s.f?r.state=o.FALSE:l===s.n?r.state=o.NULL:l===s.minus?r.numberNode+="-":s._0<=l&&l<=s._9?(r.numberNode+=String.fromCharCode(l),r.state=o.NUMBER_DIGIT):K(r,"Bad value");continue;case o.CLOSE_ARRAY:if(l===s.comma)r.stack.push(o.CLOSE_ARRAY),be(r,"onvalue"),r.state=o.VALUE;else if(l===s.closeBracket)Ee(r,"onclosearray"),this.depth--,r.state=r.stack.pop()||o.VALUE;else{if(re(l))continue;K(r,"Bad array")}continue;case o.STRING:r.textNode===void 0&&(r.textNode="");var M=m-1,ie=r.slashed,de=r.unicodeI;e:for(;;){for(u.DEBUG&&console.log(m,l,u.STATE[r.state],ie);de>0;)if(r.unicodeS+=String.fromCharCode(l),l=c.charCodeAt(m++),r.position++,de===4?(r.textNode+=String.fromCharCode(parseInt(r.unicodeS,16)),de=0,M=m-1):de++,!l)break e;if(l===s.doubleQuote&&!ie){r.state=r.stack.pop()||o.VALUE,r.textNode+=c.substring(M,m-1),r.position+=m-1-M;break}if(l===s.backslash&&!ie&&(ie=!0,r.textNode+=c.substring(M,m-1),r.position+=m-1-M,l=c.charCodeAt(m++),r.position++,!l))break;if(ie){if(ie=!1,l===s.n?r.textNode+=`
`:l===s.r?r.textNode+="\r":l===s.t?r.textNode+="	":l===s.f?r.textNode+="\f":l===s.b?r.textNode+="\b":l===s.u?(de=1,r.unicodeS=""):r.textNode+=String.fromCharCode(l),l=c.charCodeAt(m++),r.position++,M=m-1,l)continue;break}ve.lastIndex=m;var Se=ve.exec(c);if(Se===null){m=c.length+1,r.textNode+=c.substring(M,m-1),r.position+=m-1-M;break}if(m=Se.index+1,l=c.charCodeAt(Se.index),!l){r.textNode+=c.substring(M,m-1),r.position+=m-1-M;break}}r.slashed=ie,r.unicodeI=de;continue;case o.TRUE:l===s.r?r.state=o.TRUE2:K(r,"Invalid true started with t"+l);continue;case o.TRUE2:l===s.u?r.state=o.TRUE3:K(r,"Invalid true started with tr"+l);continue;case o.TRUE3:l===s.e?(ee(r,"onvalue",!0),r.state=r.stack.pop()||o.VALUE):K(r,"Invalid true started with tru"+l);continue;case o.FALSE:l===s.a?r.state=o.FALSE2:K(r,"Invalid false started with f"+l);continue;case o.FALSE2:l===s.l?r.state=o.FALSE3:K(r,"Invalid false started with fa"+l);continue;case o.FALSE3:l===s.s?r.state=o.FALSE4:K(r,"Invalid false started with fal"+l);continue;case o.FALSE4:l===s.e?(ee(r,"onvalue",!1),r.state=r.stack.pop()||o.VALUE):K(r,"Invalid false started with fals"+l);continue;case o.NULL:l===s.u?r.state=o.NULL2:K(r,"Invalid null started with n"+l);continue;case o.NULL2:l===s.l?r.state=o.NULL3:K(r,"Invalid null started with nu"+l);continue;case o.NULL3:l===s.l?(ee(r,"onvalue",null),r.state=r.stack.pop()||o.VALUE):K(r,"Invalid null started with nul"+l);continue;case o.NUMBER_DECIMAL_POINT:l===s.period?(r.numberNode+=".",r.state=o.NUMBER_DIGIT):K(r,"Leading zero not followed by .");continue;case o.NUMBER_DIGIT:s._0<=l&&l<=s._9?r.numberNode+=String.fromCharCode(l):l===s.period?(r.numberNode.indexOf(".")!==-1&&K(r,"Invalid number has two dots"),r.numberNode+="."):l===s.e||l===s.E?((r.numberNode.indexOf("e")!==-1||r.numberNode.indexOf("E")!==-1)&&K(r,"Invalid number has two exponential"),r.numberNode+="e"):l===s.plus||l===s.minus?(Z===s.e||Z===s.E||K(r,"Invalid symbol in number"),r.numberNode+=String.fromCharCode(l)):(_(r),m--,r.state=r.stack.pop()||o.VALUE);continue;default:K(r,"Unknown state: "+r.state)}return r.position>=r.bufferCheckPosition&&E(r),r}})(v)});function wt(b){var v=0,u=Ut(!0),g={pullAsync:function(w){return Ze(this,void 0,void 0,function(){var p,o,I;return Me(this,function(U){switch(U.label){case 0:return p=b.slice(v,v+w),v+=w,[4,vt(p,"text")];case 1:return o=U.sent(),I=u.write(o),g.result=I||{},[2,I]}})})},pullSync:function(w){var p=b.slice(v,v+w);v+=w;var o=bt(p,"text"),I=u.write(o);return g.result=I||{},I},done:function(){return u.done()},eof:function(){return v>=b.size},result:{}};return g}function Ut(b){var v=kt.parser(),u=0,g,w=[],p,o,I=!1,U=!1;return v.onopenobject=function(s){var E={};E.incomplete=!0,g||(g=E),p&&(w.push([o,p,U]),b&&(U?p.push(E):p[o]=E)),p=E,o=s,U=!1,++u},v.onkey=function(s){return o=s},v.onvalue=function(s){return U?p.push(s):p[o]=s},v.oncloseobject=function(){var s;if(delete p.incomplete,o=null,--u===0)I=!0;else{var E=p;s=w.pop(),o=s[0],p=s[1],U=s[2],b||(U?p.push(E):p[o]=E)}},v.onopenarray=function(){var s=[];s.incomplete=!0,g||(g=s),p&&(w.push([o,p,U]),b&&(U?p.push(s):p[o]=s)),p=s,U=!0,o=null,++u},v.onclosearray=function(){var s;if(delete p.incomplete,o=null,--u===0)I=!0;else{var E=p;s=w.pop(),o=s[0],p=s[1],U=s[2],b||(U?p.push(E):p[o]=E)}},{write:function(s){return v.write(s),g},done:function(){return I}}}var Ot=1024;function Lt(b,v){return Ze(this,void 0,void 0,function(){var u,g,w,p;return Me(this,function(o){switch(o.label){case 0:return v=v||{},u=v.chunkSizeBytes||Ot*1024,[4,At(b,u)];case 1:return g=o.sent(),w=g.result.data,p=new Ce(w.databaseName),p.version(w.databaseVersion).stores(Et(w)),[4,St(p,g,v)];case 2:return o.sent(),[2,p]}})})}function Ft(b){return Ze(this,void 0,void 0,function(){var v;return Me(this,function(u){switch(u.label){case 0:v=wt(b),u.label=1;case 1:return v.eof()?[3,3]:[4,v.pullAsync(5*1024)];case 2:return u.sent(),v.result.data&&v.result.data.data?(delete v.result.data.data,[3,3]):[3,1];case 3:return[2,v.result]}})})}function St(b,v,u){return Ze(this,void 0,void 0,function(){function g(){return Ze(this,void 0,void 0,function(){var V,ee,Ee,be,_;return Me(this,function(_e){switch(_e.label){case 0:V=function(K){var ne,re,Pe,c,r,m,l,Z,M,ie,de,Se,je;return Me(this,function(Ne){switch(Ne.label){case 0:if(s.includes(K.tableName))return[2,"continue"];if(!K.rows)return[2,"break"];if(!K.rows.incomplete&&K.rows.length===0)return[2,"continue"];if(E&&Ce.ignoreTransaction(function(){return E(F)}),ne=K.tableName,re=b.table(ne),Pe=U.tables.filter(function(ce){return ce.name===ne})[0].schema,!re){if(u.acceptMissingTables)return[2,"continue"];throw new Error("Exported table ".concat(K.tableName," is missing in installed database"))}if(!u.acceptChangedPrimaryKey&&Pe.split(",")[0]!=re.schema.primKey.src)throw new Error("Primary key differs for table ".concat(K.tableName,". "));for(c=K.rows,r=[],m=0;m<c.length&&(l=c[m],!l.incomplete);m++)r.push(Je.revive(l));return Z=u.filter,M=u.transform,ie=Z?K.inbound?r.filter(function(ce){return Z(ne,ce)}):r.filter(function(ce){var he=ce[0],xe=ce[1];return Z(ne,xe,he)}):r,M&&(ie=ie.map(K.inbound?function(ce){return M(ne,ce).value}:function(ce){var he=ce[0],xe=ce[1],Ge=M(ne,xe,he);return[Ge.key,Ge.value]})),de=K.inbound?[void 0,ie]:[ie.map(function(ce){return ce[0]}),r.map(function(ce){return ce[1]})],Se=de[0],je=de[1],u.overwriteValues?[4,re.bulkPut(je,Se)]:[3,2];case 1:return Ne.sent(),[3,4];case 2:return[4,re.bulkAdd(je,Se)];case 3:Ne.sent(),Ne.label=4;case 4:return F.completedRows+=r.length,r.incomplete||(F.completedTables+=1),c.splice(0,r.length),[2]}})},ee=0,Ee=U.data,_e.label=1;case 1:return ee<Ee.length?(be=Ee[ee],[5,V(be)]):[3,4];case 2:if(_=_e.sent(),_==="break")return[3,4];_e.label=3;case 3:return ee++,[3,1];case 4:for(;U.data.length>0&&U.data[0].rows&&!U.data[0].rows.incomplete;)U.data.splice(0,1);return!p.done()&&!p.eof()?I?(p.pullSync(w),[3,7]):[3,5]:[3,8];case 5:return[4,Ce.waitFor(p.pullAsync(w))];case 6:_e.sent(),_e.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,0];case 10:return[2]}})})}var w,p,o,I,U,s,E,F,ve,Oe,J;return Me(this,function(V){switch(V.label){case 0:return u=u||{},w=u.chunkSizeBytes||Ot*1024,[4,At(v,w)];case 1:if(p=V.sent(),o=p.result,I="FileReaderSync"in self,U=o.data,s=u.skipTables?u.skipTables:[],!u.acceptNameDiff&&b.name!==U.databaseName)throw new Error("Name differs. Current database name is ".concat(b.name," but export is ").concat(U.databaseName));if(!u.acceptVersionDiff&&b.verno!==U.databaseVersion)throw new Error("Database version differs. Current database is in version ".concat(b.verno," but export is ").concat(U.databaseVersion));if(E=u.progressCallback,F={done:!1,completedRows:0,completedTables:0,totalRows:U.tables.reduce(function(ee,Ee){return ee+Ee.rowCount},0),totalTables:U.tables.length},E&&Ce.ignoreTransaction(function(){return E(F)}),!u.clearTablesBeforeImport)return[3,5];ve=0,Oe=b.tables,V.label=2;case 2:return ve<Oe.length?(J=Oe[ve],s.includes(J.name)?[3,4]:[4,J.clear()]):[3,5];case 3:V.sent(),V.label=4;case 4:return ve++,[3,2];case 5:return u.noTransaction?[4,g()]:[3,7];case 6:return V.sent(),[3,9];case 7:return[4,b.transaction("rw",b.tables,g)];case 8:V.sent(),V.label=9;case 9:return F.done=!0,E&&Ce.ignoreTransaction(function(){return E(F)}),[2]}})})}function At(b,v){return Ze(this,void 0,void 0,function(){var u,g;return Me(this,function(w){switch(w.label){case 0:u="slice"in b?wt(b):b,w.label=1;case 1:return u.eof()?[3,3]:[4,u.pullAsync(v)];case 2:return w.sent(),u.result.data&&u.result.data.data?[3,3]:[3,1];case 3:if(g=u.result,!g||g.formatName!="dexie")throw new Error("Given file is not a dexie export");if(g.formatVersion>jt)throw new Error("Format version ".concat(g.formatVersion," not supported"));if(!g.data)throw new Error("No data in export file");if(!g.data.databaseName)throw new Error("Missing databaseName in export file");if(!g.data.databaseVersion)throw new Error("Missing databaseVersion in export file");if(!g.data.tables)throw new Error("Missing tables in export file");return[2,u]}})})}Ce.prototype.export=function(b){return Ct(this,b)};Ce.prototype.import=function(b,v){return St(this,b,v)};Ce.import=function(b,v){return Lt(b,v)};var Kt=function(){throw new Error("This addon extends Dexie.prototype globally and does not have be included in Dexie constructor's addons options.")};export{Kt as default,Ct as exportDB,Lt as importDB,St as importInto,Ft as peakImportFile};
