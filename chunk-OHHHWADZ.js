import{a as u,b as f}from"./chunk-B37HOSFI.js";import{a as _}from"./chunk-C2G75J7Z.js";import{e as N}from"./chunk-QZALCDFC.js";import{c as E,e as I,g as A,h as k,j as w,k as O,l as F,m as j,n as R,o as V,p as d,q as h}from"./chunk-GXXBZDPU.js";import"./chunk-5KUQE4MU.js";import{$a as T,Ea as l,L as S,P as m,ha as L}from"./chunk-OJNBBAHS.js";import{$ as a,Da as r,fa as o,q as v,vc as n,yc as b}from"./chunk-SJLNDPFN.js";import{a as p}from"./chunk-EQDQRRRY.js";var y=(()=>{class t{constructor(){this.id=r(void 0),this.heading=n(()=>this.id()??"--"),this.tabs=r([{label:"Raw",route:["raw"]}]),this.routeToFullContent=n(()=>["../","system-log",{outlets:{primary:["detail",this.id()],peek:null}}])}onParamsChange(e,i){this.id.set(e.id)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=a({token:t,factory:t.\u0275fac})}}return t})();var P=(()=>{class t{constructor(){this.dataService=o(f),this.id=r(void 0),this.rawData=m(this.dataService.getList()),this.isDirty=r(!1),this.updatedValue=r(void 0),this.data=r(void 0),this.fieldConfiguration=r({type:"object",properties:{timestamp:{type:"date-time",description:"Timestamp"},message:{type:"string",description:"Message"},level:{type:"string",description:"Level",enum:Object.values(u)},context:{type:"string",description:"Context"},customerId:{type:"string",description:"Customer ID"},employeeId:{type:"string",description:"Employee ID"},ipAddress:{type:"string",description:"IP Address"},detail:{type:"string",description:"Detail"}}}),this.controlsConfig=r(E),b(()=>{this.data.set(S(this.rawData()?.find(e=>e.id==this.id())))})}registerUpdateState(e){this.updateState=e}onStateChange(e){this.isDirty.update(i=>e.isDirty??i)}onValueChange(e){this.updatedValue.set(e)}onControlClick(e,i){switch(e){case"refresh":{this.data.set(S(this.rawData()?.find(s=>s.id==this.id())));break}}}onParamsChange(e,i){this.id.set(e.id)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=a({token:t,factory:t.\u0275fac})}}return t})();var x=(()=>{class t{constructor(){this.heading=r("System Log"),this.tabs=r([{label:"Dashboard",route:["dashboard"]},{label:"Raw",route:["raw"]}])}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=a({token:t,factory:t.\u0275fac})}}return t})();var M=(()=>{class t{constructor(){this.screenWidth=o(L),this.dataService=o(f),this.rawData=m(this.dataService.getList()),this.customerDataService=o(_),this.customerData=m(this.customerDataService.getList()),this.employeeDataService=o(N),this.employeeData=m(this.employeeDataService.getList()),this.configuration={id:"system-log-table",useVirtualScroll:!0},this.data=n(()=>{let e=this.rawData()??[],i=this.customerData()??[],s=this.employeeData()??[];return e.toSorted(this.sortFn()).filter(this.filterFn()).map(c=>Object.assign(c,{user:c.customerId?i.find(D=>D.id==c.customerId):c.employeeId?s.find(D=>D.id==c.employeeId):null}))}),this.columnsConfig=r([{key:"timestamp",label:"Timestamp",fieldConfiguration:{type:"date-time",format:"yyyy-MM-dd HH:mm:ss.SSS"},isSortedDesc:!0},{key:"level",label:"Level"},{key:"message",label:"Message"},{key:"user",path:"user.name",label:"User"}]),this.columnsToDisplay=r({default:["timestamp","level","message"],1280:["timestamp","level","message","user"]}),this.controlsConfig=r(F),this.filterConfig=r({type:"object",properties:{id:{type:"string",description:"ID"},level:{type:"string",description:"Level",enum:Object.values(u)},message:{type:"string",description:"Message"},after:{type:"date-time",description:"After"}}}),this.filterValue=r({}),this.sortFn=n(()=>O(this.columnsConfig())),this.filterFn=n(()=>w(this.filterValue(),{id:(e,i,s)=>!!s&&e.id==s,message:(e,i,s)=>!!s&&e.message.includes(s),level:(e,i,s)=>!!s&&e.level==s,after:(e,i,s)=>!!s&&e.timestamp>s}))}routeToDetail(e){return this.screenWidth.above().sm()?["../../","system-log",{outlets:{peek:[e.id]}}]:["../","detail",e.id]}onHeaderCellClick(e,i){this.columnsConfig.update(s=>V(s,e))}onFilterChange(e){this.filterValue.set(e)}onControlClick(e,i){switch(e){case"add":break;case"refresh":break}}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=a({token:t,factory:t.\u0275fac})}}return t})();var U=[{path:"raw",component:A,canDeactivate:[T],providers:[{provide:I,useClass:P}]},{path:"**",redirectTo:"raw"}],De=[{path:"",data:p({},l({title:"System Log"})),children:[{path:"detail/:id",component:h,data:p({},l({titleFn:t=>t.params.pipe(v(g=>g.id))})),providers:[{provide:d,useClass:y}],children:U},{path:"",component:h,providers:[{provide:d,useClass:x},{provide:k,useClass:y}],children:[{path:":id",outlet:"peek",component:h,data:p({},l({titleFn:t=>t.params.pipe(v(g=>g.id))})),providers:[{provide:d,useClass:y}],children:U},{path:"dashboard",loadComponent:()=>import("./chunk-MCQ43EO3.js").then(t=>t.SystemLogDashboardComponent)},{path:"raw",component:R,providers:[{provide:j,useClass:M}]},{path:"**",redirectTo:"dashboard"}]}]}];export{De as ROUTES};
