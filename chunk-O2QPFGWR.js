import{a as h,b as f}from"./chunk-ZBQMP76J.js";import{a as R}from"./chunk-K7VH36KH.js";import{e as V}from"./chunk-PICL44IE.js";import{c as N,e as E,g as I,h as M,j as A,k,l as F,m as w,n as O,o as j,p as u,q as g}from"./chunk-X7QNMMHB.js";import"./chunk-QLEH2ZB5.js";import{Da as c,K as b,O as m,_a as L,ga as T}from"./chunk-4WQRPZ5G.js";import{$ as s,ea as n,q as v,qc as d,ra as r,rc as S}from"./chunk-LVH4HSPS.js";import{a as p}from"./chunk-C6Q5SG76.js";var D=(()=>{let t=class t{constructor(){this.id=r(void 0),this.heading=d(()=>this.id()??"--"),this.tabs=r([{label:"Raw",route:["raw"]}]),this.routeToFullContent=d(()=>["../","system-log",{outlets:{primary:["detail",this.id()],peek:null}}])}onParamsChange(e,o){this.id.set(e.id)}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=s({token:t,factory:t.\u0275fac});let i=t;return i})();var P=(()=>{let t=class t{constructor(){this.dataService=n(f),this.id=r(void 0),this.rawData=m(this.dataService.getList()),this.isDirty=r(!1),this.updatedValue=r(void 0),this.data=r(void 0),this.fieldConfiguration=r({type:"object",properties:{timestamp:{type:"date-time",description:"Timestamp"},message:{type:"string",description:"Message"},level:{type:"string",description:"Level",enum:Object.values(h)},context:{type:"string",description:"Context"},customerId:{type:"string",description:"Customer ID"},employeeId:{type:"string",description:"Employee ID"},ipAddress:{type:"string",description:"IP Address"},detail:{type:"string",description:"Detail"}}}),this.controlsConfig=r(N),S(()=>{this.data.set(b(this.rawData()?.find(e=>e.id==this.id())))})}registerUpdateState(e){this.updateState=e}onStateChange(e){this.isDirty.update(o=>e.isDirty??o)}onValueChange(e){this.updatedValue.set(e)}onControlClick(e,o){switch(e){case"refresh":{this.data.set(b(this.rawData()?.find(a=>a.id==this.id())));break}}}onParamsChange(e,o){this.id.set(e.id)}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=s({token:t,factory:t.\u0275fac});let i=t;return i})();var x=(()=>{let t=class t{constructor(){this.heading=r("System Log"),this.tabs=r([{label:"Dashboard",route:["dashboard"]},{label:"Raw",route:["raw"]}])}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=s({token:t,factory:t.\u0275fac});let i=t;return i})();var U=(()=>{let t=class t{constructor(){this.screenWidth=n(T),this.dataService=n(f),this.rawData=m(this.dataService.getList()),this.customerDataService=n(R),this.customerData=m(this.customerDataService.getList()),this.employeeDataService=n(V),this.employeeData=m(this.employeeDataService.getList()),this.configuration={id:"system-log-table",useVirtualScroll:!0},this.data=d(()=>{let e=this.rawData()??[],o=this.customerData()??[],a=this.employeeData()??[];return e.toSorted(this.sortFn()).filter(this.filterFn()).map(l=>Object.assign(l,{user:l.customerId?o.find(y=>y.id==l.customerId):l.employeeId?a.find(y=>y.id==l.employeeId):null}))}),this.columnsConfig=r([{key:"timestamp",label:"Timestamp",fieldConfiguration:{type:"date-time",format:"yyyy-MM-dd HH:mm:ss.SSS"},isSortedDesc:!0},{key:"level",label:"Level"},{key:"message",label:"Message"},{key:"user",path:"user.name",label:"User"}]),this.columnsToDisplay=r({default:["timestamp","level","message"],1280:["timestamp","level","message","user"]}),this.controlsConfig=r(F),this.filterConfig=r({type:"object",properties:{id:{type:"string",description:"ID"},level:{type:"string",description:"Level",enum:Object.values(h)},message:{type:"string",description:"Message"},after:{type:"date-time",description:"After"}}}),this.filterValue=r({}),this.sortFn=d(()=>k(this.columnsConfig())),this.filterFn=d(()=>A(this.filterValue(),{id:(e,o,a)=>!!a&&e.id==a,message:(e,o,a)=>!!a&&e.message.includes(a),level:(e,o,a)=>!!a&&e.level==a,after:(e,o,a)=>!!a&&e.timestamp>a}))}routeToDetail(e){return this.screenWidth.above().sm()?["../../","system-log",{outlets:{peek:[e.id]}}]:["../","detail",e.id]}onHeaderCellClick(e,o){this.columnsConfig.update(a=>j(a,e))}onFilterChange(e){this.filterValue.set(e)}onControlClick(e,o){switch(e){case"add":break;case"refresh":break}}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=s({token:t,factory:t.\u0275fac});let i=t;return i})();var B=[{path:"raw",component:I,canDeactivate:[L],providers:[{provide:E,useClass:P}]},{path:"**",redirectTo:"raw"}],ye=[{path:"",data:p({},c({title:"System Log"})),children:[{path:"detail/:id",component:g,data:p({},c({titleFn:i=>i.params.pipe(v(t=>t.id))})),providers:[{provide:u,useClass:D}],children:B},{path:"",component:g,providers:[{provide:u,useClass:x},{provide:M,useClass:D}],children:[{path:":id",outlet:"peek",component:g,data:p({},c({titleFn:i=>i.params.pipe(v(t=>t.id))})),providers:[{provide:u,useClass:D}],children:B},{path:"dashboard",loadComponent:()=>import("./chunk-7BPDN5UQ.js").then(i=>i.SystemLogDashboardComponent)},{path:"raw",component:O,providers:[{provide:w,useClass:U}]},{path:"**",redirectTo:"dashboard"}]}]}];export{ye as ROUTES};
