import{c as b,d as S}from"./chunk-4MPBWOIJ.js";import{a as r}from"./chunk-F44LKQXD.js";import{B as c,C as R,N as s,Na as u,V as j,W as N,X as k,Xa as D,a as l,b as f,e as A,fa as L,i as I,ka as F,ma as m,na as y,pb as O,qb as V,r as T,rb as x,s as C,tb as B,u as w,wb as M,xb as W,y as p,yb as v,zb as E}from"./chunk-YY5SQUU6.js";var d=(()=>{let t=class t{constructor(){this.appRef=c(F),this.list=new A([]),this.employeeData=c(S),this.isInitialized=!1}createMock(e,i){return{id:r.string.nanoid(),userNumber:String(i).padStart(4,"0"),employeeId:e.id,isEnabled:e.status!=b.INACTIVE&&e.status!=b.TERMINATED&&e.status!=b.RETIRED,permissions:{customer:{canCreate:r.datatype.boolean(),canRead:r.datatype.boolean(),canWrite:r.datatype.boolean(),canDelete:r.datatype.boolean()},employee:{canCreate:r.datatype.boolean(),canRead:r.datatype.boolean(),canWrite:r.datatype.boolean(),canDelete:r.datatype.boolean()},inventoryItem:{canCreate:r.datatype.boolean(),canRead:r.datatype.boolean(),canWrite:r.datatype.boolean(),canDelete:r.datatype.boolean()}},conditions:{location:{isEnabled:r.datatype.boolean(),allowedIps:r.helpers.maybe(()=>Array(r.helpers.rangeToNumber(5)).fill(0).map(()=>r.internet.ip()))??null,countries:r.helpers.maybe(()=>Array(r.helpers.rangeToNumber(2)).fill(0).map(()=>r.location.country()),{probability:.2})??null},timeRange:{isEnabled:r.datatype.boolean(),allowedAfter:r.helpers.maybe(()=>r.helpers.rangeToNumber(23).toString().padStart(2,"0")+"00")??null,allowedBefore:r.helpers.maybe(()=>r.helpers.rangeToNumber(23).toString().padStart(2,"0")+"00")??null}}}}initialize(){this.isInitialized||(this.isInitialized=!0,this.employeeData.getList().pipe(C(e=>e.length>0)).subscribe(e=>{this.list.next(e.map((i,a)=>this.createMock(i,a)))}))}getList(){return this.appRef.isStable.pipe(C(e=>e),T(1e3)).subscribe(()=>{this.initialize()}),this.list}save(e){this.list.next(this.list.value.map(i=>i.id==e.id?e:i))}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=p({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();var P=(()=>{let t=class t{constructor(){this.dataService=c(d),this.list=u(this.dataService.getList()),this.params=s({}),this.heading=m(()=>this.list()?.find(e=>e.id==this.params().id)?.userNumber??"--"),this.tabs=s([{label:"Overall",route:["overall"]},{label:"Raw",route:["raw"]}])}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=p({token:t,factory:t.\u0275fac});let o=t;return o})();var g={type:"object",properties:{canCreate:{type:"boolean",description:"Can Create"},canRead:{type:"boolean",description:"Can Read"},canWrite:{type:"boolean",description:"Can Write"},canDelete:{type:"boolean",description:"Can Delete"}}},U=(()=>{let t=class t{constructor(){this.dataService=c(d),this.list=u(this.dataService.getList()),this.params=s({}),this.data=s(void 0),this.jsonSchema=s({type:"object",properties:{userNumber:{description:"User number",type:"string"},employeeId:{description:"Employee ID",type:"string"},isEnabled:{description:"Enabled",type:"boolean"},permissions:{description:"Permissions",type:"object",properties:{customer:l({description:"Customer"},g),employee:l({description:"Employee"},g),inventoryItem:l({description:"Inventory Item"},g)}},conditions:{description:"Conditions",type:"object",properties:{location:{description:"Location-Based",type:"object",properties:{isEnabled:{type:"boolean",description:"Enabled"},allowedIps:{type:"array",description:"Allowed IPs",items:{type:"string"}},countries:{type:"array",description:"Countries",items:{type:"string"}}}},timeRange:{description:"Time-Based",type:"object",properties:{isEnabled:{type:"boolean",description:"Enabled"},allowedAfter:{description:"Allowed After (HHmm)",type:"string"},allowedBefore:{description:"Allowed Before (HHmm)",type:"string"}}}}}}}),this.isDirty=s(!1),this.updatedValue=s(void 0),this.controlsConfig=m(()=>this.isDirty()?V:O),y(()=>{this.data.set(structuredClone(this.list()?.find(e=>e.id==this.params().id)))},{allowSignalWrites:!0})}registerUpdateState(e){this.updateState=e}onStateChange(e){this.isDirty.update(i=>e.isDirty??i)}onValueChange(e){this.updatedValue.set(e)}onControlClick(e,i){switch(e){case"refresh":case"cancel":{this.data.set(structuredClone(this.list()?.find(a=>a.id==this.params().id))),this.updateState({isDirty:!1});break}case"save":{let a=this.updatedValue();a&&(this.dataService.save(a),this.updateState({isDirty:!1}));break}}}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=p({token:t,factory:t.\u0275fac});let o=t;return o})();var z=(()=>{let t=class t{constructor(){this.heading=s("Access Control Management"),this.tabs=s([])}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=p({token:t,factory:t.\u0275fac});let o=t;return o})();var H=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=R({type:t,selectors:[["demo-access-control-overall"]],hostAttrs:[1,"contents"],standalone:!0,features:[L],decls:2,vars:0,consts:[[1,"@container"],[1,"grow","light-glass-bg","rounded-4","p-8"]],template:function(i,a){i&1&&(j(0,"div",0),k(1,"main",1),N())}});let o=t;return o})();var Y=(()=>{let t=class t{constructor(){this.dataService=c(d),this.employeeDataService=c(S),this.rawData=u(this.dataService.getList()),this.employeeList=u(this.employeeDataService.getList()),this.configuration={useVirtualScroll:!0},this.data=s([]),this.columnsConfig=s([{key:"userNumber",label:"#",isSortedAsc:!0},{key:"employeeName",label:"Employee",path:"employee.name"},{key:"isEnabled",label:"Enabled",jsonSchema:{type:"boolean"}}]),this.columnsToDisplay=s(["userNumber","employeeName","isEnabled"]),this.simpleFilterConfig=s({type:"object",properties:{isEnabled:{description:"Enabled",type:"boolean"}}}),this.simpleFilterValue=s({isEnabled:!0}),this.controlsConfig=s([{id:"refresh",icon:"refresh",label:"Refresh",mode:"low-emphasis"}]),this.sortFn=m(()=>{let e=this.columnsConfig().find(a=>a.isSortedAsc||a.isSortedDesc);if(!e)return()=>0;let i=e.isSortedDesc?-1:1;return(a,n)=>{switch(e.key){case"employeeName":return a.employee?.name>n.employee?.name?i:a.employee?.name<n.employee?.name?-1*i:0;default:return a[e.key]>n[e.key]?i:a[e.key]<n[e.key]?-1*i:0}}}),this.filterFn=m(()=>{let e=this.simpleFilterValue(),i=Object.values(e??{}).some(a=>typeof a=="string"?!!a:a!=null);return a=>!(i&&e.isEnabled!=null&&e.isEnabled!=a.isEnabled)}),y(()=>{let e=this.rawData(),i=this.employeeList();!e||!i||this.data.set(e.map(a=>f(l({},a),{employee:i.find(n=>n.id==a.employeeId)})).filter(this.filterFn()).sort(this.sortFn()))},{allowSignalWrites:!0})}routeToDetail(e){return["detail",e.id]}onHeaderCellClick(e,i){this.columnsConfig.update(a=>a.map(n=>n.key==e?f(l({},n),{isSortedAsc:!n.isSortedAsc&&!n.isSortedDesc?!0:!!n.isSortedDesc,isSortedDesc:!!n.isSortedAsc}):f(l({},n),{isSortedAsc:!1,isSortedDesc:!1})))}onUpdateSimpleFilter(e){this.simpleFilterValue.set(e)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=p({token:t,factory:t.\u0275fac});let o=t;return o})();var Ne=[{path:"",data:l({},D({title:"Access Control"})),children:[{path:"detail/:id",component:E,data:l({},D({deps:[d],titleFn:(o,t)=>o.params.pipe(w(J=>t.getList().pipe(I(e=>e.find(i=>i.id==J.id)?.userNumber??"--"))))})),providers:[{provide:v,useClass:P}],children:[{path:"overall",component:H},{path:"raw",component:B,providers:[{provide:x,useClass:U}]},{path:"**",redirectTo:"overall"}]},{path:"",component:E,providers:[{provide:v,useClass:z}],children:[{path:"",component:W,providers:[{provide:M,useClass:Y}]}]}]}];export{Ne as ROUTES};
