import{a as it,b as st}from"./chunk-7CUCSZG5.js";import"./chunk-ZG6HPPGR.js";import"./chunk-BB5YHCCR.js";import{B as y,C as k,I as Q,Ka as Z,L as p,Ma as tt,Na as et,Ob as rt,Q as f,T as V,U as T,V as w,Va as z,W as m,X as l,Y as G,_,a as q,b as P,ba as u,ca as h,ga as O,i as Y,ia as J,ja as K,jb as ot,kb as nt,la as U,ma as D,na as v,ra as C,va as X,wa as I}from"./chunk-RX6RE7T5.js";var St=Math.pow(10,8)*24*60*60*1e3,Wt=-St;var Mt=3600;var at=Mt*24,Ht=at*7,kt=at*365.2425,Tt=kt/12,Lt=Tt*3,B=Symbol.for("constructDateFrom");function d(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&B in e?e[B](t):e instanceof Date?new e.constructor(t):new Date(t)}function a(e,t){return d(t||e,e)}function F(e,t,o){let n=a(e,o?.in);return isNaN(t)?d(o?.in||e,NaN):(t&&n.setDate(n.getDate()+t),n)}function E(e,t,o){let n=a(e,o?.in);if(isNaN(t))return d(o?.in||e,NaN);if(!t)return n;let r=n.getDate(),i=d(o?.in||e,n.getTime());i.setMonth(n.getMonth()+t+1,0);let s=i.getDate();return r>=s?i:(n.setFullYear(i.getFullYear(),i.getMonth(),r),n)}function ct(e,t,o){let{years:n=0,months:r=0,weeks:i=0,days:s=0,hours:c=0,minutes:x=0,seconds:H=0}=t,S=a(e,o?.in),M=r||n?E(S,r+n*12):S,L=s||i?F(M,s+i*7):M,$=x+c*60,bt=(H+$*60)*1e3;return d(o?.in||e,+L+bt)}function lt(e,t){let o=a(e,t?.in).getDay();return o===0||o===6}var wt={};function N(){return wt}function mt(e,t){let o=N(),n=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0,r=a(e,t?.in),i=r.getDay(),s=(i<n?7:0)+i-n;return r.setDate(r.getDate()-s),r.setHours(0,0,0,0),r}function W(e,...t){let o=d.bind(null,e||t.find(n=>typeof n=="object"));return t.map(o)}function A(e,t){let o=a(e,t?.in);return o.setHours(0,0,0,0),o}function j(e,t,o){let[n,r]=W(o?.in,e,t);return+A(n)==+A(r)}function dt(e,t){let o=a(e,t?.in),n=o.getMonth();return o.setFullYear(o.getFullYear(),n+1,0),o.setHours(23,59,59,999),o}function pt(e,t){let[o,n]=W(e,t.start,t.end);return{start:o,end:n}}function ut(e,t){let{start:o,end:n}=pt(t?.in,e),r=+o>+n,i=r?+o:+n,s=r?n:o;s.setHours(0,0,0,0);let c=t?.step??1;if(!c)return[];c<0&&(c=-c,r=!r);let x=[];for(;+s<=i;)x.push(d(o,s)),s.setDate(s.getDate()+c),s.setHours(0,0,0,0);return r?x.reverse():x}function ft(e,t){let o=a(e,t?.in);return o.setDate(1),o.setHours(0,0,0,0),o}function xt(e,t){let o=N(),n=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0,r=a(e,t?.in),i=r.getDay(),s=(i<n?-7:0)+6-(i-n);return r.setDate(r.getDate()+s),r.setHours(23,59,59,999),r}function ht(e,t){return a(e,t?.in).getDate()}function g(e,t){return a(e,t?.in).getMonth()}function b(e,t){return a(e,t?.in).getFullYear()}function yt(e,t,o){return F(e,-t,o)}function Dt(e,t,o){return E(e,-t,o)}function vt(e,t,o){let{years:n=0,months:r=0,weeks:i=0,days:s=0,hours:c=0,minutes:x=0,seconds:H=0}=t,S=Dt(e,r+n*12,o),M=yt(S,s+i*7,o),L=x+c*60,R=(H+L*60)*1e3;return d(o?.in||e,+M-R)}var Ot=(e,t)=>t.id,Ct=e=>["../../","detail",e];function It(e,t){if(e&1&&(m(0,"a",1)(1,"span",2),u(2),D(3,"date"),l(),m(4,"span",3),u(5),l()()),e&2){let o=t.$implicit;f("routerLink",J(6,Ct,o.id)),p(2),h(v(3,3,o.startsFrom,"HH:mm")),p(3),h(o.label)}}var gt=(()=>{let t=class t{constructor(){this.events=Q.required()}};t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=k({type:t,selectors:[["demo-calendar-events"]],hostAttrs:[1,"contents"],inputs:{events:[1,"events"]},standalone:!0,features:[O],decls:3,vars:0,consts:[[1,"flex","flex-col","gap-0.5","overflow-hidden","w-full"],["type","button","puiBaseButton","",1,"justify-start","text-start","text-sm","ps-1","pe-2","py-0.5","gap-1",3,"routerLink"],[1,"tabular-nums","dark:text-neutral-400","font-medium"],[1,"truncate"]],template:function(r,i){r&1&&(m(0,"div",0),T(1,It,6,8,"a",1,Ot),l()),r&2&&(p(),w(i.events()))},dependencies:[nt,I,et]});let e=t;return e})();var Ft=(e,t)=>({"border-b":e,"border-r":t}),Et=(e,t,o,n)=>({"dark:text-neutral-400":e,"font-medium":t,"dark:text-primary-50 before:rounded-full before:-top-1 before:-bottom-0.5 before:-left-3 before:-right-3 before:absolute before:-z-10 before:bg-primary-700":o,"dark:text-red-400":n});function Nt(e,t){if(e&1&&(m(0,"div",8)(1,"span",12),u(2),D(3,"date"),l(),G(4,"demo-calendar-events",13),l()),e&2){let o=t.$implicit,n=t.$index;f("ngClass",K(7,Ft,n<28,n%7!=6)),p(),f("ngClass",U(10,Et,(o.isLastMonth||o.isNextMonth)&&!o.isToday,!o.isLastMonth&&!o.isNextMonth,o.isToday,o.isWeekend)),p(),h(v(3,4,o.date,o.isStartOfMonth?"MMM dd":"dd")),p(2),f("events",o.events)}}var eo=(()=>{let t=class t{constructor(){this.route=y(Z),this.router=y(tt),this.timestamp=z(this.route.params.pipe(Y(n=>n.timestamp),Y(n=>Number(n)))),this.dataService=y(it),this.rawData=z(this.dataService.getList()),this.listService=y(st),this.selectedTime=C(()=>{let n=this.timestamp();return n!=null&&n!=-1?new Date(n):n==-1?new Date(this.listService.storedSelectedTime):new Date}),this.daysVisible=C(()=>{let n=this.selectedTime();if(n==null)return[];let r=new Date,i=mt(ft(n),{weekStartsOn:0}),s=xt(dt(n),{weekStartsOn:0});return ut({start:i,end:s}).map(c=>({date:c,isLastMonth:g(c)<g(n)?!0:b(c)<b(c),isNextMonth:g(c)>g(n)?!0:b(c)>b(c),isStartOfMonth:ht(c)==1,isToday:j(c,r),isWeekend:lt(c)}))}),this.daysWithData=C(()=>{let n=this.daysVisible(),r=this.rawData()??[];return n.map(i=>P(q({},i),{events:r.filter(s=>j(s.startsFrom,i.date)).sort((s,c)=>s.startsFrom.getTime()-c.startsFrom.getTime())}))})}onNextMonthClick(){let n=this.selectedTime(),r=ct(n,{months:1});this.listService.updateSelectedTime(r),this.router.navigate(["../",r.getTime()],{relativeTo:this.route})}onLastMonthClick(){let n=this.selectedTime(),r=vt(n,{months:1});this.listService.updateSelectedTime(r),this.router.navigate(["../",r.getTime()],{relativeTo:this.route})}onTodayClick(){let n=new Date;this.listService.updateSelectedTime(n),this.router.navigate(["../",n.getTime()],{relativeTo:this.route})}};t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=k({type:t,selectors:[["demo-employee-calendar-monthly"]],hostAttrs:[1,"contents"],standalone:!0,features:[O],decls:26,vars:7,consts:[[1,"@container","grow","flex","flex-col"],[1,"pui-card","rounded-4","h-full","grow","overflow-hidden","flex","flex-col"],[1,"rounded-t-4","px-8","pt-6","pb-12","bg-gradient-to-br","from-primary-800/20","to-primary-900/20"],[1,"text-xl","font-display"],[1,"grow","-mt-6","bg-neutral-800","rounded-t-4","border-t","grid","grid-cols-7","grid-rows-[min-content_repeat(5,1fr)]"],[1,"text-center","pt-2","pb-1","uppercase","font-bold","text-base/none","dark:text-red-400","border-r"],[1,"text-center","pt-2","pb-1","uppercase","font-bold","text-base/none","border-r"],[1,"text-center","pt-2","pb-1","uppercase","font-bold","text-base/none","dark:text-red-400"],["puiHoverable","",1,"flex","flex-col","items-center","justify-start","gap-1.5",3,"ngClass"],["id","lastMonth","label","Last month","mode","low-emphasis","icon","arrow_back",3,"click","weight"],["id","today","label","Today","mode","auto","icon","today",3,"click","weight"],["id","nextMonth","label","Next month","mode","low-emphasis","icon","arrow_forward",3,"click","weight"],[1,"mt-2","text-base/none","relative","z-0",3,"ngClass"],[3,"events"]],template:function(r,i){r&1&&(m(0,"div",0)(1,"main",1)(2,"div",2)(3,"span",3),u(4),D(5,"date"),l()(),m(6,"div",4)(7,"div",5),u(8,"Sun"),l(),m(9,"div",6),u(10,"Mon"),l(),m(11,"div",6),u(12,"Tue"),l(),m(13,"div",6),u(14,"Wed"),l(),m(15,"div",6),u(16,"Thu"),l(),m(17,"div",6),u(18,"Fri"),l(),m(19,"div",7),u(20,"Sat"),l(),T(21,Nt,5,15,"div",8,V),l()()(),m(23,"pui-layout-control",9),_("click",function(){return i.onLastMonthClick()}),l(),m(24,"pui-layout-control",10),_("click",function(){return i.onTodayClick()}),l(),m(25,"pui-layout-control",11),_("click",function(){return i.onNextMonthClick()}),l()),r&2&&(p(4),h(v(5,4,i.selectedTime(),"MMMM yyyy")),p(17),w(i.daysWithData()),p(2),f("weight",-100),p(),f("weight",0),p(),f("weight",100))},dependencies:[rt,ot,I,X,gt]});let e=t;return e})();export{eo as EmployeeCalendarMonthlyComponent};
