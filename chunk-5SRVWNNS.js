import{a as v}from"./chunk-RNFQA7ES.js";import{Ac as g,B as p,Bc as l,H as w,L as u,Sb as j,e as o,f as h,fc as k,h as d,ka as c,zb as S}from"./chunk-U3GDXVPC.js";import{b as y}from"./chunk-EYYPJTXZ.js";import{a as m}from"./chunk-CWTPBX7D.js";var x=(()=>{let a=class a{constructor(){this.data=u(v),this.router=u(S),this.mainListFilter$$=c({}),this.mainListSort$$=c({rarity:"desc"}),this.create=r=>{let e=new Date;return o(this.data.armorSets.add(m({id:j(),createdAt:e,updatedAt:e},r)))},this.update=(r,e)=>o(this.data.armorSets.update(r,m(m(m({updatedAt:new Date},typeof e.name<"u"?{name:e.name}:{}),typeof e.rank<"u"?{rank:e.rank}:{}),typeof e.rarity<"u"?{rarity:e.rarity}:{})))}list(r,e){return o(y(()=>{if(this.data.isServer)return[];let t;if(r?.name!=null){let n=r.name.toLowerCase();t=this.data.armorSets.filter(s=>!!(s.name?.en?.toLowerCase()?.includes(n)||s.name?.jp?.toLowerCase()?.includes(n)))}else r?.rarityEqual!=null?t=this.data.armorSets.where("rarity").equals(r.rarityEqual):r?.rarityFrom!=null&&r?.rarityTo!=null?t=this.data.armorSets.where("rarity").between(r.rarityFrom,r.rarityTo,!0,!0):r?.rarityFrom!=null?t=this.data.armorSets.where("rarity").aboveOrEqual(r.rarityFrom):r?.rarityTo!=null?t=this.data.armorSets.where("rarity").belowOrEqual(r.rarityTo):t=this.data.armorSets.toCollection();if(e&&Object.values(e).filter(n=>n=="asc"||n=="desc").length>0){let n=Object.entries(e).filter(([s,f])=>f=="asc"||f=="desc")[0][0];return e[n]==="desc"?t.reverse().sortBy(n):t.sortBy(n)}else return t.toArray()}))}count(){return this.data.isServer?h(0):o(this.data.armorSets.count())}getOne(r){return o(y(()=>{if(!this.data.isServer)return this.data.armorSets.get(r)}))}getSuggestions(r){return r.pipe(p(e=>this.list().pipe(d(t=>new k(t,{includeScore:!0,includeMatches:!0,keys:["name.jp","name.en"]}).search(e)))),d(e=>e.map(({item:t,score:n,matches:s})=>({title:b(t,s),category:"Armor Set",score:n,onClick:()=>this.router.navigate(["mhw","armor-set",t.id])}))))}};a.\u0275fac=function(e){return new(e||a)},a.\u0275prov=w({token:a,factory:a.\u0275fac,providedIn:"root"});let i=a;return i})();function b(i,a=[]){let F=a.some(e=>e.key==="name.jp")&&i.name?.jp?l(i.name.jp,a.find(e=>e.key==="name.jp")?.indices):void 0,r=a.some(e=>e.key==="name.en")&&i.name?.en?l(i.name.en,a.find(e=>e.key==="name.en")?.indices):void 0;return[F,r].filter(g).join(" / ")}export{x as a};
