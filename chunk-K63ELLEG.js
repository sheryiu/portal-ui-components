import{c as S,e as A}from"./chunk-33BX6FVD.js";import{c as he,d as be,e as _e,g as xe,j as Ee,k as Se,m as Ae,n as Ie,o as Te,p as j,q as P}from"./chunk-AYVR6FRK.js";import{a as p}from"./chunk-5KUQE4MU.js";import{Ca as Ce,I as v,J as te,K as ie,L as ne,P as oe,R as re,S as ae,T as le,U as se,V as x,W as ce,X as pe,b as X,ea as F,na as de,oa as me,pa as ue,sa as fe,ta as ye,u as Z,ua as L,va as ge,x as ee,ya as ve}from"./chunk-OTGN347X.js";import{$ as C,Ab as n,Bb as o,Ca as u,Cb as h,Hb as f,Ib as J,K as $,N as D,Qa as s,Tb as l,Ub as E,W as M,ac as K,cc as Q,db as H,dc as O,fa as m,g as G,kb as z,q as T,rb as q,rc as g,tb as d,tc as W,uc as k,wb as Y,xb as N,yb as w,zb as R}from"./chunk-I76RA5B3.js";import{a as _,b as V}from"./chunk-EQDQRRRY.js";var b=(()=>{class t{constructor(){this.appRef=m(q),this.list=new G([]),this.employeeData=m(A),this.isInitialized=!1}createMock(e,i){return{id:p.string.nanoid(),userNumber:String(i).padStart(4,"0"),employeeId:e.id,isEnabled:e.status!=S.INACTIVE&&e.status!=S.TERMINATED&&e.status!=S.RETIRED,permissions:{customer:{canCreate:p.datatype.boolean(),canRead:p.datatype.boolean(),canUpdate:p.datatype.boolean(),canDelete:p.datatype.boolean()},employee:{canCreate:p.datatype.boolean(),canRead:p.datatype.boolean(),canUpdate:p.datatype.boolean(),canDelete:p.datatype.boolean()},inventoryItem:{canCreate:p.datatype.boolean(),canRead:p.datatype.boolean(),canUpdate:p.datatype.boolean(),canDelete:p.datatype.boolean()}},conditions:{location:{isEnabled:p.datatype.boolean(),allowedIps:Array(p.helpers.rangeToNumber(5)).fill(0).map(()=>p.internet.ip()),countries:Array(p.helpers.rangeToNumber(2)).fill(0).map(()=>p.location.country())},timeRange:{isEnabled:p.datatype.boolean(),allowedAfter:p.helpers.maybe(()=>p.helpers.rangeToNumber(23).toString().padStart(2,"0")+"00")??null,allowedBefore:p.helpers.maybe(()=>p.helpers.rangeToNumber(23).toString().padStart(2,"0")+"00")??null}}}}initialize(){this.isInitialized||(this.isInitialized=!0,this.employeeData.getList().pipe(D(e=>e.length>0)).subscribe(e=>{this.list.next(e.map((i,r)=>this.createMock(i,r)))}))}getList(){return this.appRef.isStable.pipe(D(e=>e),$(1e3)).subscribe(()=>{this.initialize()}),this.list}save(e){this.list.next(this.list.value.map(i=>i.id==e.id?e:i))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var ke=(()=>{class t{constructor(){this.dataService=m(b),this.list=v(this.dataService.getList()),this.id=u(void 0),this.heading=g(()=>this.list()?.find(e=>e.id==this.id())?.userNumber??"--"),this.tabs=u([{label:"Overall",route:["overall"]},{label:"Raw",route:["raw"]}])}onParamsChange(e,i){this.id.set(e.id)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac})}}return t})();var U={type:"object",properties:{canCreate:{type:"boolean",description:"Can Create"},canRead:{type:"boolean",description:"Can Read"},canUpdate:{type:"boolean",description:"Can Update"},canDelete:{type:"boolean",description:"Can Delete"}}},De=(()=>{class t{constructor(){this.dataService=m(b),this.list=v(this.dataService.getList()),this.id=u(void 0),this.data=u(void 0),this.fieldConfiguration=u({type:"object",properties:{userNumber:{description:"User number",type:"string"},employeeId:{description:"Employee ID",type:"string"},isEnabled:{description:"Enabled",type:"boolean"},permissions:{description:"Permissions",type:"object",properties:{customer:_({description:"Customer"},U),employee:_({description:"Employee"},U),inventoryItem:_({description:"Inventory Item"},U)}},conditions:{description:"Conditions",type:"object",properties:{location:{description:"Location-Based",type:"object",properties:{isEnabled:{type:"boolean",description:"Enabled"},allowedIps:{type:"array",description:"Allowed IPs",items:{type:"string"}},countries:{type:"array",description:"Countries",items:{type:"string"}}}},timeRange:{description:"Time-Based",type:"object",properties:{isEnabled:{type:"boolean",description:"Enabled"},allowedAfter:{description:"Allowed After (HHmm)",type:"string"},allowedBefore:{description:"Allowed Before (HHmm)",type:"string"}}}}}}}),this.isDirty=u(!1),this.updatedValue=u(void 0),this.controlsConfig=g(()=>this.isDirty()?be:he),k(()=>{this.data.set(structuredClone(this.list()?.find(e=>e.id==this.id())))})}registerUpdateState(e){this.updateState=e}onStateChange(e){this.isDirty.update(i=>e.isDirty??i)}onValueChange(e){this.updatedValue.set(e)}onControlClick(e,i){switch(e){case"refresh":case"cancel":{this.data.set(structuredClone(this.list()?.find(r=>r.id==this.id()))),this.updateState({isDirty:!1});break}case"save":{let r=this.updatedValue();r&&(this.dataService.save(r),this.updateState({isDirty:!1}));break}}}onParamsChange(e,i){this.id.set(e.id)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac})}}return t})();var Ne=(()=>{class t{constructor(){this.heading=u("Access Control Management"),this.tabs=u([])}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac})}}return t})();var Fe=t=>["/user","employee","detail",t],Le=(t,y,e)=>({"dark:text-red-400":t,"dark:text-orange-400":y,"dark:text-green-400":e}),we=(t,y,e,i)=>({"rounded-t-2":t,"rounded-t-none":y,"rounded-b-2":e,"rounded-b-none":i});function je(t,y){if(t&1&&(h(0,"div",46),n(1,"a",47)(2,"div",48)(3,"h2",49),l(4),o(),n(5,"p",50)(6,"span",51),l(7),o(),n(8,"span"),l(9," / "),o(),n(10,"span"),l(11),o()(),n(12,"p",52)(13,"i",53),l(14,"label_important"),o(),n(15,"span"),l(16),o()()()()),t&2){let e=y,i=J();s(),d("hoverableEnabled",e!=null)("routerLink",e!=null?K(7,Fe,e.id):null),s(3),E(e.name),s(3),E(e.department),s(4),E(e.position),s(2),d("ngClass",Q(9,Le,e.status==i.employeeStatus.TERMINATED||e.status==i.employeeStatus.INACTIVE||e.status==i.employeeStatus.RETIRED,e.status==i.employeeStatus.ON_LEAVE||e.status==i.employeeStatus.PROBATION,e.status==i.employeeStatus.ACTIVE||e.status==i.employeeStatus.CONTRACT)),s(3),E(e.status)}}function Pe(t,y){if(t&1&&(n(0,"pui-input-field",40),h(1,"input",54),n(2,"button",55)(3,"i",56),l(4,"close"),o()()()),t&2){let e=y.$index,i=y.$index,r=y.$count;d("ngClass",O(2,we,i===0,i!==0,i===r-1,i!==r-1)),s(),d("formControlName",e)}}function Ue(t,y){t&1&&(n(0,"p",41),l(1,"All IP are allowed"),o())}function Be(t,y){if(t&1&&(n(0,"pui-input-field",40),h(1,"input",54),n(2,"button",55)(3,"i",56),l(4,"close"),o()()()),t&2){let e=y.$index,i=y.$index,r=y.$count;d("ngClass",O(2,we,i===0,i!==0,i===r-1,i!==r-1)),s(),d("formControlName",e)}}function Ve(t,y){t&1&&(n(0,"p",41),l(1,"All countries are allowed"),o())}var Re=(()=>{class t{constructor(){this.dataService=m(b),this.employeeDataService=m(A),this.route=m(Z),this.list=v(this.dataService.getList()),this.employeeList=v(this.employeeDataService.getList()),this.id=v(this.route.params.pipe(T(e=>e.id))),this.accessControl=g(()=>this.list()?.find(e=>e.id==this.id())),this.employee=g(()=>this.employeeList()?.find(e=>e.id==this.accessControl()?.employeeId)),this.employeeStatus=S,this.formGroup=m(x).nonNullable.group({isEnabled:[!1],customer:m(x).nonNullable.group({canCreate:[!1],canRead:[!1],canUpdate:[!1],canDelete:[!1]}),employee:m(x).nonNullable.group({canCreate:[!1],canRead:[!1],canUpdate:[!1],canDelete:[!1]}),inventoryItem:m(x).nonNullable.group({canCreate:[!1],canRead:[!1],canUpdate:[!1],canDelete:[!1]}),location:m(x).nonNullable.group({isEnabled:[!1],allowedIps:m(x).nonNullable.array([]),countries:m(x).nonNullable.array([])})}),k(()=>{let e=this.accessControl();e&&W(()=>{F(this.formGroup.controls.location.controls.allowedIps,e.conditions.location.allowedIps.length),F(this.formGroup.controls.location.controls.countries,e.conditions.location.countries.length),this.formGroup.setValue({isEnabled:e.isEnabled,customer:{canCreate:e.permissions.customer.canCreate,canRead:e.permissions.customer.canRead,canUpdate:e.permissions.customer.canUpdate,canDelete:e.permissions.customer.canDelete},employee:{canCreate:e.permissions.employee.canCreate,canRead:e.permissions.employee.canRead,canUpdate:e.permissions.employee.canUpdate,canDelete:e.permissions.employee.canDelete},inventoryItem:{canCreate:e.permissions.inventoryItem.canCreate,canRead:e.permissions.inventoryItem.canRead,canUpdate:e.permissions.inventoryItem.canUpdate,canDelete:e.permissions.inventoryItem.canDelete},location:{isEnabled:e.conditions.location.isEnabled,allowedIps:e.conditions.location.allowedIps,countries:e.conditions.location.countries}})})})}onToggleAll(e){let i=this.formGroup.getRawValue()[e];Object.values(i).every(c=>c==!0)?this.formGroup.get(e)?.setValue({canCreate:!1,canRead:!1,canUpdate:!1,canDelete:!1}):this.formGroup.get(e)?.setValue({canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=H({type:t,selectors:[["demo-access-control-overall"]],hostAttrs:[1,"contents"],decls:108,vars:20,consts:[[1,"@container","grow"],[1,"pui-card","rounded-4","p-8"],[1,"flex","flex-col","@screen-lg:flex-row","gap-8"],[1,"flex","flex-col","gap-4","@screen-lg:basis-1/4","@screen-lg:sticky","top-8","h-fit"],[1,"flex","flex-row","items-center","gap-2"],[1,"icon-6","font-variation-weight-light","text-neutral-800","dark:text-neutral-200"],[1,"flex","flex-col","gap-1"],[1,"text-sm","text-neutral-800","dark:text-neutral-200"],[1,"text-base"],[1,"flex","flex-col","gap-8","@screen-lg:basis-3/4",3,"formGroup"],[1,"flex","flex-row","items-center","gap-4"],["formControlName","isEnabled",3,"id"],["for","isEnabled",1,"flex","flex-col","gap-1","grow"],[1,"text-base","font-medium"],[1,"text-neutral-700","dark:text-neutral-300","text-sm","font-light"],[1,"flex","flex-col","gap-2"],[1,"flex","flex-row","justify-end","items-center","px-6","gap-4"],["puiTooltip","Create",1,"px-5","py-2"],[1,"icon-6","font-variation-weight-light"],["puiTooltip","Read",1,"px-5","py-2"],["puiTooltip","Update",1,"px-5","py-2"],["puiTooltip","Delete",1,"px-5","py-2"],["puiHoverable","","tabindex","0",1,"relative","rounded-4","before:absolute","before:inset-0","before:pui-card--subtle","before:rounded-4","before:transparency-mask-to-r","before:-z-10","justify-start",3,"click"],["formGroupName","customer",1,"flex","flex-row","items-center","px-6","py-4","gap-4","grow"],[1,"spacer"],["formControlName","canCreate",3,"click","id"],["formControlName","canRead",3,"click","id"],["formControlName","canUpdate",3,"click","id"],["formControlName","canDelete",3,"click","id"],["formGroupName","employee",1,"flex","flex-row","items-center","px-6","py-4","gap-4","grow"],["formGroupName","inventoryItem",1,"flex","flex-row","items-center","px-6","py-4","gap-4","grow"],[1,"relative","rounded-4","before:absolute","before:inset-0","before:pui-card--subtle","before:rounded-4","before:transparency-mask-to-r","before:-z-10","justify-start"],["formGroupName","location",1,"flex","flex-col","px-6","py-4","gap-4","grow"],["formControlName","isEnabled",3,"click","id"],["for","locationIsEnabled",1,"flex","flex-col","gap-1","grow",3,"click"],[1,"grid","grid-cols-1","@screen-md:grid-cols-2","gap-4"],[1,"pui-card--subtle","rounded-4","p-4"],["formArrayName","allowedIps",1,"flex","flex-col","gap-4"],[1,"px-4"],[1,"flex","flex-col"],[1,"py-1","text-base",3,"ngClass"],[1,"text-sm","text-neutral-700","dark:text-neutral-300","px-4"],[1,"self-end","px-1"],["puiBorderedButton","","color","primary",1,"rounded-full","p-2"],[1,"icon-5"],["formArrayName","countries",1,"flex","flex-col","gap-4"],[1,"flex-none","basis-2"],["puiHoverable","",1,"pui-card--subtle","rounded-4","p-8","overflow-hidden",3,"hoverableEnabled","routerLink"],[1,"flex","flex-col","items-center","gap-2"],[1,"w-full","text-center","break-anywhere","whitespace-normal"],[1,"text-sm","text-center"],[1,"text-neutral-700","dark:text-neutral-300"],[1,"text-base","text-center","flex","items-center","gap-1"],[1,"icon-4","font-variation-fill",3,"ngClass"],[3,"formControlName"],["puiBaseButton","",1,"rounded-full","p-2","me-2"],[1,"icon-4"]],template:function(i,r){if(i&1&&(n(0,"div",0)(1,"main",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"i",5),l(6,"key"),o(),n(7,"div",6)(8,"span",7),l(9,"User #"),o(),n(10,"span",8),l(11),o()()(),h(12,"pui-divider"),n(13,"div",4)(14,"i",5),l(15,"badge"),o(),n(16,"div",6)(17,"span",7),l(18,"Employee ID"),o(),n(19,"span",8),l(20),o()()(),z(21,je,17,13),o(),n(22,"form",9)(23,"div",10),h(24,"pui-toggle",11),n(25,"label",12)(26,"p",13),l(27,"Enable"),o(),n(28,"p",14),l(29,"Enable this account to login and access system resources"),o()()(),n(30,"div",15)(31,"div",16)(32,"div",17)(33,"i",18),l(34,"add"),o()(),n(35,"div",19)(36,"i",18),l(37,"visibility"),o()(),n(38,"div",20)(39,"i",18),l(40,"edit"),o()(),n(41,"div",21)(42,"i",18),l(43,"delete"),o()()(),n(44,"div",22),f("click",function(){return r.onToggleAll("customer")}),n(45,"div",23)(46,"h3"),l(47,"Customer"),o(),h(48,"div",24),n(49,"pui-toggle",25),f("click",function(a){return a.stopPropagation()}),o(),n(50,"pui-toggle",26),f("click",function(a){return a.stopPropagation()}),o(),n(51,"pui-toggle",27),f("click",function(a){return a.stopPropagation()}),o(),n(52,"pui-toggle",28),f("click",function(a){return a.stopPropagation()}),o()()(),n(53,"div",22),f("click",function(){return r.onToggleAll("employee")}),n(54,"div",29)(55,"h3"),l(56,"Employee"),o(),h(57,"div",24),n(58,"pui-toggle",25),f("click",function(a){return a.stopPropagation()}),o(),n(59,"pui-toggle",26),f("click",function(a){return a.stopPropagation()}),o(),n(60,"pui-toggle",27),f("click",function(a){return a.stopPropagation()}),o(),n(61,"pui-toggle",28),f("click",function(a){return a.stopPropagation()}),o()()(),n(62,"div",22),f("click",function(){return r.onToggleAll("inventoryItem")}),n(63,"div",30)(64,"h3"),l(65,"Inventory Item"),o(),h(66,"div",24),n(67,"pui-toggle",25),f("click",function(a){return a.stopPropagation()}),o(),n(68,"pui-toggle",26),f("click",function(a){return a.stopPropagation()}),o(),n(69,"pui-toggle",27),f("click",function(a){return a.stopPropagation()}),o(),n(70,"pui-toggle",28),f("click",function(a){return a.stopPropagation()}),o()()()(),h(71,"pui-divider"),n(72,"h2"),l(73,"Conditions"),o(),n(74,"div",31)(75,"div",32)(76,"div",10)(77,"pui-toggle",33),f("click",function(a){return a.stopPropagation()}),o(),n(78,"label",34),f("click",function(a){return a.stopPropagation()}),n(79,"h3"),l(80,"Location based permission conditions"),o(),n(81,"p",14),l(82,"Blocks access according to location related metadata"),o()()(),n(83,"div",35)(84,"div",36)(85,"div",37)(86,"h3",38),l(87,"Allowed IP Address"),o(),n(88,"div",39),w(89,Pe,5,7,"pui-input-field",40,N,!1,Ue,2,0,"p",41),o(),n(92,"div",42)(93,"button",43)(94,"i",44),l(95,"add"),o()()()()(),n(96,"div",36)(97,"div",45)(98,"h3",38),l(99,"Country"),o(),n(100,"div",39),w(101,Be,5,7,"pui-input-field",40,N,!1,Ve,2,0,"p",41),o(),n(104,"div",42)(105,"button",43)(106,"i",44),l(107,"add"),o()()()()()()()()()()()()),i&2){let c,a,B;s(11),E((c=(c=r.accessControl())==null?null:c.userNumber)!==null&&c!==void 0?c:"----"),s(9),E((a=(a=r.accessControl())==null?null:a.employeeId)!==null&&a!==void 0?a:"----"),s(),Y((B=r.employee())?21:-1,B),s(),d("formGroup",r.formGroup),s(2),d("id","isEnabled"),s(25),d("id","customerCanCreate"),s(),d("id","customerCanRead"),s(),d("id","customerCanUpdate"),s(),d("id","customerCanDelete"),s(6),d("id","employeeCanCreate"),s(),d("id","employeeCanRead"),s(),d("id","employeeCanUpdate"),s(),d("id","employeeCanDelete"),s(6),d("id","inventoryItemCanCreate"),s(),d("id","inventoryItemCanRead"),s(),d("id","inventoryItemCanUpdate"),s(),d("id","inventoryItemCanDelete"),s(7),d("id","locationIsEnabled"),s(12),R(r.formGroup.controls.location.controls.allowedIps.controls),s(12),R(r.formGroup.controls.location.controls.countries.controls)}},dependencies:[ve,X,de,ee,Ce,ce,oe,te,ie,ne,pe,re,se,ae,le,ye,fe,me,ue,ge],encapsulation:2})}}return t})();var Oe=(()=>{class t{constructor(){this.dataService=m(b),this.employeeDataService=m(A),this.rawData=v(this.dataService.getList()),this.employeeList=v(this.employeeDataService.getList()),this.configuration={useVirtualScroll:!0},this.data=g(()=>{let e=this.rawData(),i=this.employeeList();return!e||!i?[]:e.map(r=>V(_({},r),{employee:i.find(c=>c.id==r.employeeId)})).filter(this.filterFn()).toSorted(this.sortFn())}),this.columnsConfig=u([{key:"userNumber",label:"#",isSortedAsc:!0},{key:"employeeName",label:"Employee",path:"employee.name"},{key:"isEnabled",label:"Enabled",fieldConfiguration:{type:"boolean"}}]),this.columnsToDisplay=u(["userNumber","employeeName","isEnabled"]),this.filterConfig=u({type:"object",properties:{isEnabled:{description:"Enabled",type:"boolean"}}}),this.filterValue=u({isEnabled:!0}),this.controlsConfig=u([{id:"refresh",icon:"refresh",label:"Refresh",mode:"low-emphasis"}]),this.sortFn=g(()=>Se(this.columnsConfig())),this.filterFn=g(()=>Ee(this.filterValue(),{isEnabled:(e,i,r)=>r!=null&&e.isEnabled===r}))}routeToDetail(e){return["detail",e.id]}onHeaderCellClick(e,i){this.columnsConfig.update(r=>Te(r,e))}onFilterChange(e){this.filterValue.set(e)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac})}}return t})();var $t=[{path:"",data:_({},L({title:"Access Control"})),children:[{path:"detail/:id",component:P,data:_({},L({deps:[b],titleFn:(t,y)=>t.params.pipe(M(e=>y.getList().pipe(T(i=>i.find(r=>r.id==e.id)?.userNumber??"--"))))})),providers:[{provide:j,useClass:ke}],children:[{path:"overall",component:Re},{path:"raw",component:xe,providers:[{provide:_e,useClass:De}]},{path:"**",redirectTo:"overall"}]},{path:"",component:P,providers:[{provide:j,useClass:Ne}],children:[{path:"",component:Ie,providers:[{provide:Ae,useClass:Oe}]}]}]}];export{$t as ROUTES};
