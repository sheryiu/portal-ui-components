import{a as f,b as y}from"./chunk-I3XQU7LD.js";import{a as R}from"./chunk-5OCTFRTL.js";import{e as V}from"./chunk-5KYHINHE.js";import{c as T,e as L,g as E,h as I,i as A,j as k,k as w,l as O,m as F,n as j,o as u,p as h}from"./chunk-QSCQ6A6D.js";import"./chunk-5KUQE4MU.js";import{A as n,Ea as l,Ga as S,Ib as b,R as s,ac as m,f as C,ob as c,x as a}from"./chunk-QPVKT74M.js";import{a as d}from"./chunk-EQDQRRRY.js";var g=(()=>{let t=class t{constructor(){this.id=s(void 0),this.heading=l(()=>this.id()??"--"),this.tabs=s([{label:"Raw",route:["raw"]}]),this.routeToFullContent=l(()=>["../","system-log",{outlets:{primary:["detail",this.id()],peek:null}}])}onParamsChange(e,r){this.id.set(e.id)}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=a({token:t,factory:t.\u0275fac});let i=t;return i})();var N=(()=>{let t=class t{constructor(){this.dataService=n(y),this.id=s(void 0),this.rawData=c(this.dataService.getList()),this.isDirty=s(!1),this.updatedValue=s(void 0),this.data=s(void 0),this.fieldConfiguration=s({type:"object",properties:{timestamp:{type:"date-time",description:"Timestamp"},message:{type:"string",description:"Message"},level:{type:"string",description:"Level",enum:Object.values(f)},context:{type:"string",description:"Context"},customerId:{type:"string",description:"Customer ID"},employeeId:{type:"string",description:"Employee ID"},ipAddress:{type:"string",description:"IP Address"},detail:{type:"string",description:"Detail"}}}),this.controlsConfig=s(T),S(()=>{this.data.set(structuredClone(this.rawData()?.find(e=>e.id==this.id())))},{allowSignalWrites:!0})}registerUpdateState(e){this.updateState=e}onStateChange(e){this.isDirty.update(r=>e.isDirty??r)}onValueChange(e){this.updatedValue.set(e)}onControlClick(e,r){switch(e){case"refresh":{this.data.set(structuredClone(this.rawData()?.find(o=>o.id==this.id())));break}}}onParamsChange(e,r){this.id.set(e.id)}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=a({token:t,factory:t.\u0275fac});let i=t;return i})();var P=(()=>{let t=class t{constructor(){this.heading=s("System Log"),this.tabs=s([{label:"Dashboard",route:["dashboard"]},{label:"Raw",route:["raw"]}])}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=a({token:t,factory:t.\u0275fac});let i=t;return i})();var x=(()=>{let t=class t{constructor(){this.screenWidth=n(b),this.dataService=n(y),this.rawData=c(this.dataService.getList()),this.customerDataService=n(R),this.customerData=c(this.customerDataService.getList()),this.employeeDataService=n(V),this.employeeData=c(this.employeeDataService.getList()),this.configuration={useVirtualScroll:!0},this.data=l(()=>{let e=this.rawData()??[],r=this.customerData()??[],o=this.employeeData()??[];return e.toSorted(this.sortFn()).filter(this.filterFn()).map(p=>Object.assign(p,{user:p.customerId?r.find(D=>D.id==p.customerId):p.employeeId?o.find(D=>D.id==p.employeeId):null}))}),this.columnsConfig=s([{key:"timestamp",label:"Timestamp",fieldConfiguration:{type:"date-time",format:"yyyy-MM-dd HH:mm:ss.SSS"},isSortedDesc:!0},{key:"level",label:"Level"},{key:"message",label:"Message"},{key:"user",path:"user.name",label:"User"}]),this.columnsToDisplay=s({default:["timestamp","level","message"],1280:["timestamp","level","message","user"]}),this.controlsConfig=s(w),this.filterConfig=s({type:"object",properties:{id:{type:"string",description:"ID"},level:{type:"string",description:"Level",enum:Object.values(f)},message:{type:"string",description:"Message"}}}),this.filterValue=s({}),this.sortFn=l(()=>k(this.columnsConfig())),this.filterFn=l(()=>A(this.filterValue(),{id:(e,r,o)=>!!o&&e.id==o,message:(e,r,o)=>!!o&&e.message.includes(o),level:(e,r,o)=>!!o&&e.level==o}))}routeToDetail(e){return this.screenWidth.above().sm()?["../../","system-log",{outlets:{peek:[e.id]}}]:["../","detail",e.id]}onHeaderCellClick(e,r){this.columnsConfig.update(o=>j(o,e))}onFilterChange(e){this.filterValue.set(e)}onControlClick(e,r){switch(e){case"add":break;case"refresh":break}}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=a({token:t,factory:t.\u0275fac});let i=t;return i})();var M=[{path:"raw",component:E,providers:[{provide:L,useClass:N}]},{path:"**",redirectTo:"raw"}],ft=[{path:"",data:d({},m({title:"System Log"})),children:[{path:"detail/:id",component:h,data:d({},m({titleFn:i=>i.params.pipe(C(t=>t.id))})),providers:[{provide:u,useClass:g}],children:M},{path:"",component:h,providers:[{provide:u,useClass:P},{provide:I,useClass:g}],children:[{path:":id",outlet:"peek",component:h,data:d({},m({titleFn:i=>i.params.pipe(C(t=>t.id))})),providers:[{provide:u,useClass:g}],children:M},{path:"dashboard",loadComponent:()=>import("./chunk-7CXKIUDZ.js").then(i=>i.SystemLogDashboardComponent)},{path:"raw",component:F,providers:[{provide:O,useClass:x}]},{path:"**",redirectTo:"dashboard"}]}]}];export{ft as ROUTES};
