import{d as p,e as E}from"./chunk-SGPLPRNQ.js";import{a as u}from"./chunk-CND4BQIR.js";import{B as l,Jb as k,Kb as N,Lb as w,N as o,Nb as j,Qb as F,Rb as R,Sb as v,Ta as c,Tb as b,a as d,b as f,e as A,i as T,oa as I,ob as D,qa as h,r as g,s as C,sa as y,u as L,y as n}from"./chunk-FL6MBFAD.js";var m=(()=>{let t=class t{constructor(){this.appRef=l(I),this.list=new A([]),this.employeeData=l(E),this.isInitialized=!1}createMock(e){let i=u.date.past({years:1}),r=u.date.between({from:i,to:new Date(i.getTime()+5*24*36e5)}),s=u.helpers.arrayElement([p.ANNUAL_LEAVE,p.BUSINESS_TRIP,p.PERSONAL_LEAVE,p.SICK_LEAVE]);return{id:u.string.nanoid(),employeeId:e.id,startsFrom:i,endsAt:r,isFullDay:[p.ANNUAL_LEAVE,p.PERSONAL_LEAVE,p.SICK_LEAVE].includes(s),type:s,label:u.lorem.lines(1)}}initialize(){this.isInitialized||(this.isInitialized=!0,this.employeeData.getList().pipe(C(e=>e.length>0)).subscribe(e=>{this.list.next(e.map(i=>this.createMock(i)))}))}getList(){return this.appRef.isStable.pipe(C(e=>e),g(1e3)).subscribe(()=>{this.initialize()}),this.list}save(e){this.list.next(this.list.value.map(i=>i.id==e.id?e:i))}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=n({token:t,factory:t.\u0275fac,providedIn:"root"});let a=t;return a})();var O=(()=>{let t=class t{constructor(){this.dataService=l(m),this.list=c(this.dataService.getList()),this.id=o(void 0),this.heading=h(()=>this.list()?.find(e=>e.id==this.id())?.label??"--"),this.tabs=o([])}onParamsChange(e,i){this.id.set(e.id)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=n({token:t,factory:t.\u0275fac});let a=t;return a})();var V=(()=>{let t=class t{constructor(){this.dataService=l(m),this.list=c(this.dataService.getList()),this.id=o(void 0),this.data=o(void 0),this.fieldConfiguration=o({type:"object",properties:{employeeId:{type:"string",description:"Employee ID"},startsFrom:{type:"date-time",description:"Starts From"},endsAt:{type:"date-time",description:"Ends At"},isFullDay:{type:"boolean",description:"Full Day"},label:{type:"string",description:"Label"},type:{type:"string",description:"Type",enum:Object.values(p)}}}),this.isDirty=o(!1),this.updatedValue=o(void 0),this.controlsConfig=h(()=>this.isDirty()?N:k),y(()=>{this.data.set(structuredClone(this.list()?.find(e=>e.id==this.id())))},{allowSignalWrites:!0})}registerUpdateState(e){this.updateState=e}onStateChange(e){this.isDirty.update(i=>e.isDirty??i)}onValueChange(e){this.updatedValue.set(e)}onControlClick(e,i){switch(e){case"refresh":case"cancel":{this.data.set(structuredClone(this.list()?.find(r=>r.id==this.id()))),this.updateState({isDirty:!1});break}case"save":{let r=this.updatedValue();r&&(this.dataService.save(r),this.updateState({isDirty:!1}));break}}}onParamsChange(e,i){this.id.set(e.id)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=n({token:t,factory:t.\u0275fac});let a=t;return a})();var P=(()=>{let t=class t{constructor(){this.heading=o("Employee Calendar"),this.tabs=o([{label:"Monthly",route:["monthly","-1"]},{label:"Weekly",route:["weekly"]},{label:"Data",route:["data"]}])}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=n({token:t,factory:t.\u0275fac});let a=t;return a})();var M=(()=>{let t=class t{constructor(){this.dataService=l(m),this.rawData=c(this.dataService.getList()),this.employeeDataService=l(E),this.employeeList=c(this.employeeDataService.getList()),this.configuration={useVirtualScroll:!0},this.data=o([]),this.columnsConfig=o([{key:"employeeName",label:"Employee",path:"employee.name"},{key:"label",label:"Label"},{key:"startsFrom",label:"Starts",fieldConfiguration:{type:"date-time",format:"yyyy-MM-dd HH:mm"}},{key:"endsAt",label:"Ends",fieldConfiguration:{type:"date-time",format:"yyyy-MM-dd HH:mm"}}]),this.columnsToDisplay=o(["employeeName","label","startsFrom","endsAt"]),this.controlsConfig=o([]),this.sortFn=h(()=>{let e=this.columnsConfig().find(r=>r.isSortedAsc||r.isSortedDesc);if(!e)return()=>0;let i=e.isSortedDesc?-1:1;return(r,s)=>{switch(e.key){case"employeeName":return r.employee?.name>s.employee?.name?i:r.employee?.name<s.employee?.name?-1*i:0;default:return r[e.key]>s[e.key]?i:r[e.key]<s[e.key]?-1*i:0}}}),y(()=>{let e=this.rawData(),i=this.employeeList();!e||!i||this.data.set(e.map(r=>f(d({},r),{employee:i.find(s=>s.id==r.employeeId)})).sort(this.sortFn()))},{allowSignalWrites:!0})}routeToDetail(e){return["../detail",e.id]}onHeaderCellClick(e,i){this.columnsConfig.update(r=>r.map(s=>s.key==e?f(d({},s),{isSortedAsc:!s.isSortedAsc&&!s.isSortedDesc?!0:!!s.isSortedDesc,isSortedDesc:!!s.isSortedAsc}):f(d({},s),{isSortedAsc:!1,isSortedDesc:!1})))}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=n({token:t,factory:t.\u0275fac});let a=t;return a})();var ve=[{path:"",data:d({},D({title:"Calendar"})),children:[{path:"detail/:id",component:b,data:d({},D({deps:[m],titleFn:(a,t)=>a.params.pipe(L(x=>t.getList().pipe(T(e=>e.find(i=>i.id==x.id)?.label??"--"))))})),providers:[{provide:v,useClass:O}],children:[{path:"raw",component:j,providers:[{provide:w,useClass:V}]},{path:"**",redirectTo:"raw"}]},{path:"",component:b,providers:[{provide:v,useClass:P}],children:[{path:"monthly/:timestamp",loadComponent:()=>import("./chunk-PKABB4SF.js").then(a=>a.EmployeeCalendarMonthlyComponent)},{path:"data",component:R,providers:[{provide:F,useClass:M}]},{path:"**",redirectTo:"monthly/-1"}]}]}];export{ve as ROUTES};
