import{c as D,e as T}from"./chunk-VJPI5O3M.js";import{c as Oe,d as Re,e as Ve,g as Fe,j as Me,k as Le,m as je,n as Be,o as Pe,p as U,q as G}from"./chunk-BDRA5EIL.js";import{a as d}from"./chunk-QLEH2ZB5.js";import{Aa as P,B as le,Ba as Se,Ea as De,Ha as Te,K as j,Ka as we,La as Ae,M as se,Ma as ke,Na as Ie,P as C,Q as ce,R as pe,S as de,T as me,U as ue,V as fe,W as ge,X as ve,Xa as Ne,Y as S,Z as ye,_ as be,a as re,ha as B,ta as Ce,ua as _e,va as he,y as ae,ya as xe,za as Ee}from"./chunk-4CV2DTBE.js";import{$ as _,Db as ee,Hb as f,Ib as te,K as Y,Ka as c,N as R,Sb as k,V as J,Vb as a,Wb as E,ab as K,cc as ie,ea as g,ec as ne,fc as L,g as q,gb as Q,ja as w,ka as A,nb as W,pb as X,pc as oe,q as N,qb as Z,qc as b,ra as v,rb as V,rc as O,tb as F,ub as M,vb as u,wb as i,xb as n,yb as y}from"./chunk-LVH4HSPS.js";import{a as x,b as z}from"./chunk-C6Q5SG76.js";var h=(()=>{let t=class t{constructor(){this.appRef=g(W),this.list=new q([]),this.employeeData=g(T),this.isInitialized=!1}createMock(e,r){return{id:d.string.nanoid(),userNumber:String(r).padStart(4,"0"),employeeId:e.id,isEnabled:e.status!=D.INACTIVE&&e.status!=D.TERMINATED&&e.status!=D.RETIRED,permissions:{customer:{canCreate:d.datatype.boolean(),canRead:d.datatype.boolean(),canUpdate:d.datatype.boolean(),canDelete:d.datatype.boolean()},employee:{canCreate:d.datatype.boolean(),canRead:d.datatype.boolean(),canUpdate:d.datatype.boolean(),canDelete:d.datatype.boolean()},inventoryItem:{canCreate:d.datatype.boolean(),canRead:d.datatype.boolean(),canUpdate:d.datatype.boolean(),canDelete:d.datatype.boolean()}},conditions:{location:{isEnabled:d.datatype.boolean(),allowedIps:Array(d.helpers.rangeToNumber(5)).fill(0).map(()=>d.internet.ip()),countries:Array(d.helpers.rangeToNumber(2)).fill(0).map(()=>d.location.country())},timeRange:{isEnabled:d.datatype.boolean(),allowedAfter:d.helpers.maybe(()=>d.helpers.rangeToNumber(23).toString().padStart(2,"0")+"00")??null,allowedBefore:d.helpers.maybe(()=>d.helpers.rangeToNumber(23).toString().padStart(2,"0")+"00")??null}}}}initialize(){this.isInitialized||(this.isInitialized=!0,this.employeeData.getList().pipe(R(e=>e.length>0)).subscribe(e=>{this.list.next(e.map((r,p)=>this.createMock(r,p)))}))}getList(){return this.appRef.isStable.pipe(R(e=>e),Y(1e3)).subscribe(()=>{this.initialize()}),this.list}save(e,r){this.list.next(this.list.value.map(p=>p.id==e?se(p,r):p))}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=_({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();var Ue=(()=>{let t=class t{constructor(){this.dataService=g(h),this.list=C(this.dataService.getList()),this.id=v(void 0),this.heading=b(()=>this.list()?.find(e=>e.id==this.id())?.userNumber??"--"),this.tabs=v([{label:"Overall",route:["overall"]},{label:"Raw",route:["raw"]}])}onParamsChange(e,r){this.id.set(e.id)}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=_({token:t,factory:t.\u0275fac});let o=t;return o})();var $={type:"object",properties:{canCreate:{type:"boolean",description:"Can Create"},canRead:{type:"boolean",description:"Can Read"},canUpdate:{type:"boolean",description:"Can Update"},canDelete:{type:"boolean",description:"Can Delete"}}},Ge=(()=>{let t=class t{constructor(){this.dataService=g(h),this.list=C(this.dataService.getList()),this.id=v(void 0),this.data=v(void 0),this.fieldConfiguration=v({type:"object",properties:{userNumber:{description:"User number",type:"string"},employeeId:{description:"Employee ID",type:"string"},isEnabled:{description:"Enabled",type:"boolean"},permissions:{description:"Permissions",type:"object",properties:{customer:x({description:"Customer"},$),employee:x({description:"Employee"},$),inventoryItem:x({description:"Inventory Item"},$)}},conditions:{description:"Conditions",type:"object",properties:{location:{description:"Location-Based",type:"object",properties:{isEnabled:{type:"boolean",description:"Enabled"},allowedIps:{type:"array",description:"Allowed IPs",items:{type:"string"}},countries:{type:"array",description:"Countries",items:{type:"string"}}}},timeRange:{description:"Time-Based",type:"object",properties:{isEnabled:{type:"boolean",description:"Enabled"},allowedAfter:{description:"Allowed After (HHmm)",type:"string"},allowedBefore:{description:"Allowed Before (HHmm)",type:"string"}}}}}}}),this.isDirty=v(!1),this.updatedValue=v(void 0),this.controlsConfig=b(()=>this.isDirty()?Re:Oe),O(()=>{this.data.set(j(this.list()?.find(e=>e.id==this.id())))})}registerUpdateState(e){this.updateState=e}onStateChange(e){this.isDirty.update(r=>e.isDirty??r)}onValueChange(e){this.updatedValue.set(e)}onControlClick(e,r){switch(e){case"refresh":case"cancel":{this.data.set(j(this.list()?.find(p=>p.id==this.id()))),this.updateState({isDirty:!1});break}case"save":{let p=this.updatedValue();p&&(this.dataService.save(this.id(),p),this.updateState({isDirty:!1}));break}}}onParamsChange(e,r){this.id.set(e.id)}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=_({token:t,factory:t.\u0275fac});let o=t;return o})();var $e=(()=>{let t=class t{constructor(){this.heading=v("Access Control Management"),this.tabs=v([])}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=_({token:t,factory:t.\u0275fac});let o=t;return o})();var Ye=o=>["/user","employee","detail",o],Je=(o,t,l)=>({"dark:text-red-400":o,"dark:text-orange-400":t,"dark:text-green-400":l}),He=(o,t,l,e)=>({"rounded-t-2":o,"rounded-t-none":t,"rounded-b-2":l,"rounded-b-none":e});function Ke(o,t){if(o&1&&(y(0,"div",50),i(1,"a",51)(2,"div",52)(3,"h2",53),a(4),n(),i(5,"p",54)(6,"span",55),a(7),n(),i(8,"span"),a(9," / "),n(),i(10,"span"),a(11),n()(),i(12,"p",56)(13,"i",57),a(14,"label_important"),n(),i(15,"span"),a(16),n()()()()),o&2){let l=t,e=te();c(),u("hoverableEnabled",l!=null)("routerLink",l!=null?ie(7,Ye,l.id):null),c(3),E(l.name),c(3),E(l.department),c(4),E(l.position),c(2),u("ngClass",ne(9,Je,l.status==e.employeeStatus.TERMINATED||l.status==e.employeeStatus.INACTIVE||l.status==e.employeeStatus.RETIRED,l.status==e.employeeStatus.ON_LEAVE||l.status==e.employeeStatus.PROBATION,l.status==e.employeeStatus.ACTIVE||l.status==e.employeeStatus.CONTRACT)),c(3),E(l.status)}}function Qe(o,t){if(o&1&&(i(0,"div"),a(1),n()),o&2){let l=t.$implicit;c(),E(l)}}function We(o,t){if(o&1){let l=ee();i(0,"pui-base-dropdown-overlay",null,0)(2,"button",58),f("click",function(){w(l);let r=k(1);return A(r.selectValue("administrator"))}),a(3,"Administrator"),n(),i(4,"button",58),f("click",function(){w(l);let r=k(1);return A(r.selectValue("manager"))}),a(5,"Manager"),n(),i(6,"button",58),f("click",function(){w(l);let r=k(1);return A(r.selectValue("employee"))}),a(7,"Employee"),n(),i(8,"button",58),f("click",function(){w(l);let r=k(1);return A(r.selectValue("temp"))}),a(9,"Temporary Member"),n()()}}function Xe(o,t){if(o&1&&(i(0,"pui-input-field",44),y(1,"input",59),i(2,"button",60)(3,"i",61),a(4,"close"),n()()()),o&2){let l=t.$index,e=t.$index,r=t.$count;u("ngClass",L(2,He,e===0,e!==0,e===r-1,e!==r-1)),c(),u("formControlName",l)}}function Ze(o,t){o&1&&(i(0,"p",45),a(1,"All IP are allowed"),n())}function et(o,t){if(o&1&&(i(0,"pui-input-field",44),y(1,"input",59),i(2,"button",60)(3,"i",61),a(4,"close"),n()()()),o&2){let l=t.$index,e=t.$index,r=t.$count;u("ngClass",L(2,He,e===0,e!==0,e===r-1,e!==r-1)),c(),u("formControlName",l)}}function tt(o,t){o&1&&(i(0,"p",45),a(1,"All countries are allowed"),n())}var ze=(()=>{let t=class t{constructor(){this.dataService=g(h),this.employeeDataService=g(T),this.route=g(ae),this.list=C(this.dataService.getList()),this.employeeList=C(this.employeeDataService.getList()),this.id=C(this.route.params.pipe(N(e=>e.id))),this.accessControl=b(()=>this.list()?.find(e=>e.id==this.id())),this.employee=b(()=>this.employeeList()?.find(e=>e.id==this.accessControl()?.employeeId)),this.employeeStatus=D,this.formGroup=g(S).nonNullable.group({isEnabled:[!1],customer:g(S).nonNullable.group({canCreate:[!1],canRead:[!1],canUpdate:[!1],canDelete:[!1]}),employee:g(S).nonNullable.group({canCreate:[!1],canRead:[!1],canUpdate:[!1],canDelete:[!1]}),inventoryItem:g(S).nonNullable.group({canCreate:[!1],canRead:[!1],canUpdate:[!1],canDelete:[!1]}),location:g(S).nonNullable.group({isEnabled:[!1],allowedIps:g(S).nonNullable.array([]),countries:g(S).nonNullable.array([])})}),O(()=>{let e=this.accessControl();e&&oe(()=>{B(this.formGroup.controls.location.controls.allowedIps,e.conditions.location.allowedIps.length),B(this.formGroup.controls.location.controls.countries,e.conditions.location.countries.length),this.formGroup.setValue({isEnabled:e.isEnabled,customer:{canCreate:e.permissions.customer.canCreate,canRead:e.permissions.customer.canRead,canUpdate:e.permissions.customer.canUpdate,canDelete:e.permissions.customer.canDelete},employee:{canCreate:e.permissions.employee.canCreate,canRead:e.permissions.employee.canRead,canUpdate:e.permissions.employee.canUpdate,canDelete:e.permissions.employee.canDelete},inventoryItem:{canCreate:e.permissions.inventoryItem.canCreate,canRead:e.permissions.inventoryItem.canRead,canUpdate:e.permissions.inventoryItem.canUpdate,canDelete:e.permissions.inventoryItem.canDelete},location:{isEnabled:e.conditions.location.isEnabled,allowedIps:e.conditions.location.allowedIps,countries:e.conditions.location.countries}})})})}onToggleAll(e){let r=this.formGroup.getRawValue()[e];Object.values(r).every(m=>m==!0)?this.formGroup.get(e)?.setValue({canCreate:!1,canRead:!1,canUpdate:!1,canDelete:!1}):this.formGroup.get(e)?.setValue({canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0})}};t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=K({type:t,selectors:[["demo-access-control-overall"]],hostAttrs:[1,"contents"],decls:116,vars:20,consts:[["dropdown",""],[1,"@container","grow"],[1,"pui-card","rounded-4","p-8"],[1,"flex","flex-col","@screen-lg:flex-row","gap-8"],[1,"flex","flex-col","gap-4","@screen-lg:basis-1/4","@screen-lg:sticky","top-8","h-fit"],[1,"flex","flex-row","items-center","gap-2"],[1,"icon-6","font-variation-weight-light","text-neutral-800","dark:text-neutral-200"],[1,"flex","flex-col","gap-1"],[1,"text-sm","text-neutral-800","dark:text-neutral-200"],[1,"text-base"],[1,"flex","flex-col","gap-8","@screen-lg:basis-3/4",3,"formGroup"],[1,"flex","flex-row","items-center","gap-4"],["formControlName","isEnabled",3,"id"],["for","isEnabled",1,"flex","flex-col","gap-1","grow"],[1,"text-base","font-medium"],[1,"text-neutral-700","dark:text-neutral-300","text-sm","font-light"],[1,"min-w-40"],[4,"puiDropdownTrigger"],[4,"puiDropdownOverlay"],[1,"flex","flex-col","gap-2"],[1,"flex","flex-row","justify-end","items-center","px-6","gap-4"],["puiTooltip","Create",1,"px-5","py-2"],[1,"icon-6","font-variation-weight-light"],["puiTooltip","Read",1,"px-5","py-2"],["puiTooltip","Update",1,"px-5","py-2"],["puiTooltip","Delete",1,"px-5","py-2"],["puiHoverable","","tabindex","0",1,"relative","rounded-4","before:absolute","before:inset-0","before:pui-card--subtle","before:rounded-4","before:-z-10","justify-start",3,"click"],["formGroupName","customer",1,"flex","flex-row","items-center","px-6","py-4","gap-4","grow"],[1,"spacer"],["formControlName","canCreate",3,"click","id"],["formControlName","canRead",3,"click","id"],["formControlName","canUpdate",3,"click","id"],["formControlName","canDelete",3,"click","id"],["formGroupName","employee",1,"flex","flex-row","items-center","px-6","py-4","gap-4","grow"],["formGroupName","inventoryItem",1,"flex","flex-row","items-center","px-6","py-4","gap-4","grow"],[1,"relative","rounded-4","before:absolute","before:inset-0","before:pui-card--subtle","before:rounded-4","before:-z-10","justify-start"],["formGroupName","location",1,"flex","flex-col","px-6","py-4","gap-4","grow"],["formControlName","isEnabled",3,"click","id"],["for","locationIsEnabled",1,"flex","flex-col","gap-1","grow",3,"click"],[1,"grid","grid-cols-1","@screen-md:grid-cols-2","gap-4"],[1,"pui-card--subtle","rounded-4","p-4"],["formArrayName","allowedIps",1,"flex","flex-col","gap-4"],[1,"px-4"],[1,"flex","flex-col"],[1,"py-1","text-base",3,"ngClass"],[1,"text-sm","text-neutral-700","dark:text-neutral-300","px-4"],[1,"self-end","px-1"],["puiBorderedButton","","color","primary",1,"rounded-full","p-2"],[1,"icon-5"],["formArrayName","countries",1,"flex","flex-col","gap-4"],[1,"flex-none","basis-2"],["puiHoverable","",1,"pui-card--subtle","rounded-4","p-8","overflow-hidden",3,"hoverableEnabled","routerLink"],[1,"flex","flex-col","items-center","gap-2"],[1,"w-full","text-center","wrap-anywhere","whitespace-normal"],[1,"text-sm","text-center"],[1,"text-neutral-700","dark:text-neutral-300"],[1,"text-base","text-center","flex","items-center","gap-1"],[1,"icon-4","font-variation-fill",3,"ngClass"],["puiBaseButton","",3,"click"],[3,"formControlName"],["puiBaseButton","",1,"rounded-full","p-2","me-2"],[1,"icon-4"]],template:function(r,p){if(r&1&&(i(0,"div",1)(1,"main",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"i",6),a(6,"key"),n(),i(7,"div",7)(8,"span",8),a(9,"User #"),n(),i(10,"span",9),a(11),n()()(),y(12,"pui-divider"),i(13,"div",5)(14,"i",6),a(15,"badge"),n(),i(16,"div",7)(17,"span",8),a(18,"Employee ID"),n(),i(19,"span",9),a(20),n()()(),X(21,Ke,17,13),n(),i(22,"form",10)(23,"div",11),y(24,"pui-toggle",12),i(25,"label",13)(26,"p",14),a(27,"Enable"),n(),i(28,"p",15),a(29,"Enable this account to login and access system resources"),n()()(),y(30,"pui-divider"),i(31,"div",11)(32,"label",13)(33,"p",14),a(34,"Access Level"),n()(),i(35,"pui-dropdown",16),Q(36,Qe,2,1,"div",17)(37,We,10,0,"pui-base-dropdown-overlay",18),n()(),i(38,"div",19)(39,"div",20)(40,"div",21)(41,"i",22),a(42,"add"),n()(),i(43,"div",23)(44,"i",22),a(45,"visibility"),n()(),i(46,"div",24)(47,"i",22),a(48,"edit"),n()(),i(49,"div",25)(50,"i",22),a(51,"delete"),n()()(),i(52,"div",26),f("click",function(){return p.onToggleAll("customer")}),i(53,"div",27)(54,"h3"),a(55,"Customer"),n(),y(56,"div",28),i(57,"pui-toggle",29),f("click",function(s){return s.stopPropagation()}),n(),i(58,"pui-toggle",30),f("click",function(s){return s.stopPropagation()}),n(),i(59,"pui-toggle",31),f("click",function(s){return s.stopPropagation()}),n(),i(60,"pui-toggle",32),f("click",function(s){return s.stopPropagation()}),n()()(),i(61,"div",26),f("click",function(){return p.onToggleAll("employee")}),i(62,"div",33)(63,"h3"),a(64,"Employee"),n(),y(65,"div",28),i(66,"pui-toggle",29),f("click",function(s){return s.stopPropagation()}),n(),i(67,"pui-toggle",30),f("click",function(s){return s.stopPropagation()}),n(),i(68,"pui-toggle",31),f("click",function(s){return s.stopPropagation()}),n(),i(69,"pui-toggle",32),f("click",function(s){return s.stopPropagation()}),n()()(),i(70,"div",26),f("click",function(){return p.onToggleAll("inventoryItem")}),i(71,"div",34)(72,"h3"),a(73,"Inventory Item"),n(),y(74,"div",28),i(75,"pui-toggle",29),f("click",function(s){return s.stopPropagation()}),n(),i(76,"pui-toggle",30),f("click",function(s){return s.stopPropagation()}),n(),i(77,"pui-toggle",31),f("click",function(s){return s.stopPropagation()}),n(),i(78,"pui-toggle",32),f("click",function(s){return s.stopPropagation()}),n()()()(),y(79,"pui-divider"),i(80,"h2"),a(81,"Conditions"),n(),i(82,"div",35)(83,"div",36)(84,"div",11)(85,"pui-toggle",37),f("click",function(s){return s.stopPropagation()}),n(),i(86,"label",38),f("click",function(s){return s.stopPropagation()}),i(87,"h3"),a(88,"Location based permission conditions"),n(),i(89,"p",15),a(90,"Blocks access according to location related metadata"),n()()(),i(91,"div",39)(92,"div",40)(93,"div",41)(94,"h3",42),a(95,"Allowed IP Address"),n(),i(96,"div",43),F(97,Xe,5,7,"pui-input-field",44,V,!1,Ze,2,0,"p",45),n(),i(100,"div",46)(101,"button",47)(102,"i",48),a(103,"add"),n()()()()(),i(104,"div",40)(105,"div",49)(106,"h3",42),a(107,"Country"),n(),i(108,"div",43),F(109,et,5,7,"pui-input-field",44,V,!1,tt,2,0,"p",45),n(),i(112,"div",46)(113,"button",47)(114,"i",48),a(115,"add"),n()()()()()()()()()()()()),r&2){let m,s,H;c(11),E(((m=p.accessControl())==null?null:m.userNumber)??"----"),c(9),E(((s=p.accessControl())==null?null:s.employeeId)??"----"),c(),Z((H=p.employee())?21:-1,H),c(),u("formGroup",p.formGroup),c(2),u("id","isEnabled"),c(33),u("id","customerCanCreate"),c(),u("id","customerCanRead"),c(),u("id","customerCanUpdate"),c(),u("id","customerCanDelete"),c(6),u("id","employeeCanCreate"),c(),u("id","employeeCanRead"),c(),u("id","employeeCanUpdate"),c(),u("id","employeeCanDelete"),c(6),u("id","inventoryItemCanCreate"),c(),u("id","inventoryItemCanRead"),c(),u("id","inventoryItemCanUpdate"),c(),u("id","inventoryItemCanDelete"),c(7),u("id","locationIsEnabled"),c(12),M(p.formGroup.controls.location.controls.allowedIps.controls),c(12),M(p.formGroup.controls.location.controls.countries.controls)}},dependencies:[De,re,Ce,le,Te,ye,me,ce,pe,de,be,ue,ve,fe,ge,Ee,xe,_e,he,Se,ke,we,Ae,Ie],encapsulation:2});let o=t;return o})();var qe=(()=>{let t=class t{constructor(){this.dataService=g(h),this.employeeDataService=g(T),this.rawData=C(this.dataService.getList()),this.employeeList=C(this.employeeDataService.getList()),this.configuration={id:"access-control-table",useVirtualScroll:!0},this.data=b(()=>{let e=this.rawData(),r=this.employeeList();return!e||!r?[]:e.map(p=>z(x({},p),{employee:r.find(m=>m.id==p.employeeId)})).filter(this.filterFn()).toSorted(this.sortFn())}),this.columnsConfig=v([{key:"userNumber",label:"#",isSortedAsc:!0},{key:"employeeName",label:"Employee",path:"employee.name"},{key:"isEnabled",label:"Enabled",fieldConfiguration:{type:"boolean"},isAlignCenter:!0}]),this.columnsToDisplay=v(["userNumber","employeeName","isEnabled"]),this.filterConfig=v({type:"object",properties:{isEnabled:{description:"Enabled",type:"boolean"}}}),this.filterValue=v({isEnabled:!0}),this.controlsConfig=v([{id:"refresh",icon:"refresh",label:"Refresh",mode:"low-emphasis"}]),this.sortFn=b(()=>Le(this.columnsConfig())),this.filterFn=b(()=>Me(this.filterValue(),{isEnabled:(e,r,p)=>p!=null&&e.isEnabled===p}))}routeToDetail(e){return["detail",e.id]}onHeaderCellClick(e,r){this.columnsConfig.update(p=>Pe(p,e))}onFilterChange(e){this.filterValue.set(e)}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=_({token:t,factory:t.\u0275fac});let o=t;return o})();var ri=[{path:"",data:x({},P({title:"Access Control"})),children:[{path:"detail/:id",component:G,data:x({},P({deps:[h],titleFn:(o,t)=>o.params.pipe(J(l=>t.getList().pipe(N(e=>e.find(r=>r.id==l.id)?.userNumber??"--"))))})),providers:[{provide:U,useClass:Ue}],children:[{path:"overall",component:ze},{path:"raw",component:Fe,canDeactivate:[Ne],providers:[{provide:Ve,useClass:Ge}]},{path:"**",redirectTo:"overall"}]},{path:"",component:G,providers:[{provide:U,useClass:$e}],children:[{path:"",component:Be,providers:[{provide:je,useClass:qe}]}]}]}];export{ri as ROUTES};
