import{a as lt,b as mt}from"./chunk-CKJT7NHD.js";import"./chunk-LZG6JTYO.js";import{f as pt}from"./chunk-XEDX7EVO.js";import"./chunk-TWISIFN7.js";import{$ as B,Aa as D,Ba as et,E as v,F as w,Ga as O,Ka as nt,Na as F,O as J,Oa as ot,R as p,Vb as at,W as K,Wb as ct,X as u,_ as U,a as V,aa as g,b as G,ba as _,bb as rt,ca as m,da as d,db as it,ea as z,eb as st,ha as T,ia as X,k as $,ma as f,na as x,ob as A,sa as C,ua as Z,va as I,ya as tt,za as h}from"./chunk-6PNVOG3K.js";var Tt=Math.pow(10,8)*24*60*60*1e3,Rt=-Tt;var Ct=3600;var dt=Ct*24,Pt=dt*7,It=dt*365.2425,Ot=It/12,qt=Ot*3,j=Symbol.for("constructDateFrom");function l(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&j in e?e[j](t):e instanceof Date?new e.constructor(t):new Date(t)}function a(e,t){return l(t||e,e)}function E(e,t,n){let o=a(e,n?.in);return isNaN(t)?l(n?.in||e,NaN):(t&&o.setDate(o.getDate()+t),o)}function W(e,t,n){let o=a(e,n?.in);if(isNaN(t))return l(n?.in||e,NaN);if(!t)return o;let r=o.getDate(),i=l(n?.in||e,o.getTime());i.setMonth(o.getMonth()+t+1,0);let s=i.getDate();return r>=s?i:(o.setFullYear(i.getFullYear(),i.getMonth(),r),o)}function ut(e,t,n){let{years:o=0,months:r=0,weeks:i=0,days:s=0,hours:c=0,minutes:y=0,seconds:L=0}=t,k=a(e,n?.in),S=r||o?W(k,r+o*12):k,Y=s||i?E(S,s+i*7):S,q=y+c*60,wt=(L+q*60)*1e3;return l(n?.in||e,+Y+wt)}function ft(e,t){let n=a(e,t?.in).getDay();return n===0||n===6}var Ft={};function N(){return Ft}function xt(e,t){let n=N(),o=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,r=a(e,t?.in),i=r.getDay(),s=(i<o?7:0)+i-o;return r.setDate(r.getDate()-s),r.setHours(0,0,0,0),r}function H(e,...t){let n=l.bind(null,e||t.find(o=>typeof o=="object"));return t.map(n)}function R(e,t){let n=a(e,t?.in);return n.setHours(0,0,0,0),n}function P(e,t,n){let[o,r]=H(n?.in,e,t);return+R(o)==+R(r)}function ht(e,t){let n=a(e,t?.in),o=n.getMonth();return n.setFullYear(n.getFullYear(),o+1,0),n.setHours(23,59,59,999),n}function yt(e,t){let[n,o]=H(e,t.start,t.end);return{start:n,end:o}}function Dt(e,t){let{start:n,end:o}=yt(t?.in,e),r=+n>+o,i=r?+n:+o,s=r?o:n;s.setHours(0,0,0,0);let c=t?.step??1;if(!c)return[];c<0&&(c=-c,r=!r);let y=[];for(;+s<=i;)y.push(l(n,s)),s.setDate(s.getDate()+c),s.setHours(0,0,0,0);return r?y.reverse():y}function vt(e,t){let n=a(e,t?.in);return n.setDate(1),n.setHours(0,0,0,0),n}function gt(e,t){let n=N(),o=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,r=a(e,t?.in),i=r.getDay(),s=(i<o?-7:0)+6-(i-o);return r.setDate(r.getDate()+s),r.setHours(23,59,59,999),r}function _t(e,t){return a(e,t?.in).getDate()}function M(e,t){return a(e,t?.in).getMonth()}function b(e,t){return a(e,t?.in).getFullYear()}function Mt(e,t,n){return E(e,-t,n)}function bt(e,t,n){return W(e,-t,n)}function kt(e,t,n){let{years:o=0,months:r=0,weeks:i=0,days:s=0,hours:c=0,minutes:y=0,seconds:L=0}=t,k=bt(e,r+o*12,n),S=Mt(k,s+i*7,n),Y=y+c*60,Q=(L+Y*60)*1e3;return l(n?.in||e,+S-Q)}var Wt=(e,t)=>t.id,Nt=e=>["../../","detail",e];function Ht(e,t){if(e&1&&(m(0,"a",1)(1,"span",2),f(2),h(3,"date"),d(),m(4,"span",3),f(5),d()()),e&2){let n=t.$implicit;u("routerLink",Z(6,Nt,n.id)),p(2),x(D(3,3,n.startsFrom,"HH:mm")),p(3),x(n.label)}}var St=(()=>{let t=class t{constructor(){this.events=J.required()}};t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=w({type:t,selectors:[["demo-calendar-events"]],hostAttrs:[1,"contents"],inputs:{events:[1,"events"]},standalone:!0,features:[C],decls:3,vars:0,consts:[[1,"flex","flex-col","gap-0.5","py-1","overflow-hidden","w-full"],["type","button","puiBaseButton","",1,"justify-start","text-start","text-sm","ps-1","pe-2","py-0.5","gap-1",3,"routerLink"],[1,"tabular-nums","dark:text-neutral-400","font-medium"],[1,"truncate"]],template:function(r,i){r&1&&(m(0,"div",0),g(1,Ht,6,8,"a",1,Wt),d()),r&2&&(p(),_(i.events()))},dependencies:[ct,F,st]});let e=t;return e})();var Lt=(e,t)=>({"grid-rows-[min-content_repeat(6,1fr)]":e,"grid-rows-[min-content_repeat(5,1fr)]":t}),Yt=(e,t)=>({"border-r":e,"dark:text-red-400":t}),$t=(e,t)=>({"border-b":e,"border-r":t}),Bt=(e,t,n,o,r)=>({"dark:text-neutral-400":e,"font-black opacity-20":t,"font-medium opacity-10":n,"dark:text-primary-50 before:rounded-full before:-top-2 before:-bottom-2 before:-left-6 before:-right-6 before:absolute before:-z-10 before:bg-primary-700":o,"dark:text-red-400":r});function zt(e,t){if(e&1&&(m(0,"div",5),f(1),h(2,"date"),d()),e&2){let n=t.$implicit,o=t.$index,r=t.$count;u("ngClass",I(5,Yt,o!==r-1,n.isWeekend)),p(),x(D(2,2,n.date,"EE"))}}function At(e,t){if(e&1&&(m(0,"span",12),f(1),h(2,"date"),d(),z(3,"br")),e&2){let n=X().$implicit;p(),x(D(2,1,n.date,"MMM"))}}function jt(e,t){if(e&1&&(m(0,"div",6)(1,"span",10),K(2,At,4,4),m(3,"span"),f(4),h(5,"date"),d()(),z(6,"demo-calendar-events",11),d()),e&2){let n=t.$implicit,o=t.$index,r=t.$count;u("ngClass",I(8,$t,o<r-7,o%7!=6)),p(),u("ngClass",tt(11,Bt,(n.isLastMonth||n.isNextMonth)&&!n.isToday,!n.isLastMonth&&!n.isNextMonth,n.isLastMonth||n.isNextMonth,n.isToday,n.isWeekend)),p(),U(n.isStartOfMonth?2:-1),p(2),x(D(5,5,n.date,"dd")),p(2),u("events",n.events)}}var dn=(()=>{let t=class t{constructor(){this.route=v(rt),this.router=v(it),this.timestamp=A(this.route.params.pipe($(o=>o.timestamp),$(o=>Number(o)))),this.dataService=v(lt),this.rawData=A(this.dataService.getList()),this.listService=v(mt),this.selectedTime=O(()=>{let o=this.timestamp();return o!=null&&o!=-1?new Date(o):o==-1?new Date(this.listService.storedSelectedTime):new Date}),this.daysVisible=O(()=>{let o=this.selectedTime();if(o==null)return[];let r=new Date,i=xt(vt(o),{weekStartsOn:0}),s=gt(ht(o),{weekStartsOn:0});return Dt({start:i,end:s}).map(c=>({date:c,isLastMonth:M(c)<M(o)?!0:b(c)<b(c),isNextMonth:M(c)>M(o)?!0:b(c)>b(c),isStartOfMonth:_t(c)==1,isToday:P(c,r),isWeekend:ft(c)}))}),this.daysWithData=O(()=>{let o=this.daysVisible(),r=this.rawData()??[];return o.map(i=>G(V({},i),{events:r.filter(s=>P(s.startsFrom,i.date)).sort((s,c)=>s.startsFrom.getTime()-c.startsFrom.getTime())}))})}onNextMonthClick(){let o=this.selectedTime(),r=ut(o,{months:1});this.listService.updateSelectedTime(r),this.router.navigate(["../",r.getTime()],{relativeTo:this.route})}onLastMonthClick(){let o=this.selectedTime(),r=kt(o,{months:1});this.listService.updateSelectedTime(r),this.router.navigate(["../",r.getTime()],{relativeTo:this.route})}onTodayClick(){let o=new Date;this.listService.updateSelectedTime(o),this.router.navigate(["../",o.getTime()],{relativeTo:this.route})}};t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=w({type:t,selectors:[["demo-employee-calendar-monthly"]],hostAttrs:[1,"contents"],standalone:!0,features:[C],decls:15,vars:15,consts:[[1,"@container","grow","flex","flex-col"],[1,"pui-card","rounded-4","h-full","grow","overflow-hidden","flex","flex-col"],[1,"rounded-t-4","px-8","pt-6","pb-12","bg-gradient-to-br","from-primary-800/20","to-primary-900/20"],[1,"text-xl","font-display"],[1,"grow","-mt-6","bg-neutral-800","rounded-t-4","border-t","grid","grid-cols-7",3,"ngClass"],[1,"text-center","pt-2","pb-1","uppercase","font-bold","text-base/none",3,"ngClass"],["puiHoverable","",1,"flex","flex-col","items-center","justify-start","gap-1.5","relative",3,"ngClass"],["id","lastMonth","label","Last month","mode","low-emphasis","icon","arrow_back",3,"click","weight"],["id","today","label","Today","mode","auto","icon","today",3,"click","weight"],["id","nextMonth","label","Next month","mode","low-emphasis","icon","arrow_forward",3,"click","weight"],[1,"mt-2","text-[36px]/none","@screen-md:text-[48px]/none","@screen-xl:text-[64px]/none","@screen-2xl:text-[78px]/none","text-end","absolute","z-0","-bottom-2","-right-1","whitespace-nowrap","font-display","pointer-events-none","select-none",3,"ngClass"],[3,"events"],[1,"text-[24px]/none","@screen-md:text-[32px]/none","@screen-xl:text-[40px]/none","@screen-2xl:text-[54px]/none"]],template:function(r,i){r&1&&(m(0,"div",0)(1,"main",1)(2,"div",2)(3,"span",3),f(4),h(5,"date"),d()(),m(6,"div",4),g(7,zt,3,8,"div",5,B),h(9,"slice"),g(10,jt,7,17,"div",6,B),d()()(),m(12,"pui-layout-control",7),T("click",function(){return i.onLastMonthClick()}),d(),m(13,"pui-layout-control",8),T("click",function(){return i.onTodayClick()}),d(),m(14,"pui-layout-control",9),T("click",function(){return i.onNextMonthClick()}),d()),r&2&&(p(4),x(D(5,5,i.selectedTime(),"MMMM yyyy")),p(2),u("ngClass",I(12,Lt,i.daysWithData().length>35,i.daysWithData().length<=35)),p(),_(et(9,8,i.daysWithData(),0,7)),p(3),_(i.daysWithData()),p(2),u("weight",-100),p(),u("weight",0),p(),u("weight",100))},dependencies:[pt,at,F,nt,St,ot]});let e=t;return e})();export{dn as EmployeeCalendarMonthlyComponent};
