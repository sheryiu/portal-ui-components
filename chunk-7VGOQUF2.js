import{a as S}from"./chunk-EYQKS35T.js";import{a as de}from"./chunk-42ZTV3V5.js";import{Aa as o,B as _,Ba as d,D as V,Ea as j,Fa as C,Fc as ee,Ga as f,Gc as te,L as x,La as l,N as g,Na as Z,Nc as ie,Pa as h,Rb as Q,S as M,T as U,Ta as v,Ua as L,Va as q,Zc as ne,a as z,c as w,ca as u,e as I,eb as G,fb as H,fc as W,ga as N,h as b,ia as J,k as D,la as K,m as k,na as p,nc as X,nd as oe,od as ae,p as E,pc as Y,qa as F,s as $,t as B,td as re,ua as c,ud as se,v as P,vd as le,x as T,yd as pe,z as R,za as a}from"./chunk-PX5QVNHM.js";import"./chunk-6RDLFHTQ.js";import{a as y}from"./chunk-CWTPBX7D.js";function fe(t,i){if(t&1&&d(0,"pui-linear-progress-display",9),t&2){let r=f();F("value",r.completedRows*100/r.totalRows)}}function be(t,i){t&1&&p(0,fe,1,1,"pui-linear-progress-display",8),t&2&&c(0,i.totalRows>0?0:-1)}function _e(t,i){if(t&1){let r=j();a(0,"button",10),C("click",function(){M(r);let e=f();return U(e.onDownloadClick())}),l(1,"Download"),o()}}function xe(t,i){if(t&1&&d(0,"pui-linear-progress-display",9),t&2){let r=f();F("value",r.completedRows*100/r.totalRows)}}function ge(t,i){t&1&&p(0,xe,1,1,"pui-linear-progress-display",8),t&2&&c(0,i.totalRows>0?0:-1)}function Ce(t,i){if(t&1){let r=j();a(0,"button",10),C("click",function(){M(r);let e=f();return U(e.onUploadClick())}),l(1,"Upload"),o()}}function he(t,i){if(t&1&&(a(0,"span",6),l(1),v(2,"number"),a(3,"span",11),l(4,"KB"),o()()),t&2){let r;u(),Z("",q(2,1,((r=i.used)!==null&&r!==void 0?r:0)/1024,"1.2-2")," ")}}var me=(()=>{let i=class i extends W{constructor(){super(),this.service=x(de),this.zone=x(J),this.renderer=x(N),this._downloadProgress$=new w(void 0),this.downloadProgress$=this._downloadProgress$.pipe(T(),$(([s,e])=>k(s==null||e?.completedRows==0?0:300).pipe(b(()=>e))),R(1)),this._uploadProgress$=new w(void 0),this.uploadProgress$=this._uploadProgress$.pipe(T(),$(([s,e])=>k(s==null||e?.completedRows==0?0:300).pipe(b(()=>e))),R(1)),this.onDownloadClick=this.createEffectFn(s=>s.pipe(P(()=>I(this.service.export({progressCallback:e=>(this.zone.run(()=>{this._downloadProgress$.next(y({},e)),e.done&&this._downloadProgress$.next(void 0)}),!0)})).pipe(_(e=>D(()=>this.downloadProgress$.pipe(E(n=>n==null),B(1),b(()=>e)))),V(e=>{let n=this.renderer.createElement("a");n.download="download.json",n.href=URL.createObjectURL(new Blob([e])),n.click(),URL.revokeObjectURL(n.href)}))))),this.onUploadClick=this.createEffectFn(s=>s.pipe(P(()=>new z(e=>{let n=this.renderer.createElement("input");n.type="file",n.accept="application/json",n.addEventListener("change",()=>{let m=new FileReader;m.addEventListener("load",()=>{e.next(m.result),e.complete()}),m.readAsArrayBuffer(n.files[0])}),n.click()}).pipe(_(e=>this.service.import(new Blob([e]),{clearTablesBeforeImport:!0,progressCallback:n=>(this.zone.run(()=>{this._uploadProgress$.next(y({},n)),n.done&&this._uploadProgress$.next(void 0)}),!0)})),_(()=>D(()=>this.uploadProgress$.pipe(E(e=>e==null),B(1)))))))),!(this.service.isServer||!this.service.bytesUsed$)&&(this.bytesUsed$$=Q(this.service.bytesUsed$))}onDeleteAllClick(){this.service.emptyDatabase()}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=g({type:i,selectors:[["demo-settings-database"]],standalone:!0,features:[K,h],decls:29,vars:7,consts:[[1,"flex","flex-col","px-4"],[1,"flex","py-3","gap-6","justify-between","items-center"],[1,"flex","flex-col","gap-px"],[1,"font-bold","tracking-tight","text-primary-800","dark:text-primary-200"],[1,"font-light","text-secondary"],[1,"flex","gap-4","items-center"],[1,"font-bold"],["puiFilledButton","","color","red",1,"rounded-1","px-3","py-2",3,"click"],[1,"h-6","max-w-120","my-0.5"],[1,"h-6","max-w-120","my-0.5",3,"value"],["puiFilledButton","","color","primary",1,"rounded-1","px-3","py-2",3,"click"],[1,"text-secondary","text-sm","font-normal"]],template:function(e,n){if(e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),l(4,"Export Database"),o(),a(5,"span",4),l(6,"Download the database as one JSON file"),o()(),p(7,be,1,1),v(8,"async"),p(9,_e,2,0),o(),d(10,"pui-divider"),a(11,"div",1)(12,"div",2)(13,"span",3),l(14,"Import Database"),o(),a(15,"span",4),l(16,"Upload a JSON file"),o()(),p(17,ge,1,1),v(18,"async"),p(19,Ce,2,0),o(),d(20,"pui-divider"),a(21,"div",1)(22,"div",2)(23,"span",3),l(24,"Database Size"),o()(),a(25,"div",5),p(26,he,5,4,"span",6),a(27,"button",7),C("click",function(){return n.onDeleteAllClick()}),l(28,"Delete All"),o()()()()),e&2){let m,A,O;u(7),c(7,(m=L(8,3,n.downloadProgress$))?7:9,m),u(10),c(17,(A=L(18,5,n.uploadProgress$))?17:19,A),u(9),c(26,(O=n.bytesUsed$$==null?null:n.bytesUsed$$())?26:-1,O)}},dependencies:[S,G,H,ie,te,Y,X]});let t=i;return t})();function ve(t,i){t&1&&(a(0,"div",3)(1,"div",4)(2,"span"),l(3,"Database"),o()(),d(4,"demo-settings-database"),o())}var je=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=g({type:i,selectors:[["app-settings"]],standalone:!0,features:[h],decls:6,vars:0,consts:[["puiSidebarContainer",""],["puiSidebarBreadcrumbs",""],["puiTabBarContainer","","class","flex flex-col gap-4 pe-6 py-6",4,"puiSidebarMain"],["puiTabBarContainer","",1,"flex","flex-col","gap-4","pe-6","py-6"],[1,"bg-hover","text-primary-700","dark:text-primary-500","text-base","font-medium","me-4","border","border-s-0","rounded-e-1","py-1","ps-4","pe-2","min-h-11","flex","justify-between","items-center","gap-2"]],template:function(e,n){e&1&&(a(0,"pui-layered-container")(1,"div",0)(2,"div",1),d(3,"pui-breadcrumbs"),o(),a(4,"pui-sidebar-content"),p(5,ve,5,0,"div",2),o()()())},dependencies:[S,ee,me,ne,le,ae,oe,se,re,pe]});let t=i;return t})();export{je as SettingsComponent};
