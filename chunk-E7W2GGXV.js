import{a as v}from"./chunk-KTXFX32L.js";import{e as C}from"./chunk-VDBJI3K4.js";import{c as O,e as j,g as F,h as N,i as V,j as x,k as P,l as M,m as B,n as U,o as g,p as D}from"./chunk-P23DIH4X.js";import{a as n}from"./chunk-5KUQE4MU.js";import{Ba as c,Da as R,Db as w,P as s,Wb as y,b as T,f as E,g as L,jb as u,o as A,p as f,w as l,ya as k,z as o}from"./chunk-K2JVR4UR.js";import{a as h}from"./chunk-EQDQRRRY.js";var S=(()=>{let t=class t{constructor(){this.id=s(void 0),this.heading=c(()=>this.id()??"--"),this.tabs=s([{label:"Raw",route:["raw"]}]),this.routeToFullContent=c(()=>["../","system-log",{outlets:{primary:["detail",this.id()],peek:null}}])}onParamsChange(e,r){this.id.set(e.id)}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=l({token:t,factory:t.\u0275fac});let i=t;return i})();var p=function(i){return i.INFO="Info",i.WARN="Warn",i.ERROR="Error",i.DEBUG="Debug",i}(p||{});var I=(()=>{let t=class t{constructor(){this.appRef=o(k),this.list=new T([]),this.employeeData=o(C),this.customerData=o(v),this.isInitialized=!1}createMock(e,r){return{id:n.string.nanoid(),timestamp:n.date.recent({days:20}),level:n.helpers.enumValue(p),message:n.git.commitMessage(),context:n.helpers.arrayElement(["access-control","customer","employee-calendar-event","employee","inventory-item","inventory-shelf"]),employeeId:e?.id??null,customerId:r?.id??null,ipAddress:n.helpers.maybe(()=>n.internet.ip())??null,detail:""}}initialize(){this.isInitialized||(this.isInitialized=!0,L([this.employeeData.getList().pipe(f(e=>e.length>0)),this.customerData.getList().pipe(f(e=>e.length>0))]).subscribe(([e,r])=>{this.list.next(Array(300).fill(0).map((a,m)=>{let d=n.datatype.boolean(.7);return this.createMock(d?void 0:n.helpers.arrayElement(e),d?n.helpers.arrayElement(r):void 0)}))}))}getList(){return this.appRef.isStable.pipe(f(e=>e),A(1e3)).subscribe(()=>{this.initialize()}),this.list}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=l({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();var W=(()=>{let t=class t{constructor(){this.dataService=o(I),this.id=s(void 0),this.rawData=u(this.dataService.getList()),this.isDirty=s(!1),this.updatedValue=s(void 0),this.data=s(void 0),this.fieldConfiguration=s({type:"object",properties:{timestamp:{type:"date-time",description:"Timestamp"},message:{type:"string",description:"Message"},level:{type:"string",description:"Level",enum:Object.values(p)},context:{type:"string",description:"Context"},customerId:{type:"string",description:"Customer ID"},employeeId:{type:"string",description:"Employee ID"},ipAddress:{type:"string",description:"IP Address"},detail:{type:"string",description:"Detail"}}}),this.controlsConfig=s(O),R(()=>{this.data.set(structuredClone(this.rawData()?.find(e=>e.id==this.id())))},{allowSignalWrites:!0})}registerUpdateState(e){this.updateState=e}onStateChange(e){this.isDirty.update(r=>e.isDirty??r)}onValueChange(e){this.updatedValue.set(e)}onControlClick(e,r){switch(e){case"refresh":{this.data.set(structuredClone(this.rawData()?.find(a=>a.id==this.id())));break}}}onParamsChange(e,r){this.id.set(e.id)}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=l({token:t,factory:t.\u0275fac});let i=t;return i})();var z=(()=>{let t=class t{constructor(){this.heading=s("System Log"),this.tabs=s([{label:"Raw",route:["raw"]}])}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=l({token:t,factory:t.\u0275fac});let i=t;return i})();var H=(()=>{let t=class t{constructor(){this.screenWidth=o(w),this.dataService=o(I),this.rawData=u(this.dataService.getList()),this.customerDataService=o(v),this.customerData=u(this.customerDataService.getList()),this.employeeDataService=o(C),this.employeeData=u(this.employeeDataService.getList()),this.configuration={useVirtualScroll:!0},this.data=c(()=>{let e=this.rawData()??[],r=this.customerData()??[],a=this.employeeData()??[];return e.toSorted(this.sortFn()).filter(this.filterFn()).map(m=>Object.assign(m,{user:m.customerId?r.find(d=>d.id==m.customerId):m.employeeId?a.find(d=>d.id==m.employeeId):null}))}),this.columnsConfig=s([{key:"timestamp",label:"Timestamp",fieldConfiguration:{type:"date-time",format:"yyyy-MM-dd HH:mm:ss.SSS"},isSortedDesc:!0},{key:"level",label:"Level"},{key:"message",label:"Message"},{key:"user",path:"user.name",label:"User"}]),this.columnsToDisplay=s({default:["timestamp","level","message"],1280:["timestamp","level","message","user"]}),this.controlsConfig=s(P),this.filterConfig=s({type:"object",properties:{id:{type:"string",description:"ID"},level:{type:"string",description:"Level",enum:Object.values(p)},message:{type:"string",description:"Message"}}}),this.filterValue=s({}),this.sortFn=c(()=>x(this.columnsConfig())),this.filterFn=c(()=>V(this.filterValue(),{id:(e,r,a)=>!!a&&e.id==a,message:(e,r,a)=>!!a&&e.message.includes(a),level:(e,r,a)=>!!a&&e.level==a}))}routeToDetail(e){return this.screenWidth.above().sm()?["../","system-log",{outlets:{peek:[e.id]}}]:["../","system-log","detail",e.id]}onHeaderCellClick(e,r){this.columnsConfig.update(a=>U(a,e))}onFilterChange(e){this.filterValue.set(e)}onControlClick(e,r){switch(e){case"add":break;case"refresh":break}}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=l({token:t,factory:t.\u0275fac});let i=t;return i})();var q=[{path:"raw",component:F,providers:[{provide:j,useClass:W}]},{path:"**",redirectTo:"raw"}],we=[{path:"",data:h({},y({title:"System Log"})),children:[{path:"detail/:id",component:D,data:h({},y({titleFn:i=>i.params.pipe(E(t=>t.id))})),providers:[{provide:g,useClass:S}],children:q},{path:"",component:D,providers:[{provide:g,useClass:z},{provide:N,useClass:S}],children:[{path:":id",outlet:"peek",component:D,data:h({},y({titleFn:i=>i.params.pipe(E(t=>t.id))})),providers:[{provide:g,useClass:S}],children:q},{path:"",component:B,providers:[{provide:M,useClass:H}]}]}]}];export{we as ROUTES};
