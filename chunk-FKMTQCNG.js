import{c as S,e as A}from"./chunk-PJG25YFU.js";import{c as be,d as _e,e as xe,g as Ee,j as Se,k as Ae,m as Ie,n as Te,o as ke,p as P,q as U}from"./chunk-4O53RTDY.js";import{a as p}from"./chunk-5KUQE4MU.js";import{$ as de,A as te,Ca as Ce,Ea as he,J as F,M as v,N as ie,O as ne,P as oe,T as re,V as ae,W as le,X as se,Y as ce,Z as x,_ as pe,b as Z,ia as L,ra as me,sa as ue,ta as fe,wa as ye,x as ee,xa as ge,ya as j,za as ve}from"./chunk-LL7XBVH4.js";import{$ as C,Ab as R,Bb as n,Cb as o,Da as u,Db as h,Ib as f,Jb as K,K as M,N as D,Ra as s,Ub as l,Vb as E,W as H,bc as Q,dc as W,eb as z,ec as O,fa as m,g as $,lb as q,q as T,sb as Y,tc as g,ub as d,vc as X,wc as k,xb as J,yb as N,zb as w}from"./chunk-NI5DWAPZ.js";import{a as _,b as G}from"./chunk-EQDQRRRY.js";var b=(()=>{class t{constructor(){this.appRef=m(Y),this.list=new $([]),this.employeeData=m(A),this.isInitialized=!1}createMock(e,i){return{id:p.string.nanoid(),userNumber:String(i).padStart(4,"0"),employeeId:e.id,isEnabled:e.status!=S.INACTIVE&&e.status!=S.TERMINATED&&e.status!=S.RETIRED,permissions:{customer:{canCreate:p.datatype.boolean(),canRead:p.datatype.boolean(),canUpdate:p.datatype.boolean(),canDelete:p.datatype.boolean()},employee:{canCreate:p.datatype.boolean(),canRead:p.datatype.boolean(),canUpdate:p.datatype.boolean(),canDelete:p.datatype.boolean()},inventoryItem:{canCreate:p.datatype.boolean(),canRead:p.datatype.boolean(),canUpdate:p.datatype.boolean(),canDelete:p.datatype.boolean()}},conditions:{location:{isEnabled:p.datatype.boolean(),allowedIps:Array(p.helpers.rangeToNumber(5)).fill(0).map(()=>p.internet.ip()),countries:Array(p.helpers.rangeToNumber(2)).fill(0).map(()=>p.location.country())},timeRange:{isEnabled:p.datatype.boolean(),allowedAfter:p.helpers.maybe(()=>p.helpers.rangeToNumber(23).toString().padStart(2,"0")+"00")??null,allowedBefore:p.helpers.maybe(()=>p.helpers.rangeToNumber(23).toString().padStart(2,"0")+"00")??null}}}}initialize(){this.isInitialized||(this.isInitialized=!0,this.employeeData.getList().pipe(D(e=>e.length>0)).subscribe(e=>{this.list.next(e.map((i,r)=>this.createMock(i,r)))}))}getList(){return this.appRef.isStable.pipe(D(e=>e),M(1e3)).subscribe(()=>{this.initialize()}),this.list}save(e){this.list.next(this.list.value.map(i=>i.id==e.id?e:i))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var De=(()=>{class t{constructor(){this.dataService=m(b),this.list=v(this.dataService.getList()),this.id=u(void 0),this.heading=g(()=>this.list()?.find(e=>e.id==this.id())?.userNumber??"--"),this.tabs=u([{label:"Overall",route:["overall"]},{label:"Raw",route:["raw"]}])}onParamsChange(e,i){this.id.set(e.id)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac})}}return t})();var B={type:"object",properties:{canCreate:{type:"boolean",description:"Can Create"},canRead:{type:"boolean",description:"Can Read"},canUpdate:{type:"boolean",description:"Can Update"},canDelete:{type:"boolean",description:"Can Delete"}}},Ne=(()=>{class t{constructor(){this.dataService=m(b),this.list=v(this.dataService.getList()),this.id=u(void 0),this.data=u(void 0),this.fieldConfiguration=u({type:"object",properties:{userNumber:{description:"User number",type:"string"},employeeId:{description:"Employee ID",type:"string"},isEnabled:{description:"Enabled",type:"boolean"},permissions:{description:"Permissions",type:"object",properties:{customer:_({description:"Customer"},B),employee:_({description:"Employee"},B),inventoryItem:_({description:"Inventory Item"},B)}},conditions:{description:"Conditions",type:"object",properties:{location:{description:"Location-Based",type:"object",properties:{isEnabled:{type:"boolean",description:"Enabled"},allowedIps:{type:"array",description:"Allowed IPs",items:{type:"string"}},countries:{type:"array",description:"Countries",items:{type:"string"}}}},timeRange:{description:"Time-Based",type:"object",properties:{isEnabled:{type:"boolean",description:"Enabled"},allowedAfter:{description:"Allowed After (HHmm)",type:"string"},allowedBefore:{description:"Allowed Before (HHmm)",type:"string"}}}}}}}),this.isDirty=u(!1),this.updatedValue=u(void 0),this.controlsConfig=g(()=>this.isDirty()?_e:be),k(()=>{this.data.set(F(this.list()?.find(e=>e.id==this.id())))})}registerUpdateState(e){this.updateState=e}onStateChange(e){this.isDirty.update(i=>e.isDirty??i)}onValueChange(e){this.updatedValue.set(e)}onControlClick(e,i){switch(e){case"refresh":case"cancel":{this.data.set(F(this.list()?.find(r=>r.id==this.id()))),this.updateState({isDirty:!1});break}case"save":{let r=this.updatedValue();r&&(this.dataService.save(r),this.updateState({isDirty:!1}));break}}}onParamsChange(e,i){this.id.set(e.id)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac})}}return t})();var we=(()=>{class t{constructor(){this.heading=u("Access Control Management"),this.tabs=u([])}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac})}}return t})();var Le=t=>["/user","employee","detail",t],je=(t,y,e)=>({"dark:text-red-400":t,"dark:text-orange-400":y,"dark:text-green-400":e}),Re=(t,y,e,i)=>({"rounded-t-2":t,"rounded-t-none":y,"rounded-b-2":e,"rounded-b-none":i});function Pe(t,y){if(t&1&&(h(0,"div",46),n(1,"a",47)(2,"div",48)(3,"h2",49),l(4),o(),n(5,"p",50)(6,"span",51),l(7),o(),n(8,"span"),l(9," / "),o(),n(10,"span"),l(11),o()(),n(12,"p",52)(13,"i",53),l(14,"label_important"),o(),n(15,"span"),l(16),o()()()()),t&2){let e=y,i=K();s(),d("hoverableEnabled",e!=null)("routerLink",e!=null?Q(7,Le,e.id):null),s(3),E(e.name),s(3),E(e.department),s(4),E(e.position),s(2),d("ngClass",W(9,je,e.status==i.employeeStatus.TERMINATED||e.status==i.employeeStatus.INACTIVE||e.status==i.employeeStatus.RETIRED,e.status==i.employeeStatus.ON_LEAVE||e.status==i.employeeStatus.PROBATION,e.status==i.employeeStatus.ACTIVE||e.status==i.employeeStatus.CONTRACT)),s(3),E(e.status)}}function Ue(t,y){if(t&1&&(n(0,"pui-input-field",40),h(1,"input",54),n(2,"button",55)(3,"i",56),l(4,"close"),o()()()),t&2){let e=y.$index,i=y.$index,r=y.$count;d("ngClass",O(2,Re,i===0,i!==0,i===r-1,i!==r-1)),s(),d("formControlName",e)}}function Be(t,y){t&1&&(n(0,"p",41),l(1,"All IP are allowed"),o())}function Ve(t,y){if(t&1&&(n(0,"pui-input-field",40),h(1,"input",54),n(2,"button",55)(3,"i",56),l(4,"close"),o()()()),t&2){let e=y.$index,i=y.$index,r=y.$count;d("ngClass",O(2,Re,i===0,i!==0,i===r-1,i!==r-1)),s(),d("formControlName",e)}}function Ge(t,y){t&1&&(n(0,"p",41),l(1,"All countries are allowed"),o())}var Oe=(()=>{class t{constructor(){this.dataService=m(b),this.employeeDataService=m(A),this.route=m(ee),this.list=v(this.dataService.getList()),this.employeeList=v(this.employeeDataService.getList()),this.id=v(this.route.params.pipe(T(e=>e.id))),this.accessControl=g(()=>this.list()?.find(e=>e.id==this.id())),this.employee=g(()=>this.employeeList()?.find(e=>e.id==this.accessControl()?.employeeId)),this.employeeStatus=S,this.formGroup=m(x).nonNullable.group({isEnabled:[!1],customer:m(x).nonNullable.group({canCreate:[!1],canRead:[!1],canUpdate:[!1],canDelete:[!1]}),employee:m(x).nonNullable.group({canCreate:[!1],canRead:[!1],canUpdate:[!1],canDelete:[!1]}),inventoryItem:m(x).nonNullable.group({canCreate:[!1],canRead:[!1],canUpdate:[!1],canDelete:[!1]}),location:m(x).nonNullable.group({isEnabled:[!1],allowedIps:m(x).nonNullable.array([]),countries:m(x).nonNullable.array([])})}),k(()=>{let e=this.accessControl();e&&X(()=>{L(this.formGroup.controls.location.controls.allowedIps,e.conditions.location.allowedIps.length),L(this.formGroup.controls.location.controls.countries,e.conditions.location.countries.length),this.formGroup.setValue({isEnabled:e.isEnabled,customer:{canCreate:e.permissions.customer.canCreate,canRead:e.permissions.customer.canRead,canUpdate:e.permissions.customer.canUpdate,canDelete:e.permissions.customer.canDelete},employee:{canCreate:e.permissions.employee.canCreate,canRead:e.permissions.employee.canRead,canUpdate:e.permissions.employee.canUpdate,canDelete:e.permissions.employee.canDelete},inventoryItem:{canCreate:e.permissions.inventoryItem.canCreate,canRead:e.permissions.inventoryItem.canRead,canUpdate:e.permissions.inventoryItem.canUpdate,canDelete:e.permissions.inventoryItem.canDelete},location:{isEnabled:e.conditions.location.isEnabled,allowedIps:e.conditions.location.allowedIps,countries:e.conditions.location.countries}})})})}onToggleAll(e){let i=this.formGroup.getRawValue()[e];Object.values(i).every(c=>c==!0)?this.formGroup.get(e)?.setValue({canCreate:!1,canRead:!1,canUpdate:!1,canDelete:!1}):this.formGroup.get(e)?.setValue({canCreate:!0,canRead:!0,canUpdate:!0,canDelete:!0})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=z({type:t,selectors:[["demo-access-control-overall"]],hostAttrs:[1,"contents"],decls:108,vars:20,consts:[[1,"@container","grow"],[1,"pui-card","rounded-4","p-8"],[1,"flex","flex-col","@screen-lg:flex-row","gap-8"],[1,"flex","flex-col","gap-4","@screen-lg:basis-1/4","@screen-lg:sticky","top-8","h-fit"],[1,"flex","flex-row","items-center","gap-2"],[1,"icon-6","font-variation-weight-light","text-neutral-800","dark:text-neutral-200"],[1,"flex","flex-col","gap-1"],[1,"text-sm","text-neutral-800","dark:text-neutral-200"],[1,"text-base"],[1,"flex","flex-col","gap-8","@screen-lg:basis-3/4",3,"formGroup"],[1,"flex","flex-row","items-center","gap-4"],["formControlName","isEnabled",3,"id"],["for","isEnabled",1,"flex","flex-col","gap-1","grow"],[1,"text-base","font-medium"],[1,"text-neutral-700","dark:text-neutral-300","text-sm","font-light"],[1,"flex","flex-col","gap-2"],[1,"flex","flex-row","justify-end","items-center","px-6","gap-4"],["puiTooltip","Create",1,"px-5","py-2"],[1,"icon-6","font-variation-weight-light"],["puiTooltip","Read",1,"px-5","py-2"],["puiTooltip","Update",1,"px-5","py-2"],["puiTooltip","Delete",1,"px-5","py-2"],["puiHoverable","","tabindex","0",1,"relative","rounded-4","before:absolute","before:inset-0","before:pui-card--subtle","before:rounded-4","before:transparency-mask-to-r","before:-z-10","justify-start",3,"click"],["formGroupName","customer",1,"flex","flex-row","items-center","px-6","py-4","gap-4","grow"],[1,"spacer"],["formControlName","canCreate",3,"click","id"],["formControlName","canRead",3,"click","id"],["formControlName","canUpdate",3,"click","id"],["formControlName","canDelete",3,"click","id"],["formGroupName","employee",1,"flex","flex-row","items-center","px-6","py-4","gap-4","grow"],["formGroupName","inventoryItem",1,"flex","flex-row","items-center","px-6","py-4","gap-4","grow"],[1,"relative","rounded-4","before:absolute","before:inset-0","before:pui-card--subtle","before:rounded-4","before:transparency-mask-to-r","before:-z-10","justify-start"],["formGroupName","location",1,"flex","flex-col","px-6","py-4","gap-4","grow"],["formControlName","isEnabled",3,"click","id"],["for","locationIsEnabled",1,"flex","flex-col","gap-1","grow",3,"click"],[1,"grid","grid-cols-1","@screen-md:grid-cols-2","gap-4"],[1,"pui-card--subtle","rounded-4","p-4"],["formArrayName","allowedIps",1,"flex","flex-col","gap-4"],[1,"px-4"],[1,"flex","flex-col"],[1,"py-1","text-base",3,"ngClass"],[1,"text-sm","text-neutral-700","dark:text-neutral-300","px-4"],[1,"self-end","px-1"],["puiBorderedButton","","color","primary",1,"rounded-full","p-2"],[1,"icon-5"],["formArrayName","countries",1,"flex","flex-col","gap-4"],[1,"flex-none","basis-2"],["puiHoverable","",1,"pui-card--subtle","rounded-4","p-8","overflow-hidden",3,"hoverableEnabled","routerLink"],[1,"flex","flex-col","items-center","gap-2"],[1,"w-full","text-center","break-anywhere","whitespace-normal"],[1,"text-sm","text-center"],[1,"text-neutral-700","dark:text-neutral-300"],[1,"text-base","text-center","flex","items-center","gap-1"],[1,"icon-4","font-variation-fill",3,"ngClass"],[3,"formControlName"],["puiBaseButton","",1,"rounded-full","p-2","me-2"],[1,"icon-4"]],template:function(i,r){if(i&1&&(n(0,"div",0)(1,"main",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"i",5),l(6,"key"),o(),n(7,"div",6)(8,"span",7),l(9,"User #"),o(),n(10,"span",8),l(11),o()()(),h(12,"pui-divider"),n(13,"div",4)(14,"i",5),l(15,"badge"),o(),n(16,"div",6)(17,"span",7),l(18,"Employee ID"),o(),n(19,"span",8),l(20),o()()(),q(21,Pe,17,13),o(),n(22,"form",9)(23,"div",10),h(24,"pui-toggle",11),n(25,"label",12)(26,"p",13),l(27,"Enable"),o(),n(28,"p",14),l(29,"Enable this account to login and access system resources"),o()()(),n(30,"div",15)(31,"div",16)(32,"div",17)(33,"i",18),l(34,"add"),o()(),n(35,"div",19)(36,"i",18),l(37,"visibility"),o()(),n(38,"div",20)(39,"i",18),l(40,"edit"),o()(),n(41,"div",21)(42,"i",18),l(43,"delete"),o()()(),n(44,"div",22),f("click",function(){return r.onToggleAll("customer")}),n(45,"div",23)(46,"h3"),l(47,"Customer"),o(),h(48,"div",24),n(49,"pui-toggle",25),f("click",function(a){return a.stopPropagation()}),o(),n(50,"pui-toggle",26),f("click",function(a){return a.stopPropagation()}),o(),n(51,"pui-toggle",27),f("click",function(a){return a.stopPropagation()}),o(),n(52,"pui-toggle",28),f("click",function(a){return a.stopPropagation()}),o()()(),n(53,"div",22),f("click",function(){return r.onToggleAll("employee")}),n(54,"div",29)(55,"h3"),l(56,"Employee"),o(),h(57,"div",24),n(58,"pui-toggle",25),f("click",function(a){return a.stopPropagation()}),o(),n(59,"pui-toggle",26),f("click",function(a){return a.stopPropagation()}),o(),n(60,"pui-toggle",27),f("click",function(a){return a.stopPropagation()}),o(),n(61,"pui-toggle",28),f("click",function(a){return a.stopPropagation()}),o()()(),n(62,"div",22),f("click",function(){return r.onToggleAll("inventoryItem")}),n(63,"div",30)(64,"h3"),l(65,"Inventory Item"),o(),h(66,"div",24),n(67,"pui-toggle",25),f("click",function(a){return a.stopPropagation()}),o(),n(68,"pui-toggle",26),f("click",function(a){return a.stopPropagation()}),o(),n(69,"pui-toggle",27),f("click",function(a){return a.stopPropagation()}),o(),n(70,"pui-toggle",28),f("click",function(a){return a.stopPropagation()}),o()()()(),h(71,"pui-divider"),n(72,"h2"),l(73,"Conditions"),o(),n(74,"div",31)(75,"div",32)(76,"div",10)(77,"pui-toggle",33),f("click",function(a){return a.stopPropagation()}),o(),n(78,"label",34),f("click",function(a){return a.stopPropagation()}),n(79,"h3"),l(80,"Location based permission conditions"),o(),n(81,"p",14),l(82,"Blocks access according to location related metadata"),o()()(),n(83,"div",35)(84,"div",36)(85,"div",37)(86,"h3",38),l(87,"Allowed IP Address"),o(),n(88,"div",39),w(89,Ue,5,7,"pui-input-field",40,N,!1,Be,2,0,"p",41),o(),n(92,"div",42)(93,"button",43)(94,"i",44),l(95,"add"),o()()()()(),n(96,"div",36)(97,"div",45)(98,"h3",38),l(99,"Country"),o(),n(100,"div",39),w(101,Ve,5,7,"pui-input-field",40,N,!1,Ge,2,0,"p",41),o(),n(104,"div",42)(105,"button",43)(106,"i",44),l(107,"add"),o()()()()()()()()()()()()),i&2){let c,a,V;s(11),E((c=(c=r.accessControl())==null?null:c.userNumber)!==null&&c!==void 0?c:"----"),s(9),E((a=(a=r.accessControl())==null?null:a.employeeId)!==null&&a!==void 0?a:"----"),s(),J((V=r.employee())?21:-1,V),s(),d("formGroup",r.formGroup),s(2),d("id","isEnabled"),s(25),d("id","customerCanCreate"),s(),d("id","customerCanRead"),s(),d("id","customerCanUpdate"),s(),d("id","customerCanDelete"),s(6),d("id","employeeCanCreate"),s(),d("id","employeeCanRead"),s(),d("id","employeeCanUpdate"),s(),d("id","employeeCanDelete"),s(6),d("id","inventoryItemCanCreate"),s(),d("id","inventoryItemCanRead"),s(),d("id","inventoryItemCanUpdate"),s(),d("id","inventoryItemCanDelete"),s(7),d("id","locationIsEnabled"),s(12),R(r.formGroup.controls.location.controls.allowedIps.controls),s(12),R(r.formGroup.controls.location.controls.countries.controls)}},dependencies:[Ce,Z,me,te,he,pe,re,ie,ne,oe,de,ae,ce,le,se,ge,ye,ue,fe,ve],encapsulation:2})}}return t})();var Fe=(()=>{class t{constructor(){this.dataService=m(b),this.employeeDataService=m(A),this.rawData=v(this.dataService.getList()),this.employeeList=v(this.employeeDataService.getList()),this.configuration={useVirtualScroll:!0},this.data=g(()=>{let e=this.rawData(),i=this.employeeList();return!e||!i?[]:e.map(r=>G(_({},r),{employee:i.find(c=>c.id==r.employeeId)})).filter(this.filterFn()).toSorted(this.sortFn())}),this.columnsConfig=u([{key:"userNumber",label:"#",isSortedAsc:!0},{key:"employeeName",label:"Employee",path:"employee.name"},{key:"isEnabled",label:"Enabled",fieldConfiguration:{type:"boolean"}}]),this.columnsToDisplay=u(["userNumber","employeeName","isEnabled"]),this.filterConfig=u({type:"object",properties:{isEnabled:{description:"Enabled",type:"boolean"}}}),this.filterValue=u({isEnabled:!0}),this.controlsConfig=u([{id:"refresh",icon:"refresh",label:"Refresh",mode:"low-emphasis"}]),this.sortFn=g(()=>Ae(this.columnsConfig())),this.filterFn=g(()=>Se(this.filterValue(),{isEnabled:(e,i,r)=>r!=null&&e.isEnabled===r}))}routeToDetail(e){return["detail",e.id]}onHeaderCellClick(e,i){this.columnsConfig.update(r=>ke(r,e))}onFilterChange(e){this.filterValue.set(e)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=C({token:t,factory:t.\u0275fac})}}return t})();var Ht=[{path:"",data:_({},j({title:"Access Control"})),children:[{path:"detail/:id",component:U,data:_({},j({deps:[b],titleFn:(t,y)=>t.params.pipe(H(e=>y.getList().pipe(T(i=>i.find(r=>r.id==e.id)?.userNumber??"--"))))})),providers:[{provide:P,useClass:De}],children:[{path:"overall",component:Oe},{path:"raw",component:Ee,providers:[{provide:xe,useClass:Ne}]},{path:"**",redirectTo:"overall"}]},{path:"",component:U,providers:[{provide:P,useClass:we}],children:[{path:"",component:Te,providers:[{provide:Ie,useClass:Fe}]}]}]}];export{Ht as ROUTES};
