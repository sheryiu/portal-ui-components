import{a as dt,b as mt}from"./chunk-GJTET7ZX.js";import"./chunk-4LJXWH66.js";import"./chunk-5EEIOBZW.js";import{$ as j,B as v,C as S,I as U,L as p,Na as it,P as X,Pa as at,Q as u,Qa as st,Rb as lt,S as Z,T as z,U as g,V as _,W as m,X as d,Y as A,Ya as R,_ as T,a as J,b as K,ba as f,ca as D,da as C,ga as I,i as Y,ia as tt,ja as O,ma as et,mb as ct,na as h,nb as pt,oa as x,pa as ot,ta as F,xa as nt,ya as E,za as rt}from"./chunk-7IRLRVY6.js";var Ct=Math.pow(10,8)*24*60*60*1e3,qt=-Ct;var It=3600;var ut=It*24,Qt=ut*7,Ot=ut*365.2425,Ft=Ot/12,Vt=Ft*3,P=Symbol.for("constructDateFrom");function l(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&P in e?e[P](t):e instanceof Date?new e.constructor(t):new Date(t)}function s(e,t){return l(t||e,e)}function W(e,t,o){let n=s(e,o?.in);return isNaN(t)?l(o?.in||e,NaN):(t&&n.setDate(n.getDate()+t),n)}function N(e,t,o){let n=s(e,o?.in);if(isNaN(t))return l(o?.in||e,NaN);if(!t)return n;let r=n.getDate(),i=l(o?.in||e,n.getTime());i.setMonth(n.getMonth()+t+1,0);let a=i.getDate();return r>=a?i:(n.setFullYear(i.getFullYear(),i.getMonth(),r),n)}function ft(e,t,o){let{years:n=0,months:r=0,weeks:i=0,days:a=0,hours:c=0,minutes:y=0,seconds:$=0}=t,k=s(e,o?.in),w=r||n?N(k,r+n*12):k,B=a||i?W(w,a+i*7):w,V=y+c*60,Tt=($+V*60)*1e3;return l(o?.in||e,+B+Tt)}function ht(e,t){let o=s(e,t?.in).getDay();return o===0||o===6}var Et={};function H(){return Et}function xt(e,t){let o=H(),n=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0,r=s(e,t?.in),i=r.getDay(),a=(i<n?7:0)+i-n;return r.setDate(r.getDate()-a),r.setHours(0,0,0,0),r}function L(e,...t){let o=l.bind(null,e||t.find(n=>typeof n=="object"));return t.map(o)}function q(e,t){let o=s(e,t?.in);return o.setHours(0,0,0,0),o}function Q(e,t,o){let[n,r]=L(o?.in,e,t);return+q(n)==+q(r)}function yt(e,t){let o=s(e,t?.in),n=o.getMonth();return o.setFullYear(o.getFullYear(),n+1,0),o.setHours(23,59,59,999),o}function Dt(e,t){let[o,n]=L(e,t.start,t.end);return{start:o,end:n}}function vt(e,t){let{start:o,end:n}=Dt(t?.in,e),r=+o>+n,i=r?+o:+n,a=r?n:o;a.setHours(0,0,0,0);let c=t?.step??1;if(!c)return[];c<0&&(c=-c,r=!r);let y=[];for(;+a<=i;)y.push(l(o,a)),a.setDate(a.getDate()+c),a.setHours(0,0,0,0);return r?y.reverse():y}function gt(e,t){let o=s(e,t?.in);return o.setDate(1),o.setHours(0,0,0,0),o}function _t(e,t){let o=H(),n=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??o.weekStartsOn??o.locale?.options?.weekStartsOn??0,r=s(e,t?.in),i=r.getDay(),a=(i<n?-7:0)+6-(i-n);return r.setDate(r.getDate()+a),r.setHours(23,59,59,999),r}function Mt(e,t){return s(e,t?.in).getDate()}function M(e,t){return s(e,t?.in).getMonth()}function b(e,t){return s(e,t?.in).getFullYear()}function bt(e,t,o){return W(e,-t,o)}function kt(e,t,o){return N(e,-t,o)}function wt(e,t,o){let{years:n=0,months:r=0,weeks:i=0,days:a=0,hours:c=0,minutes:y=0,seconds:$=0}=t,k=kt(e,r+n*12,o),w=bt(k,a+i*7,o),B=y+c*60,G=($+B*60)*1e3;return l(o?.in||e,+w-G)}var Nt=(e,t)=>t.id,Ht=e=>["../../","detail",e];function Lt(e,t){if(e&1&&(m(0,"a",1)(1,"span",2),f(2),h(3,"date"),d(),m(4,"span",3),f(5),d()()),e&2){let o=t.$implicit;u("routerLink",tt(6,Ht,o.id)),p(2),D(x(3,3,o.startsFrom,"HH:mm")),p(3),D(o.label)}}var St=(()=>{let t=class t{constructor(){this.events=U.required()}};t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=S({type:t,selectors:[["demo-calendar-events"]],hostAttrs:[1,"contents"],inputs:{events:[1,"events"]},standalone:!0,features:[I],decls:3,vars:0,consts:[[1,"flex","flex-col","gap-0.5","py-1","overflow-hidden","w-full"],["type","button","puiBaseButton","",1,"justify-start","text-start","text-sm","ps-1","pe-2","py-0.5","gap-1",3,"routerLink"],[1,"tabular-nums","dark:text-neutral-400","font-medium"],[1,"truncate"]],template:function(r,i){r&1&&(m(0,"div",0),g(1,Lt,6,8,"a",1,Nt),d()),r&2&&(p(),_(i.events()))},dependencies:[pt,E,st]});let e=t;return e})();var $t=(e,t)=>({"grid-rows-[min-content_repeat(6,1fr)]":e,"grid-rows-[min-content_repeat(5,1fr)]":t}),Bt=(e,t)=>({"border-r":e,"dark:text-red-400":t}),Yt=(e,t)=>({"border-b":e,"border-r":t}),zt=(e,t,o,n,r)=>({"dark:text-neutral-400":e,"font-black opacity-20":t,"font-medium opacity-10":o,"dark:text-primary-50 before:rounded-full before:-top-2 before:-bottom-2 before:-left-6 before:-right-6 before:absolute before:-z-10 before:bg-primary-700":n,"dark:text-red-400":r});function At(e,t){if(e&1&&(m(0,"div",5),f(1),h(2,"date"),d()),e&2){let o=t.$implicit,n=t.$index,r=t.$count;u("ngClass",O(5,Bt,n!==r-1,o.isWeekend)),p(),D(x(2,2,o.date,"EE"))}}function jt(e,t){if(e&1&&(f(0),h(1,"date"),A(2,"br"),f(3),h(4,"date")),e&2){let o=j().$implicit;C(" ",x(1,2,o.date,"MMM"),""),p(3),C("",x(4,5,o.date,"dd")," ")}}function Rt(e,t){if(e&1&&(f(0),h(1,"date")),e&2){let o=j().$implicit;C(" ",x(1,1,o.date,"dd")," ")}}function Pt(e,t){if(e&1&&(m(0,"div",6)(1,"span",10),X(2,jt,5,8)(3,Rt,2,4),d(),A(4,"demo-calendar-events",11),d()),e&2){let o=t.$implicit,n=t.$index,r=t.$count;u("ngClass",O(4,Yt,n<r-7,n%7!=6)),p(),u("ngClass",et(7,zt,(o.isLastMonth||o.isNextMonth)&&!o.isToday,!o.isLastMonth&&!o.isNextMonth,o.isLastMonth||o.isNextMonth,o.isToday,o.isWeekend)),p(),Z(o.isStartOfMonth?2:3),p(2),u("events",o.events)}}var uo=(()=>{let t=class t{constructor(){this.route=v(it),this.router=v(at),this.timestamp=R(this.route.params.pipe(Y(n=>n.timestamp),Y(n=>Number(n)))),this.dataService=v(dt),this.rawData=R(this.dataService.getList()),this.listService=v(mt),this.selectedTime=F(()=>{let n=this.timestamp();return n!=null&&n!=-1?new Date(n):n==-1?new Date(this.listService.storedSelectedTime):new Date}),this.daysVisible=F(()=>{let n=this.selectedTime();if(n==null)return[];let r=new Date,i=xt(gt(n),{weekStartsOn:0}),a=_t(yt(n),{weekStartsOn:0});return vt({start:i,end:a}).map(c=>({date:c,isLastMonth:M(c)<M(n)?!0:b(c)<b(c),isNextMonth:M(c)>M(n)?!0:b(c)>b(c),isStartOfMonth:Mt(c)==1,isToday:Q(c,r),isWeekend:ht(c)}))}),this.daysWithData=F(()=>{let n=this.daysVisible(),r=this.rawData()??[];return n.map(i=>K(J({},i),{events:r.filter(a=>Q(a.startsFrom,i.date)).sort((a,c)=>a.startsFrom.getTime()-c.startsFrom.getTime())}))})}onNextMonthClick(){let n=this.selectedTime(),r=ft(n,{months:1});this.listService.updateSelectedTime(r),this.router.navigate(["../",r.getTime()],{relativeTo:this.route})}onLastMonthClick(){let n=this.selectedTime(),r=wt(n,{months:1});this.listService.updateSelectedTime(r),this.router.navigate(["../",r.getTime()],{relativeTo:this.route})}onTodayClick(){let n=new Date;this.listService.updateSelectedTime(n),this.router.navigate(["../",n.getTime()],{relativeTo:this.route})}};t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=S({type:t,selectors:[["demo-employee-calendar-monthly"]],hostAttrs:[1,"contents"],standalone:!0,features:[I],decls:15,vars:15,consts:[[1,"@container","grow","flex","flex-col"],[1,"pui-card","rounded-4","h-full","grow","overflow-hidden","flex","flex-col"],[1,"rounded-t-4","px-8","pt-6","pb-12","bg-gradient-to-br","from-primary-800/20","to-primary-900/20"],[1,"text-xl","font-display"],[1,"grow","-mt-6","bg-neutral-800","rounded-t-4","border-t","grid","grid-cols-7",3,"ngClass"],[1,"text-center","pt-2","pb-1","uppercase","font-bold","text-base/none",3,"ngClass"],["puiHoverable","",1,"flex","flex-col","items-center","justify-start","gap-1.5","relative",3,"ngClass"],["id","lastMonth","label","Last month","mode","low-emphasis","icon","arrow_back",3,"click","weight"],["id","today","label","Today","mode","auto","icon","today",3,"click","weight"],["id","nextMonth","label","Next month","mode","low-emphasis","icon","arrow_forward",3,"click","weight"],[1,"mt-2","text-[72px]/none","text-end","absolute","z-0","-bottom-2","-right-1","whitespace-nowrap","font-display","pointer-events-none","select-none",3,"ngClass"],[3,"events"]],template:function(r,i){r&1&&(m(0,"div",0)(1,"main",1)(2,"div",2)(3,"span",3),f(4),h(5,"date"),d()(),m(6,"div",4),g(7,At,3,8,"div",5,z),h(9,"slice"),g(10,Pt,5,13,"div",6,z),d()()(),m(12,"pui-layout-control",7),T("click",function(){return i.onLastMonthClick()}),d(),m(13,"pui-layout-control",8),T("click",function(){return i.onTodayClick()}),d(),m(14,"pui-layout-control",9),T("click",function(){return i.onNextMonthClick()}),d()),r&2&&(p(4),D(x(5,5,i.selectedTime(),"MMMM yyyy")),p(2),u("ngClass",O(12,$t,i.daysWithData().length>35,i.daysWithData().length<=35)),p(),_(ot(9,8,i.daysWithData(),0,7)),p(3),_(i.daysWithData()),p(2),u("weight",-100),p(),u("weight",0),p(),u("weight",100))},dependencies:[lt,ct,E,nt,St,rt]});let e=t;return e})();export{uo as EmployeeCalendarMonthlyComponent};
