import{H as a,L as d,Qb as u,aa as h,e as n,g as c,ha as b,hb as y}from"./chunk-GGV4OHPW.js";import{a as v,b as m}from"./chunk-CZC3PYQ3.js";import{a as o,b as f}from"./chunk-EQDQRRRY.js";var I=(()=>{let i=class i extends v{constructor(){super("todo-database"),this.platformId=d(h),this.isServer=y(this.platformId),!this.isServer&&(import("./chunk-O6MQDVN7.js"),this.version(2).stores({todos:"id, title, label"}))}emptyDatabase(){return this.delete().then(()=>{location.reload()})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();var P=(()=>{let i=class i{constructor(){this.database=d(I),this.mainFilter=b("incomplete"),this.list=e=>n(m(()=>this.database.isServer?[]:this.database.todos.orderBy("title").filter(t=>e==="all"?!0:t.items.length==0||t.items.some(r=>r.isCompleted==!1)).toArray())),this.one=e=>n(m(()=>{if(!this.database.isServer)return this.database.todos.get(e)}))}create(e){return e.input.title?n(this.database.todos.add(f(o({},e.input),{id:u(),items:[],remindOn:null}))):c(()=>new Error("Name is required"))}update(e,t){return n(this.database.todos.update(e,o(o(o({},typeof t.input.title>"u"?{}:{title:t.input.title}),typeof t.input.label>"u"?{}:{label:t.input.label}),typeof t.input.remindOn>"u"?{}:{remindOn:t.input.remindOn})))}addItem(e,t){return n(this.database.todos.where("id").equals(e).modify(r=>{r.items.push({id:u(),description:t.input.description,isCompleted:!1})}))}updateItem(e,t,r){return n(this.database.todos.where("id").equals(e).modify(l=>{l.items=l.items.map(p=>p.id===t?o(o(o({},p),typeof r.input.description>"u"?{}:{description:r.input.description}),typeof r.input.isCompleted>"u"?{}:{isCompleted:r.input.isCompleted}):p)}))}remove(e){return n(this.database.todos.delete(e))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();export{P as a};
